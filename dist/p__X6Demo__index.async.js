"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[171],{82553:function(zt,qe,Z){Z.r(qe),Z.d(qe,{default:function(){return At}});var nt=Z(26068),c=Z.n(nt),it=Z(48305),j=Z.n(it),y=Z(75271),te=Z(26114),at=Z(15558),je=Z.n(at),ut=Z(25298),st=Z.n(ut),lt=Z(17069),ct=Z.n(lt),dt=Z(82092),Te=Z.n(dt),ft=function(){te.kJ.registerNode("docker-container",{inherit:"rect",width:700,height:320,attrs:{body:{stroke:"#333",strokeWidth:2,fill:"transparent",strokeDasharray:"5,5",cursor:"move"},text:{fontSize:12,fill:"#333",textAnchor:"start",refX:10,refY:15}},ports:{groups:{top:{position:"top",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),te.kJ.registerNode("docker-service",{inherit:"rect",width:120,height:50,attrs:{body:{stroke:"#f39c12",strokeWidth:1,fill:"#fff3cd",rx:8,ry:8},text:{fontSize:12,fill:"#333",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#f39c12",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#f39c12",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#f39c12",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#f39c12",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),te.kJ.registerNode("docker-script",{inherit:"rect",width:140,height:40,attrs:{body:{stroke:"#17a2b8",strokeWidth:1,fill:"#d1ecf1",rx:6,ry:6},text:{fontSize:11,fill:"#333",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),te.kJ.registerNode("docker-image",{inherit:"rect",width:320,height:40,attrs:{body:{stroke:"#6f42c1",strokeWidth:1,fill:"#e2d9f3",rx:6,ry:6},text:{fontSize:12,fill:"#333",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),te.kJ.registerNode("docker-volume",{inherit:"ellipse",width:180,height:50,attrs:{body:{stroke:"#20c997",strokeWidth:2,fill:"#d4edda"},text:{fontSize:10,fill:"#333",textWrap:{width:-20,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#20c997",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#20c997",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#20c997",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#20c997",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),te.kJ.registerNode("docker-user",{inherit:"rect",width:100,height:25,attrs:{body:{stroke:"#fd7e14",strokeWidth:1,fill:"#fff3cd",rx:4},text:{fontSize:10,fill:"#333",fontWeight:"bold",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#fd7e14",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#fd7e14",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#fd7e14",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#fd7e14",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),te.kJ.registerNode("docker-port",{inherit:"polygon",width:80,height:40,attrs:{body:{refPoints:"0,10 60,0 80,10 60,20 0,10",stroke:"#dc3545",strokeWidth:1,fill:"#f8d7da"},text:{fontSize:12,fill:"#333",fontWeight:"bold"}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#dc3545",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#dc3545",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#dc3545",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#dc3545",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),te.kJ.registerNode("docker-network",{inherit:"polygon",width:120,height:40,attrs:{body:{refPoints:"0,20 20,0 100,0 120,20 100,40 20,40",stroke:"#6c757d",strokeWidth:1,fill:"#e9ecef"},text:{fontSize:11,fill:"#333",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#6c757d",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#6c757d",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#6c757d",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#6c757d",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),te.kJ.registerNode("network-switch",{inherit:"rect",width:100,height:60,attrs:{body:{stroke:"#007bff",strokeWidth:2,fill:"#e7f3ff",rx:8,ry:8},text:{fontSize:12,fill:"#007bff",fontWeight:"bold",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#007bff",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#007bff",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#007bff",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#007bff",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"left",id:"port1"},{group:"right",id:"port2"},{group:"top",id:"port3"},{group:"bottom",id:"port4"}]}},!0),te.kJ.registerNode("network-router",{inherit:"rect",width:120,height:80,attrs:{body:{stroke:"#28a745",strokeWidth:2,fill:"#e8f5e8",rx:10,ry:10},text:{fontSize:12,fill:"#28a745",fontWeight:"bold",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{left:{position:"left",attrs:{circle:{r:5,magnet:!0,stroke:"#28a745",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:5,magnet:!0,stroke:"#28a745",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},top:{position:"top",attrs:{circle:{r:5,magnet:!0,stroke:"#28a745",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"left",id:"lan1"},{group:"right",id:"lan2"},{group:"top",id:"wan"}]}},!0)},pt=function(){function $(r){st()(this,$),Te()(this,"graph",void 0),Te()(this,"components",new Map),Te()(this,"autoLayout",!0),this.graph=r}return ct()($,[{key:"addContainer",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={id:"container-".concat(Date.now()),type:"container",label:e,properties:a},i=this.graph.addNode({shape:"docker-container",label:"",position:this.getNextPosition("container")});return this.components.set(n.id,c()(c()({},n),{},{position:i.getPosition()})),this.autoLayout&&this.performAutoLayout(),{component:n,node:i}}},{key:"addService",value:function(e,a){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i={id:"service-".concat(Date.now()),type:"container",label:e,properties:n},o=this.graph.addNode({shape:"docker-service",label:e,position:{x:20,y:40}});return this.components.set(i.id,c()(c()({},i),{},{position:o.getPosition()})),{component:i,node:o}}},{key:"addScript",value:function(e,a){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"command",i={id:"script-".concat(Date.now()),type:n,label:e,properties:{text:e}},o=this.graph.addNode({shape:"docker-script",label:e,position:{x:180,y:40+(n==="entrypoint"?0:50)}});return this.components.set(i.id,c()(c()({},i),{},{position:o.getPosition()})),{component:i,node:o}}},{key:"addImage",value:function(e,a){var n={id:"image-".concat(Date.now()),type:"image",label:e,properties:{imageName:e}},i=this.graph.addNode({shape:"docker-image",label:e,position:{x:20,y:150}});return this.components.set(n.id,c()(c()({},n),{},{position:i.getPosition()})),{component:n,node:i}}},{key:"addVolume",value:function(e,a){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i={id:"volume-".concat(Date.now()),type:"volume",label:e,properties:{volumeMapping:e}},o=this.graph.addNode({shape:"docker-volume",label:e,position:{x:20+n*200,y:220}});return this.components.set(i.id,c()(c()({},i),{},{position:o.getPosition()})),{component:i,node:o}}},{key:"addPort",value:function(e,a){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i={id:"port-".concat(Date.now()),type:"port",label:e,properties:{port:e}},o=this.graph.addNode({shape:"docker-port",label:e,position:{x:1e3,y:20+n*50}});return this.components.set(i.id,c()(c()({},i),{},{position:o.getPosition()})),{component:i,node:o}}},{key:"addNetwork",value:function(e,a){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i={id:"network-".concat(Date.now()),type:"network",label:e,properties:{networkInfo:e}},o=this.graph.addNode({shape:"docker-network",label:e,position:{x:150,y:240+n*50}});return this.components.set(i.id,c()(c()({},i),{},{position:o.getPosition()})),{component:i,node:o}}},{key:"createDockerArchitecture",value:function(e){var a,n=this,i,o,s=e.position||this.getNextPosition("container"),h=this.graph.addNode({shape:"docker-container",x:s.x,y:s.y,width:720,height:320,zIndex:1,label:"",data:{config:e},attrs:{label:{refY:15,fontSize:12}}}),l=[],d=this.graph.addNode({shape:"docker-service",x:s.x+20,y:s.y+40,label:e.containerName,zIndex:10});if(l.push(d),e.user){var m=this.graph.addNode({shape:"docker-user",x:s.x+180,y:s.y+40,label:"user: ".concat(e.user),zIndex:10});l.push(m)}if(e.entrypoint){var E=this.graph.addNode({shape:"docker-script",x:s.x+20,y:s.y+100,label:e.entrypoint,zIndex:10,data:{scriptType:"entrypoint"}});l.push(E)}if(e.command){var T=this.graph.addNode({shape:"docker-script",x:s.x+200,y:s.y+100,label:e.command,data:{scriptType:"command"},zIndex:10});l.push(T)}var S=this.graph.addNode({shape:"docker-image",x:s.x+20,y:s.y+160,label:e.image,zIndex:10});l.push(S),(a=e.volumes)===null||a===void 0||a.forEach(function(F,M){var z=n.graph.addNode({shape:"docker-volume",x:s.x+20+M*200,y:s.y+220,label:F,zIndex:10});l.push(z)}),(i=e.ports)===null||i===void 0||i.forEach(function(F,M){var z=n.graph.addNode({shape:"docker-port",x:s.x+380,y:s.y+40+M*50,label:F,zIndex:10});l.push(z)}),(o=e.networkInterfaces)===null||o===void 0||o.forEach(function(F,M){var z=F.ipConfig==="static"&&F.staticIP?"".concat(F.interfaceName,`
`).concat(F.staticIP):"".concat(F.interfaceName,`
dynamic`),V=n.graph.addNode({shape:"docker-network",x:s.x+580,y:s.y+240+M*55,label:z,zIndex:10});l.push(V),V.setData({networkInterface:F,isConnected:!1}),console.log("\u521B\u5EFA\u7F51\u7EDC\u63A5\u53E3: ".concat(F.interfaceName," -> ").concat(F.switchName),F)}),l.forEach(function(F){h.addChild(F)});var R={id:"container-".concat(Date.now()),type:"container",label:e.containerName,properties:e,position:h.getPosition()};return this.components.set(R.id,R),{containerNode:h,childNodes:l}}},{key:"getNextPosition",value:function(e){var a=this.graph.getNodes(),n=a.filter(function(i){return i.shape==="docker-container"});return{x:50,y:50+n.length*350}}},{key:"performAutoLayout",value:function(){}},{key:"getComponents",value:function(){return Array.from(this.components.values())}},{key:"clear",value:function(){this.components.clear(),this.graph.clearCells()}},{key:"getContainerCount",value:function(){var e=this.graph.getNodes().filter(function(a){return a.shape==="docker-container"});return e.length}},{key:"getAllContainers",value:function(){var e=this.graph.getNodes().filter(function(a){return a.shape==="docker-container"});return e.map(function(a){return{id:a.id,name:a.attr("text/text")||"container",position:a.getPosition(),children:(a.getChildren()||[]).map(function(n){return{id:n.id,shape:n.shape,label:n.attr("text/text")||""}})}})}},{key:"getDAGRelationships",value:function(){var e=this.getAllContainers(),a=this.graph.getEdges(),n={containers:e,connections:a.map(function(i){var o,s,h,l;return{id:i.id,source:(o=i.getSourceNode())===null||o===void 0?void 0:o.id,target:(s=i.getTargetNode())===null||s===void 0?void 0:s.id,sourceLabel:((h=i.getSourceNode())===null||h===void 0?void 0:h.attr("text/text"))||"",targetLabel:((l=i.getTargetNode())===null||l===void 0?void 0:l.attr("text/text"))||""}}),totalContainers:e.length,totalConnections:a.length};return n}},{key:"getTopologicalOrder",value:function(){var e=this.getAllContainers(),a=this.graph.getEdges(),n={},i={};e.forEach(function(d){n[d.id]=[],i[d.id]=0}),a.forEach(function(d){var m,E,T=(m=d.getSourceNode())===null||m===void 0?void 0:m.id,S=(E=d.getTargetNode())===null||E===void 0?void 0:E.id;T&&S&&(n[T].push(S),i[S]++)});var o=[],s=[];for(Object.keys(i).forEach(function(d){i[d]===0&&o.push(d)});o.length>0;){var h=o.shift();s.push(h),n[h].forEach(function(d){i[d]--,i[d]===0&&o.push(d)})}var l=s.length!==e.length;return{order:s.map(function(d){var m=e.find(function(E){return E.id===d});return{id:d,name:(m==null?void 0:m.name)||"Unknown"}}),hasCircle:l,isValidDAG:!l}}},{key:"createSwitch",value:function(e,a){var n=this.getNextSwitchPosition(),i=e;a&&a.subnet&&(i="".concat(e,`
`).concat(a.subnet));var o=this.graph.addNode({shape:"network-switch",x:n.x,y:n.y,label:i,zIndex:5,data:{switchName:e,networkConfig:a}});return a&&a.gateway&&this.createAndConnectRouter(o,e,a),console.log("\u521B\u5EFA\u4EA4\u6362\u673A: ".concat(e),a),o}},{key:"createAndConnectRouter",value:function(e,a,n){var i="".concat(a,"_router"),o=this.graph.getNodes().filter(function(d){var m=d.attr("text/text");return d.shape==="network-router"&&typeof m=="string"&&m.includes(i)});if(o.length===0){var s=n!=null&&n.gateway?"".concat(i,`
GW: `).concat(n.gateway):i,h=this.createRouter(s),l=e.getPosition();h.setPosition({x:l.x+100,y:l.y}),this.graph.addEdge({source:{cell:e.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:h.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#28a745",strokeWidth:3,targetMarker:{name:"block",width:8,height:6}}},zIndex:0}),console.log("\u521B\u5EFA\u8DEF\u7531\u5668\u5E76\u8FDE\u63A5: ".concat(i))}}},{key:"createRouter",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Router",a=this.getNextRouterPosition(),n=this.graph.addNode({shape:"network-router",x:a.x,y:a.y,label:e,zIndex:5});return console.log("\u521B\u5EFA\u8DEF\u7531\u5668: ".concat(e)),n}},{key:"getNextSwitchPosition",value:function(){var e=this.graph.getNodes().filter(function(a){return a.shape==="network-switch"});return{x:800+e.length%3*150,y:100+Math.floor(e.length/3)*150}}},{key:"getNextRouterPosition",value:function(){var e=this.graph.getNodes().filter(function(o){return o.shape==="network-router"}),a=this.graph.getNodes().filter(function(o){return o.shape==="network-switch"}),n=800;a.length>0&&(n=Math.max.apply(Math,je()(a.map(function(o){return o.getPosition().x}))));var i=n+200;return{x:i+e.length%2*150,y:100+Math.floor(e.length/2)*150}}},{key:"connectNetworkToSwitch",value:function(e,a){var n=this.graph.getNodes().filter(function(s){return s.shape==="network-switch"&&(s.attr("text/text")||"")===a}),i;n.length>0?(i=n[0],console.log("\u627E\u5230\u73B0\u6709\u4EA4\u6362\u673A: ".concat(a))):(console.log("\u672A\u627E\u5230\u4EA4\u6362\u673A ".concat(a,"\uFF0C\u81EA\u52A8\u521B\u5EFA")),i=this.createSwitch(a));var o=this.graph.addEdge({source:{cell:e.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:i.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#6c757d",strokeWidth:2,strokeDasharray:"2,2"}},data:{originalStroke:"#6c757d",originalWidth:2},labels:[{attrs:{text:{text:"\u7F51\u7EDC\u8FDE\u63A5",fontSize:10,fill:"#666"}}}]});return console.log("\u8FDE\u63A5\u7F51\u5361 ".concat(e.attr("text/text")||"network"," \u5230\u4EA4\u6362\u673A ").concat(a)),{edge:o,switchNode:i}}},{key:"connectSwitchToRouter",value:function(e){var a=this.graph.getNodes().filter(function(s){return s.shape==="network-router"});a.length===0&&(a=[this.createRouter("Default Router")]);var n=a[0],i=this.graph.getEdges().filter(function(s){var h,l;return((h=s.getSourceNode())===null||h===void 0?void 0:h.id)===e.id&&((l=s.getTargetNode())===null||l===void 0?void 0:l.id)===n.id});if(i.length>0)return console.log("\u4EA4\u6362\u673A ".concat(e.attr("text/text")||"switch"," \u5DF2\u7ECF\u8FDE\u63A5\u5230\u8DEF\u7531\u5668\uFF0C\u8DF3\u8FC7")),i[0];var o=this.graph.addEdge({source:{cell:e.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:n.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#28a745",strokeWidth:3,targetMarker:{name:"block",width:8,height:6}}},data:{originalStroke:"#28a745",originalWidth:3},labels:[{attrs:{text:{text:"Bridge",fontSize:10,fill:"#28a745"}}}]});return console.log("\u8FDE\u63A5\u4EA4\u6362\u673A ".concat(e.attr("text/text")||"switch"," \u5230\u8DEF\u7531\u5668")),o}},{key:"manualConnectNetworkToSwitch",value:function(e,a,n){var i=this,o=this.graph.getCellById(e);if(!o||o.shape!=="docker-network")return console.error("\u65E0\u6548\u7684\u7F51\u5361\u8282\u70B9"),!1;var s=this.graph.getConnectedEdges(o).filter(function(S){var R=S.getTargetNode();return R&&R.shape==="network-switch"});if(s.length>0)return console.log("\u7F51\u5361\u5DF2\u7ECF\u8FDE\u63A5\u5230\u4EA4\u6362\u673A\uFF0C\u8BF7\u5148\u65AD\u5F00\u8FDE\u63A5"),!1;var h=this.graph.getNodes().filter(function(S){return S.shape==="network-switch"&&(S.attr("text/text")||"")===a}),l;h.length>0?l=h[0]:l=this.createSwitch(a);var d=this.connectNetworkToSwitch(o,a),m=o.getData()||{},E=m.networkInterface||{};if(E.ipConfig==="static"&&E.staticIP){var T="".concat(E.interfaceName,`
`).concat(E.staticIP);o.attr("text/text",T)}return o.setData(c()(c()({},m),{},{isConnected:!0,connectedSwitch:a,switchNetworkConfig:n,networkInterface:c()(c()({},E),{},{switchName:a})})),d&&d.switchNode&&setTimeout(function(){i.connectSwitchToRouter(d.switchNode)},50),console.log("\u624B\u52A8\u8FDE\u63A5\u7F51\u5361 ".concat(o.attr("text/text")||"network"," \u5230\u4EA4\u6362\u673A ").concat(a)),!0}},{key:"disconnectNetworkFromSwitch",value:function(e){var a=this,n=this.graph.getCellById(e);if(!n||n.shape!=="docker-network")return console.error("\u65E0\u6548\u7684\u7F51\u5361\u8282\u70B9"),!1;var i=this.graph.getConnectedEdges(n).filter(function(o){var s=o.getTargetNode();return s&&s.shape==="network-switch"});return i.length===0?(console.log("\u7F51\u5361\u672A\u8FDE\u63A5\u5230\u4EFB\u4F55\u4EA4\u6362\u673A"),!1):(i.forEach(function(o){a.graph.removeCell(o)}),n.setData(c()(c()({},n.getData()),{},{isConnected:!1,connectedSwitch:void 0})),console.log("\u65AD\u5F00\u7F51\u5361 ".concat(n.attr("text/text")||"network"," \u7684\u8FDE\u63A5")),!0)}},{key:"getNetworkNodes",value:function(){return this.graph.getNodes().filter(function(e){return e.shape==="docker-network"})}},{key:"getSwitchNodes",value:function(){return this.graph.getNodes().filter(function(e){return e.shape==="network-switch"})}},{key:"isNetworkConnected",value:function(e){var a=this.graph.getCellById(e);if(!a)return!1;var n=this.graph.getConnectedEdges(a).filter(function(i){var o=i.getTargetNode();return o&&o.shape==="network-switch"});return n.length>0}},{key:"getConnectedSwitch",value:function(e){var a=this.graph.getCellById(e);if(!a)return null;var n=this.graph.getConnectedEdges(a).filter(function(o){var s=o.getTargetNode();return s&&s.shape==="network-switch"});if(n.length>0){var i=n[0].getTargetNode();return i&&i.attr("text/text")||null}return null}},{key:"addPortToContainer",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"8080",n=e.getChildren()||[],i=n.filter(function(l){return l.shape==="docker-port"}),o=e.getPosition(),s=70+i.length*30,h=this.graph.addNode({shape:"docker-port",x:o.x+500,y:o.y+s,label:a,zIndex:10});return e.addChild(h),console.log("\u6DFB\u52A0\u7AEF\u53E3: ".concat(a)),h}},{key:"addVolumeToContainer",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"/data:/app/data",n=e.getChildren()||[],i=n.filter(function(l){return l.shape==="docker-volume"}),o=e.getPosition(),s=180+i.length*30,h=this.graph.addNode({shape:"docker-volume",x:o.x+350,y:o.y+s,label:a,zIndex:10});return e.addChild(h),console.log("\u6DFB\u52A0\u5377: ".concat(a)),h}},{key:"addNetworkToContainer",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"eth0",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"default",i=e.getChildren()||[],o=i.filter(function(m){return m.shape==="docker-network"}),s=e.getPosition(),h=e.getSize().height||320,l=h-80+o.length*55,d=this.graph.addNode({shape:"docker-network",x:s.x+580,y:s.y+l,label:a,zIndex:10,data:{networkInterface:{interfaceName:a,switchName:n,ipConfig:"dynamic"}}});return e.addChild(d),console.log("\u6DFB\u52A0\u7F51\u7EDC\u63A5\u53E3: ".concat(a," -> ").concat(n)),d}},{key:"removeChildComponent",value:function(e){var a=this,n=e.getParent();if(n){var i=n.getData()||{},o=i.config||{},s=e.shape,h=e.attr("text/text");switch(s){case"docker-user":n.setData(c()(c()({},i),{},{config:c()(c()({},o),{},{user:void 0})})),console.log("\u6E05\u7A7A\u5BB9\u5668 ".concat(n.attr("text/text")," \u7684\u7528\u6237\u914D\u7F6E"));break;case"docker-image":n.setData(c()(c()({},i),{},{config:c()(c()({},o),{},{image:"nginx:latest"})})),console.log("\u6E05\u7A7A\u5BB9\u5668 ".concat(n.attr("text/text")," \u7684\u955C\u50CF\u914D\u7F6E"));break;case"docker-port":var l=(o.ports||[]).filter(function(M){return M!==h});n.setData(c()(c()({},i),{},{config:c()(c()({},o),{},{ports:l})})),console.log("\u4ECE\u5BB9\u5668 ".concat(n.attr("text/text")," \u79FB\u9664\u7AEF\u53E3 ").concat(h));break;case"docker-volume":var d=(o.volumes||[]).filter(function(M){return M!==h});n.setData(c()(c()({},i),{},{config:c()(c()({},o),{},{volumes:d})})),console.log("\u4ECE\u5BB9\u5668 ".concat(n.attr("text/text")," \u79FB\u9664\u5377 ").concat(h));break;case"docker-script":var m=e.getData(),E=m==null?void 0:m.scriptType;E==="entrypoint"?(n.setData(c()(c()({},i),{},{config:c()(c()({},o),{},{entrypoint:""})})),console.log("\u6E05\u7A7A\u5BB9\u5668 ".concat(n.attr("text/text")," \u7684 entrypoint"))):(E==="command"||!E)&&(n.setData(c()(c()({},i),{},{config:c()(c()({},o),{},{command:"tail -f /etc/hosts"})})),console.log("\u6E05\u7A7A\u5BB9\u5668 ".concat(n.attr("text/text")," \u7684 command")));break;case"docker-network":var T=e.getData(),S=T==null?void 0:T.networkInterface;if(S){var R=(o.networkInterfaces||[]).filter(function(M){return M.interfaceName!==S.interfaceName});n.setData(c()(c()({},i),{},{config:c()(c()({},o),{},{networkInterfaces:R})})),console.log("\u4ECE\u5BB9\u5668 ".concat(n.attr("text/text")," \u79FB\u9664\u7F51\u7EDC\u63A5\u53E3 ").concat(S.interfaceName))}break}n.removeChild(e)}var F=this.graph.getConnectedEdges(e);F.forEach(function(M){return a.graph.removeEdge(M)}),this.graph.removeNode(e),console.log("\u5220\u9664\u7EC4\u4EF6: ".concat(e.shape))}},{key:"hasUniqueComponent",value:function(e,a){var n=e.getChildren()||[];return n.some(function(i){return i.shape===a})}},{key:"getContainerComponentStats",value:function(e){var a=e.getChildren()||[],n={service:a.filter(function(i){return i.shape==="docker-service"}).length,image:a.filter(function(i){return i.shape==="docker-image"}).length,user:a.filter(function(i){return i.shape==="docker-user"}).length,script:a.filter(function(i){return i.shape==="docker-script"}).length,port:a.filter(function(i){return i.shape==="docker-port"}).length,volume:a.filter(function(i){return i.shape==="docker-volume"}).length,network:a.filter(function(i){return i.shape==="docker-network"}).length};return n}}]),$}(),t=Z(52676),ht=function(r){var e=r.dockerFactory,a=r.onClose,n=(0,y.useState)("n1"),i=j()(n,2),o=i[0],s=i[1],h=(0,y.useState)("nginx:latest"),l=j()(h,2),d=l[0],m=l[1],E=(0,y.useState)(""),T=j()(E,2),S=T[0],R=T[1],F=(0,y.useState)("tail -f /etc/hosts"),M=j()(F,2),z=M[0],V=M[1],U=(0,y.useState)("80"),le=j()(U,2),_=le[0],C=le[1],G=(0,y.useState)(""),H=j()(G,2),W=H[0],p=H[1],A=(0,y.useState)("always"),x=j()(A,2),L=x[0],re=x[1],oe=(0,y.useState)([]),X=j()(oe,2),ne=X[0],ie=X[1],ue=(0,y.useState)("nginx-tomcat"),se=j()(ue,2),D=se[0],ae=se[1],q=(0,y.useState)("172.20.0.0/16"),O=j()(q,2),Q=O[0],he=O[1],Ce=(0,y.useState)("172.20.0.1"),we=j()(Ce,2),Me=we[0],Se=we[1],Ue=(0,y.useState)(["switch1","switch2"]),We=j()(Ue,2),ee=We[0],ge=We[1],Je=(0,y.useState)([]),Ae=j()(Je,2),ve=Ae[0],Le=Ae[1],ze=(0,y.useState)({switch1:{subnet:"172.18.0.0/16",gateway:"172.18.0.1"},switch2:{subnet:"172.19.0.0/16",gateway:"172.19.0.1"}}),me=j()(ze,2),b=me[0],xe=me[1],Ee=function(){if(e){var g=e.graph.getNodes().filter(function(B){return B.shape==="network-switch"}).map(function(B){return B.attr("text/text")||"switch"}),w=je()(new Set([].concat(je()(ee),je()(g))));ge(w)}},ye=function(){if(e){var g=e.getNetworkNodes(),w=g.map(function(B){return{id:B.id,label:B.attr("text/text")||"network",isConnected:e.isNetworkConnected(B.id),connectedSwitch:e.getConnectedSwitch(B.id)}});Le(w)}},Ve=function(g,w){if(e){var B=b[w],fe=e.manualConnectNetworkToSwitch(g,w,B);fe&&(ye(),Ee())}},Ke=function(g){if(e){var w=e.disconnectNetworkFromSwitch(g);w&&ye()}};y.useEffect(function(){e&&(Ee(),ye())},[e]);var Ze=function(){if(e){var g={containerName:o||"my-container",image:d||"docker.io/library/nginx:latest",entrypoint:S.trim()||void 0,command:z.trim()||"tail -f /etc/hosts",restart:L,ports:_.split(",").map(function(w){return w.trim()}).filter(Boolean),volumes:W.split(",").map(function(w){return w.trim()}).filter(Boolean),networkInterfaces:ne,switchNetworks:b};e.createDockerArchitecture(g),setTimeout(function(){ye()},200),a==null||a()}},tt=function(){if(!(!e||!D.trim())){var g=D.trim();if(ee.includes(g)){alert("\u4EA4\u6362\u673A\u5DF2\u5B58\u5728\uFF01");return}if(!Q.trim()||!Me.trim()){alert("\u8BF7\u586B\u5199\u5B8C\u6574\u7684\u7F51\u7EDC\u914D\u7F6E\uFF01");return}e.createSwitch(g),xe(function(fe){return c()(c()({},fe),{},Te()({},g,{subnet:Q.trim(),gateway:Me.trim()}))}),setTimeout(function(){Ee()},100),ae("");var w=parseInt(Q.split(".")[2]),B=w+1;he("172.".concat(B,".0.0/16")),Se("172.".concat(B,".0.1"))}},rt=function(){var g={interfaceName:"eth".concat(ne.length),switchName:ee[0]||"",ipConfig:"dynamic",staticIP:void 0};ie(function(w){return[].concat(je()(w),[g])})},Xe=function(g){ie(function(w){return w.filter(function(B,fe){return fe!==g})})},Ne=function(g,w,B){ie(function(fe){return fe.map(function(Oe,_e){if(_e===g){var Fe=c()(c()({},Oe),{},Te()({},w,B));if(w==="ipConfig"&&B==="static"&&!Fe.staticIP){var Ye=b[Fe.switchName];if(Ye){var He=Ye.gateway.split(".");He[3]=String(100+g),Fe.staticIP=He.join(".")}}return w==="ipConfig"&&B==="dynamic"&&(Fe.staticIP=void 0),Fe}return Oe})})},Qe=function(){e&&(e.clear(),ge(["switch1","switch2"]),Le([]))},$e=function(){if(e){ee.includes("switch1")||e.createSwitch("switch1"),ee.includes("switch2")||e.createSwitch("switch2"),setTimeout(function(){Ee()},100);var g={containerName:"nginx-container",image:"docker.io/library/nginx:latest",entrypoint:"/docker-entrypoint",command:"nginx -g daemon off",ports:["8080","9090","9091"],volumes:["/data/container1/app:/app/data","/data/container1/app2:/app/data2"],networkInterfaces:[{interfaceName:"eth0",switchName:"switch1",ipConfig:"static",staticIP:"172.16.0.100"},{interfaceName:"eth1",switchName:"switch2",ipConfig:"dynamic"}]};e.createDockerArchitecture(g),setTimeout(function(){ye()},200),a==null||a()}},ce={width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",marginBottom:"8px"},f=c()(c()({},ce),{},{minHeight:"60px",resize:"vertical",fontFamily:"monospace"}),u={padding:"10px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginRight:"8px",marginBottom:"8px"},N=c()(c()({},u),{},{backgroundColor:"#dc3545"}),k={display:"block",marginBottom:"4px",fontSize:"13px",fontWeight:500,color:"#333"},de={marginBottom:"16px",padding:"12px",backgroundColor:"#fff",borderRadius:"6px",border:"1px solid #e9ecef"};return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{marginBottom:"16px",fontWeight:600,color:"#333",fontSize:"16px"},children:"\u{1F433} Docker \u914D\u7F6E\u9762\u677F"}),(0,t.jsxs)("div",{style:de,children:[(0,t.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#495057",fontSize:"14px"},children:"\u57FA\u7840\u914D\u7F6E"}),(0,t.jsx)("label",{style:k,children:"\u5BB9\u5668\u540D\u79F0"}),(0,t.jsx)("input",{type:"text",value:o,onChange:function(g){return s(g.target.value)},placeholder:"\u5BB9\u5668\u540D\u79F0",style:ce}),(0,t.jsx)("label",{style:k,children:"\u955C\u50CF"}),(0,t.jsx)("input",{type:"text",value:d,onChange:function(g){return m(g.target.value)},placeholder:"docker.io/library/nginx:latest",style:ce})]}),(0,t.jsxs)("div",{style:de,children:[(0,t.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#495057",fontSize:"14px"},children:"\u542F\u52A8\u914D\u7F6E"}),(0,t.jsx)("label",{style:k,children:"\u5165\u53E3\u70B9\u811A\u672C"}),(0,t.jsx)("input",{type:"text",value:S,onChange:function(g){return R(g.target.value)},placeholder:"/docker-entrypoint",style:ce}),(0,t.jsx)("label",{style:k,children:"\u542F\u52A8\u547D\u4EE4"}),(0,t.jsx)("input",{type:"text",value:z,onChange:function(g){return V(g.target.value)},placeholder:"tail -f /etc/hosts",style:ce}),(0,t.jsx)("label",{style:k,children:"\u91CD\u542F\u7B56\u7565"}),(0,t.jsxs)("select",{value:L,onChange:function(g){return re(g.target.value)},style:ce,children:[(0,t.jsx)("option",{value:"no",children:"no - \u4E0D\u81EA\u52A8\u91CD\u542F"}),(0,t.jsx)("option",{value:"always",children:"always - \u603B\u662F\u91CD\u542F"}),(0,t.jsx)("option",{value:"unless-stopped",children:"unless-stopped - \u9664\u975E\u624B\u52A8\u505C\u6B62"}),(0,t.jsx)("option",{value:"on-failure",children:"on-failure - \u4EC5\u6545\u969C\u65F6\u91CD\u542F"})]})]}),(0,t.jsxs)("div",{style:de,children:[(0,t.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#495057",fontSize:"14px"},children:"\u7F51\u7EDC\u4E0E\u5B58\u50A8"}),(0,t.jsx)("label",{style:k,children:"\u7AEF\u53E3\u6620\u5C04 (\u9017\u53F7\u5206\u9694)"}),(0,t.jsx)("textarea",{value:_,onChange:function(g){return C(g.target.value)},placeholder:"8080,9090,9091",style:f}),(0,t.jsx)("label",{style:k,children:"\u5377\u6620\u5C04 (\u9017\u53F7\u5206\u9694)"}),(0,t.jsx)("textarea",{value:W,onChange:function(g){return p(g.target.value)},placeholder:"/host/path:/container/path",style:f}),(0,t.jsx)("label",{style:k,children:"\u4EA4\u6362\u673A\u7BA1\u7406"}),(0,t.jsxs)("div",{style:{marginBottom:"12px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f8f9fa"},children:[(0,t.jsx)("div",{style:{marginBottom:"6px",fontSize:"12px",fontWeight:"bold"},children:"\u521B\u5EFA\u65B0\u4EA4\u6362\u673A"}),(0,t.jsx)("div",{style:{marginBottom:"6px"},children:(0,t.jsx)("input",{type:"text",value:D,onChange:function(g){return ae(g.target.value)},placeholder:"\u4EA4\u6362\u673A\u540D\u79F0",style:c()(c()({},ce),{},{marginBottom:"0",fontSize:"12px"})})}),(0,t.jsxs)("div",{style:{display:"flex",gap:"4px",marginBottom:"6px"},children:[(0,t.jsx)("input",{type:"text",value:Q,onChange:function(g){return he(g.target.value)},placeholder:"\u7F51\u7EDC\u5B50\u7F51 (\u5982: 172.20.0.0/16)",style:c()(c()({},ce),{},{marginBottom:"0",fontSize:"12px",flex:2})}),(0,t.jsx)("input",{type:"text",value:Me,onChange:function(g){return Se(g.target.value)},placeholder:"\u7F51\u5173 (\u5982: 172.20.0.1)",style:c()(c()({},ce),{},{marginBottom:"0",fontSize:"12px",flex:1})})]}),(0,t.jsx)("button",{onClick:tt,style:{width:"100%",padding:"6px 12px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\u2795 \u521B\u5EFA\u4EA4\u6362\u673A"})]}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:"12px",color:"#666"},children:"\u7F51\u7EDC\u63A5\u53E3\u914D\u7F6E\uFF1A"}),(0,t.jsx)("button",{onClick:rt,style:{padding:"4px 8px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"11px"},children:"\u2795 \u6DFB\u52A0\u63A5\u53E3"})]}),(0,t.jsx)("div",{style:{border:"1px solid #ddd",borderRadius:"4px",padding:"8px",maxHeight:"200px",overflowY:"auto"},children:ne.length===0?(0,t.jsx)("div",{style:{color:"#999",fontSize:"12px",textAlign:"center",padding:"16px"},children:'\u6682\u65E0\u7F51\u7EDC\u63A5\u53E3\uFF0C\u70B9\u51FB"\u6DFB\u52A0\u63A5\u53E3"\u521B\u5EFA'}):ne.map(function(v,g){return(0,t.jsxs)("div",{style:{border:"1px solid #e9ecef",borderRadius:"3px",padding:"8px",marginBottom:"8px",backgroundColor:"#f8f9fa"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,t.jsxs)("span",{style:{fontSize:"12px",fontWeight:"bold"},children:["\u63A5\u53E3 ",g+1]}),(0,t.jsx)("button",{onClick:function(){return Xe(g)},style:{padding:"2px 6px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"10px"},children:"\u5220\u9664"})]}),(0,t.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,t.jsx)("label",{style:{fontSize:"11px",color:"#666"},children:"\u63A5\u53E3\u540D\u79F0\uFF1A"}),(0,t.jsx)("input",{type:"text",value:v.interfaceName,onChange:function(B){return Ne(g,"interfaceName",B.target.value)},style:{width:"100%",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"11px"}})]}),(0,t.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,t.jsx)("label",{style:{fontSize:"11px",color:"#666"},children:"\u8FDE\u63A5\u4EA4\u6362\u673A\uFF1A"}),(0,t.jsx)("select",{value:v.switchName,onChange:function(B){return Ne(g,"switchName",B.target.value)},style:{width:"100%",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"11px"},children:ee.map(function(w){return(0,t.jsx)("option",{value:w,children:w},w)})})]}),b[v.switchName]&&(0,t.jsxs)("div",{style:{padding:"4px",backgroundColor:"#e7f3ff",borderRadius:"2px",marginBottom:"4px",fontSize:"10px",color:"#0066cc"},children:["\u{1F4E1} \u7F51\u7EDC: ",b[v.switchName].subnet,(0,t.jsx)("br",{}),"\u{1F3E0} \u7F51\u5173: ",b[v.switchName].gateway]}),(0,t.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,t.jsx)("label",{style:{fontSize:"11px",color:"#666"},children:"IP\u914D\u7F6E\uFF1A"}),(0,t.jsxs)("select",{value:v.ipConfig,onChange:function(B){return Ne(g,"ipConfig",B.target.value)},style:{width:"100%",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"11px"},children:[(0,t.jsx)("option",{value:"dynamic",children:"\u52A8\u6001\u5206\u914D (DHCP)"}),(0,t.jsx)("option",{value:"static",children:"\u9759\u6001IP"})]})]}),v.ipConfig==="static"&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{fontSize:"11px",color:"#666"},children:"\u9759\u6001IP\u5730\u5740\uFF1A"}),(0,t.jsx)("input",{type:"text",value:v.staticIP||"",onChange:function(B){return Ne(g,"staticIP",B.target.value)},placeholder:b[v.switchName]?"\u5728 ".concat(b[v.switchName].subnet," \u4E2D\u7684IP"):"\u5982: 172.20.0.100",style:{width:"100%",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"11px"}}),b[v.switchName]&&(0,t.jsxs)("div",{style:{fontSize:"9px",color:"#999",marginTop:"2px"},children:["\u{1F4A1} \u5EFA\u8BAEIP\u8303\u56F4: ",b[v.switchName].subnet]})]})]},g)})}),(0,t.jsxs)("div",{style:{marginTop:"16px"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:"12px",color:"#666"},children:"\u73B0\u6709\u7F51\u5361\u8FDE\u63A5\u7BA1\u7406\uFF1A"}),(0,t.jsx)("button",{onClick:ye,style:{padding:"4px 8px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"11px"},children:"\u{1F504} \u5237\u65B0"})]}),(0,t.jsx)("div",{style:{border:"1px solid #ddd",borderRadius:"4px",padding:"8px",maxHeight:"200px",overflowY:"auto"},children:ve.length===0?(0,t.jsx)("div",{style:{color:"#999",fontSize:"12px",textAlign:"center",padding:"16px"},children:"\u6682\u65E0\u7F51\u5361\u8282\u70B9\uFF0C\u8BF7\u5148\u521B\u5EFA\u5BB9\u5668\u67B6\u6784"}):ve.map(function(v){return(0,t.jsxs)("div",{style:{border:"1px solid #e9ecef",borderRadius:"3px",padding:"8px",marginBottom:"8px",backgroundColor:v.isConnected?"#e8f5e8":"#f8f9fa"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,t.jsxs)("span",{style:{fontSize:"12px",fontWeight:"bold",color:v.isConnected?"#28a745":"#6c757d"},children:["\u{1F4E1} ",v.label]}),(0,t.jsx)("span",{style:{fontSize:"10px",padding:"2px 6px",borderRadius:"10px",backgroundColor:v.isConnected?"#28a745":"#6c757d",color:"white"},children:v.isConnected?"\u5DF2\u8FDE\u63A5":"\u672A\u8FDE\u63A5"})]}),v.isConnected&&v.connectedSwitch&&(0,t.jsxs)("div",{style:{fontSize:"10px",color:"#28a745",marginBottom:"6px",padding:"2px 0"},children:["\u{1F517} \u8FDE\u63A5\u5230: ",v.connectedSwitch]}),(0,t.jsx)("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:v.isConnected?(0,t.jsx)("button",{onClick:function(){return Ke(v.id)},style:{width:"100%",padding:"2px 8px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"10px"},children:"\u65AD\u5F00\u8FDE\u63A5"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("select",{style:{flex:1,padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"10px"},defaultValue:ee[0]||"",id:"switch-select-".concat(v.id),children:ee.map(function(g){return(0,t.jsx)("option",{value:g,children:g},g)})}),(0,t.jsx)("button",{onClick:function(){var w=document.getElementById("switch-select-".concat(v.id)),B=w==null?void 0:w.value;B&&Ve(v.id,B)},style:{padding:"2px 8px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"10px"},children:"\u8FDE\u63A5"})]})})]},v.id)})})]})]}),(0,t.jsxs)("div",{style:{borderTop:"1px solid #e9ecef",paddingTop:"16px"},children:[(0,t.jsx)("button",{onClick:Ze,style:u,title:"\u6839\u636E\u914D\u7F6E\u751F\u6210Docker\u67B6\u6784\u56FE",children:"\u{1F680} \u751F\u6210\u67B6\u6784\u56FE"}),(0,t.jsx)("button",{onClick:$e,style:c()(c()({},u),{},{backgroundColor:"#28a745"}),title:"\u751F\u6210\u793A\u4F8BNginx\u67B6\u6784",children:"\u{1F4CB} \u793A\u4F8B\u67B6\u6784"}),(0,t.jsx)("button",{onClick:Qe,style:N,title:"\u6E05\u9664\u753B\u5E03\u4E0A\u7684\u6240\u6709\u5185\u5BB9",children:"\u{1F5D1}\uFE0F \u6E05\u9664\u753B\u5E03"}),(0,t.jsx)("button",{onClick:function(){if(e){var g=e.getContainerCount(),w=e.getDAGRelationships();alert("\u5BB9\u5668\u6570\u91CF: ".concat(g,`
DAG\u4FE1\u606F: `).concat(JSON.stringify(w,null,2)))}},style:c()(c()({},u),{},{backgroundColor:"#6c757d"}),title:"\u67E5\u770B\u5BB9\u5668\u7EDF\u8BA1\u548CDAG\u5173\u7CFB",children:"\u{1F4CA} \u67E5\u770B\u7EDF\u8BA1"})]}),(0,t.jsxs)("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#f8f9fa",borderRadius:"4px",fontSize:"12px",color:"#6c757d",lineHeight:"1.4"},children:[(0,t.jsx)("strong",{children:"\u{1F4A1} \u4F7F\u7528\u63D0\u793A\uFF1A"}),(0,t.jsx)("br",{}),"\u2022 \u5148\u521B\u5EFA\u4EA4\u6362\u673A\uFF0C\u7136\u540E\u9009\u62E9\u5BB9\u5668\u8981\u8FDE\u63A5\u7684\u4EA4\u6362\u673A",(0,t.jsx)("br",{}),'\u2022 \u70B9\u51FB"\u793A\u4F8B\u67B6\u6784"\u5FEB\u901F\u751F\u6210\u793A\u4F8B',(0,t.jsx)("br",{}),'\u2022 \u586B\u5199\u5404\u9879\u914D\u7F6E\u540E\u70B9\u51FB"\u751F\u6210\u67B6\u6784\u56FE"',(0,t.jsx)("br",{}),"\u2022 \u5BB9\u5668\u4F1A\u81EA\u52A8\u8FDE\u63A5\u5230\u9009\u4E2D\u7684\u4EA4\u6362\u673A",(0,t.jsx)("br",{}),"\u2022 \u652F\u6301\u591A\u4E2A\u7AEF\u53E3\u3001\u5377\u7528\u9017\u53F7\u5206\u9694",(0,t.jsx)("br",{}),"\u2022 \u751F\u6210\u540E\u53EF\u53CC\u51FB\u8282\u70B9\u7F16\u8F91\u6587\u672C\u5185\u5BB9"]})]})},De={YAML:"docker-compose-builder-yaml",TIMESTAMP:"docker-compose-builder-timestamp"},et=function(){var r=(0,y.useCallback)(function(i){try{return localStorage.setItem(De.YAML,i),localStorage.setItem(De.TIMESTAMP,new Date().toISOString()),console.log("\u81EA\u52A8\u4FDD\u5B58\u5230localStorage\u6210\u529F"),!0}catch(o){return console.warn("\u4FDD\u5B58\u5230localStorage\u5931\u8D25:",o),!1}},[]),e=(0,y.useCallback)(function(){try{var i=localStorage.getItem(De.YAML),o=localStorage.getItem(De.TIMESTAMP);if(!i||!o)return null;var s=new Date(o),h=new Date,l=(h.getTime()-s.getTime())/(1e3*60*60);return l>=24?null:{yaml:i,timestamp:s,hoursDiff:l}}catch(d){return console.warn("\u8BFB\u53D6localStorage\u5931\u8D25:",d),null}},[]),a=(0,y.useCallback)(function(){try{return localStorage.removeItem(De.YAML),localStorage.removeItem(De.TIMESTAMP),console.log("\u5DF2\u6E05\u7406localStorage\u6570\u636E"),!0}catch(i){return console.warn("\u6E05\u7406localStorage\u5931\u8D25:",i),!1}},[]),n=(0,y.useCallback)(function(i){var o=e();if(o){var s=window.confirm("\u53D1\u73B0 ".concat(Math.round(o.hoursDiff*10)/10,` \u5C0F\u65F6\u524D\u7684\u4FDD\u5B58\u6570\u636E\uFF0C\u662F\u5426\u6062\u590D\uFF1F

`)+"\u4FDD\u5B58\u65F6\u95F4: ".concat(o.timestamp.toLocaleString()));s&&(console.log("\u5F00\u59CB\u5C1D\u8BD5\u6062\u590D\u6570\u636E..."),i(o.yaml))}},[e]);return{saveYaml:r,loadYaml:e,clearStorage:a,checkAndPromptRestore:n}},gt=Z(31759),Re=Z.n(gt),vt=Z(48464),mt=function $(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a="  ".repeat(e),n="",i=0,o=Object.entries(r);i<o.length;i++){var s=j()(o[i],2),h=s[0],l=s[1];if(l==null)n+="".concat(a).concat(h,`: null
`);else if(Array.isArray(l))l.length===0?n+="".concat(a).concat(h,`: []
`):(n+="".concat(a).concat(h,`:
`),l.forEach(function(m){if(Re()(m)==="object"&&m!==null){var E=Object.keys(m);if(E.length===0)n+="".concat(a,`  - {}
`);else if(E.length===1){var T=j()(Object.entries(m)[0],2),S=T[0],R=T[1];n+="".concat(a,"  - ").concat(S,": ").concat(R,`
`)}else{var F=E[0],M=m[F];n+="".concat(a,"  - ").concat(F,": ").concat(M,`
`),E.slice(1).forEach(function(V){n+="".concat(a,"    ").concat(V,": ").concat(m[V],`
`)})}}else{var z=String(m);z.includes(":")||z.includes(" ")||z.includes("-")?n+="".concat(a,'  - "').concat(z,`"
`):n+="".concat(a,"  - ").concat(z,`
`)}}));else if(Re()(l)==="object"&&l!==null)Object.keys(l).length===0?n+="".concat(a).concat(h,`: {}
`):(n+="".concat(a).concat(h,`:
`),n+=$(l,e+1));else{var d=String(l);d.includes(":")||d.includes("#")||d.includes('"')?n+="".concat(a).concat(h,': "').concat(d,`"
`):n+="".concat(a).concat(h,": ").concat(d,`
`)}}return n},xt=function(r){try{return vt.Qc(r)}catch(a){console.error("YAML\u89E3\u6790\u9519\u8BEF:",a);var e=a instanceof Error?a.message:"YAML\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u8BED\u6CD5";throw new Error(e)}},yt=function(r){var e={image:r.image};if(r.user&&(e.user=r.user),r.entrypoint&&(r.entrypoint==="[]"?e.entrypoint=[]:r.entrypoint.trim()&&(r.entrypointIsArray?e.entrypoint=r.entrypoint.includes(" ")?r.entrypoint.split(" "):[r.entrypoint]:e.entrypoint=r.entrypoint)),r.command&&r.command!=="tail -f /etc/hosts"&&r.command.trim()&&(r.commandIsArray?e.command=r.command.includes(" ")?r.command.split(" "):[r.command]:e.command=r.command),r.ports&&r.ports.length>0&&(e.ports=r.ports),r.volumes&&r.volumes.length>0&&(e.volumes=r.volumes),r.environment&&(e.environment=r.environment),r.networkInterfaces&&r.networkInterfaces.length>0){var a={};r.networkInterfaces.forEach(function(n){n.ipConfig==="static"&&n.staticIP?a[n.switchName]={ipv4_address:n.staticIP}:a[n.switchName]={}}),e.networks=a}return r.restart&&(e.restart=r.restart),r.depends_on&&r.depends_on.length>0&&(e.depends_on=r.depends_on),e},kt=function(r){var e={};return Object.entries(r).forEach(function(a){var n=j()(a,2),i=n[0],o=n[1];e[i]={driver:"bridge",ipam:{config:[{subnet:o.subnet,gateway:o.gateway}]}}}),e},bt=function(r,e){var a=et(),n=a.saveYaml,i=a.clearStorage,o=(0,y.useCallback)(function(){if(!e||!r)return console.log("Docker Factory\u6216Graph\u672A\u521D\u59CB\u5316"),"";var h=r.getNodes(),l=h.filter(function(R){return R.shape==="docker-container"});if(l.length===0)return i(),`# \u672A\u627E\u5230\u4EFB\u4F55Docker\u5BB9\u5668
version: "3.8"
services: {}`;var d={},m={},E=new Set;l.forEach(function(R){var F=R.getChildren()||[],M=R.getData(),z=(M==null?void 0:M.config)||{},V=F.find(function(D){return D.shape==="docker-service"}),U=V==null?void 0:V.attr("text/text"),le=(typeof U=="string"?U:null)||(typeof R.attr("text/text")=="string"?R.attr("text/text"):null)||"service",_=F.find(function(D){return D.shape==="docker-image"}),C=_==null?void 0:_.attr("text/text"),G=(typeof C=="string"?C:null)||"nginx:latest",H=F.find(function(D){return D.shape==="docker-user"}),W=(H==null?void 0:H.attr("text/text"))||"",p=W&&typeof W=="string"?W.replace("user: ",""):void 0,A=F.filter(function(D){return D.shape==="docker-script"}),x="",L="tail -f /etc/hosts";A.forEach(function(D){var ae=D.getData(),q=ae==null?void 0:ae.scriptType,O=D.attr("text/text");q==="entrypoint"?x=O:(q==="command"||!q)&&(L=O)});var re=F.filter(function(D){return D.shape==="docker-port"}),oe=re.map(function(D){return D.attr("text/text")}),X=F.filter(function(D){return D.shape==="docker-volume"}),ne=X.map(function(D){return D.attr("text/text")});ne.forEach(function(D){if(D&&D.includes(":")){var ae=D.split(":"),q=j()(ae,1),O=q[0];!O.startsWith("/")&&!O.startsWith(".")&&E.add(O)}});var ie=F.filter(function(D){return D.shape==="docker-network"}),ue=[];ie.forEach(function(D){var ae=D.getData(),q=ae==null?void 0:ae.networkInterface;q&&ue.push(q)});var se={containerName:le,image:G,user:p,ports:oe,volumes:ne,environment:z.environment||[],networkInterfaces:ue,switchNetworks:z.switchNetworks||{},entrypoint:x,entrypointIsArray:z.entrypointIsArray,command:L,commandIsArray:z.commandIsArray,restart:z.restart||"unless-stopped",depends_on:z.depends_on||[]};d[le]=yt(se),se.switchNetworks&&Object.assign(m,se.switchNetworks)});var T={version:"3.8",services:d};Object.keys(m).length>0&&(T.networks=kt(m)),E.size>0&&(T.volumes={},E.forEach(function(R){T.volumes[R]={}}));var S=mt(T);return n(S),S},[e,r,n,i]),s=(0,y.useCallback)(function(h){if(!e||!r||!h.trim())return console.log("\u8BF7\u8F93\u5165\u6709\u6548\u7684YAML\u5185\u5BB9"),!1;try{var l=xt(h);if(!l.services)throw new Error("\u672A\u627E\u5230services\u914D\u7F6E");var d=r.getNodes(),m=d.filter(function(C){return C.shape==="docker-container"});if(m.length>0){var E=window.confirm("\u753B\u5E03\u4E0A\u5DF2\u6709\u5BB9\u5668\uFF0C\u662F\u5426\u6E05\u7A7A\u73B0\u6709\u5185\u5BB9\uFF1F");E&&r.clearCells()}var T=750,S=350,R=50,F=50,M=50,z=50,V=2,U={};Object.entries(l.services).forEach(function(C,G){var H=j()(C,2),W=H[0],p=H[1],A=p.ports?Array.isArray(p.ports)?p.ports:[p.ports]:[],x=p.volumes?Array.isArray(p.volumes)?p.volumes:[p.volumes]:[],L=[];p.networks&&(Array.isArray(p.networks)?p.networks.forEach(function(q,O){L.push({interfaceName:"eth".concat(O),switchName:q,ipConfig:"dynamic"})}):Re()(p.networks)==="object"&&Object.entries(p.networks).forEach(function(q,O){var Q=j()(q,2),he=Q[0],Ce=Q[1];L.push({interfaceName:"eth".concat(O),switchName:he,ipConfig:"static",staticIP:Ce.ipv4_address||"172.20.0.100"})}));var re=Math.floor(G/V),oe=G%V,X=M+oe*(T+R),ne=z+re*(S+F),ie=e.createDockerArchitecture({containerName:W,image:p.image||"docker.io/library/nginx:latest",user:p.user,entrypoint:p.entrypoint!==void 0?Array.isArray(p.entrypoint)?p.entrypoint.length>0?p.entrypoint.join(" "):"[]":p.entrypoint:void 0,command:p.command?Array.isArray(p.command)?p.command.join(" "):p.command:"tail -f /etc/hosts",ports:A,volumes:x,networkInterfaces:L,position:{x:X,y:ne}}),ue=ie.containerNode;U[W]=ue;var se={};l.networks&&Object.entries(l.networks).forEach(function(q){var O,Q,he=j()(q,2),Ce=he[0],we=he[1];se[Ce]={subnet:((O=we.ipam)===null||O===void 0||(O=O.config)===null||O===void 0||(O=O[0])===null||O===void 0?void 0:O.subnet)||"172.20.0.0/16",gateway:((Q=we.ipam)===null||Q===void 0||(Q=Q.config)===null||Q===void 0||(Q=Q[0])===null||Q===void 0?void 0:Q.gateway)||"172.20.0.1"}});var D=[];p.depends_on&&(Array.isArray(p.depends_on)?D=p.depends_on:Re()(p.depends_on)==="object"&&(D=Object.keys(p.depends_on)));var ae={containerName:W,image:p.image||"docker.io/library/nginx:latest",user:p.user,ports:A,volumes:x,environment:p.environment||[],networkInterfaces:L,switchNetworks:se,entrypoint:p.entrypoint!==void 0?Array.isArray(p.entrypoint)?p.entrypoint.length>0?p.entrypoint.join(" "):"[]":p.entrypoint:"",entrypointIsArray:Array.isArray(p.entrypoint),command:p.command?Array.isArray(p.command)?p.command.join(" "):p.command:"tail -f /etc/hosts",commandIsArray:Array.isArray(p.command),restart:p.restart||"unless-stopped",depends_on:D};ue.setData({config:ae}),ue.attr("text/text","")});var le={};return l.networks&&Object.keys(l.networks).forEach(function(C,G){var H=r.getNodes().find(function(se){if(se.shape==="network-switch"){var D=se.getData();return(D==null?void 0:D.switchName)===C}return!1});if(!H){var W,p,A,x=(W=l.networks)===null||W===void 0?void 0:W[C],L=x?{subnet:(p=x.ipam)===null||p===void 0||(p=p.config)===null||p===void 0||(p=p[0])===null||p===void 0?void 0:p.subnet,gateway:(A=x.ipam)===null||A===void 0||(A=A.config)===null||A===void 0||(A=A[0])===null||A===void 0?void 0:A.gateway}:void 0,re=L?{subnet:L.subnet}:void 0;H=e.createSwitch(C,re);var oe=M+V*(T+R)+100,X=z+G*150;if(H.setPosition({x:oe,y:X}),L!=null&&L.gateway){var ne="".concat(C,"_router"),ie="".concat(ne,`
GW: `).concat(L.gateway),ue=e.createRouter(ie);ue.setPosition({x:oe+200,y:X}),r.addEdge({source:{cell:H.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:ue.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#28a745",strokeWidth:3}},data:{originalStroke:"#28a745",originalWidth:3}})}}le[C]=H}),setTimeout(function(){Object.values(U).forEach(function(C){var G=C.getChildren()||[],H=G.filter(function(W){return W.shape==="docker-network"});H.forEach(function(W){var p=W.getData(),A=p==null?void 0:p.networkInterface;if(A&&A.switchName){var x=le[A.switchName];if(x){var L=r.getCellById(W.id),re=r.getCellById(x.id);if(!L||!re){console.error("\u8282\u70B9\u4E0D\u5B58\u5728\uFF0C\u8DF3\u8FC7\u8FDE\u63A5");return}r.addEdge({source:{cell:W.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:x.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#28a745",strokeWidth:2,targetMarker:{name:"block",width:8,height:6}}},zIndex:0}),console.log("\u8FDE\u63A5\u7F51\u5361 ".concat(A.interfaceName," \u5230\u4EA4\u6362\u673A ").concat(A.switchName))}}})}),console.log("\u6240\u6709\u7F51\u7EDC\u8FDE\u63A5\u521B\u5EFA\u5B8C\u6210"),Object.entries(l.services).forEach(function(C){var G,H=j()(C,2),W=H[0],p=H[1],A=U[W];if(A){var x=A.getData(),L=(x==null||(G=x.config)===null||G===void 0?void 0:G.depends_on)||[];L.forEach(function(re){var oe=U[re];oe&&(r.addEdge({source:{cell:oe.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:A.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,step:10}},attrs:{line:{stroke:"#ff6b6b",strokeWidth:2,strokeDasharray:"5 5",targetMarker:{name:"block",width:8,height:6}}},zIndex:1,data:{type:"dependency",originalStroke:"#ff6b6b",originalWidth:2}}),console.log("\u521B\u5EFA\u4F9D\u8D56\u5173\u7CFB\u8FDE\u63A5: ".concat(re," -> ").concat(W)))})}}),console.log("\u6240\u6709\u4F9D\u8D56\u5173\u7CFB\u8FDE\u63A5\u521B\u5EFA\u5B8C\u6210")},100),n(h),console.log("Docker Compose\u5BFC\u5165\u6210\u529F - \u5305\u542B\u7F51\u7EDC\u62D3\u6251"),!0}catch(C){console.error("\u5BFC\u5165\u5931\u8D25:",C);var _=C instanceof Error?C.message:"\u672A\u77E5\u9519\u8BEF";return alert("\u5BFC\u5165\u5931\u8D25: ".concat(_)),!1}},[e,r,n]);return{exportDockerCompose:o,importDockerCompose:s}},Ct=function(r,e){var a=(0,y.useState)({visible:!1,x:0,y:0,node:null,nodeType:""}),n=j()(a,2),i=n[0],o=n[1],s=(0,y.useState)(!1),h=j()(s,2),l=h[0],d=h[1],m=(0,y.useState)(null),E=j()(m,2),T=E[0],S=E[1],R=(0,y.useState)({interfaceName:"",switchName:"",ipConfig:"dynamic",staticIP:""}),F=j()(R,2),M=F[0],z=F[1],V=(0,y.useCallback)(function(_,C){_.preventDefault();var G="";C.shape==="docker-container"?G="container":["docker-service","docker-image","docker-port","docker-volume","docker-network","docker-script","docker-user"].includes(C.shape)?G="component":G="other",o({visible:!0,x:_.clientX,y:_.clientY,node:C,nodeType:G})},[]),U=(0,y.useCallback)(function(){o(function(_){return c()(c()({},_),{},{visible:!1})})},[]),le=(0,y.useCallback)(function(_){if(!(!e||!i.node)){var C=i.node;switch(_){case"add-port":if(C.shape==="docker-container"){var G=prompt("\u8BF7\u8F93\u5165\u7AEF\u53E3\u6620\u5C04 (\u4F8B\u5982: 8080:80)","8080:80");G&&e.addPortToContainer(C,G)}break;case"add-volume":if(C.shape==="docker-container"){var H=prompt("\u8BF7\u8F93\u5165\u5377\u6302\u8F7D (\u4F8B\u5982: /host/path:/container/path)","/data:/app/data");H&&e.addVolumeToContainer(C,H)}break;case"add-network":if(C.shape==="docker-container"){for(var W=C.getChildren()||[],p=W.filter(function(X){return X.shape==="docker-network"}).map(function(X){var ne,ie,ue=X.getData()||{};return((ne=ue.networkInterface)===null||ne===void 0?void 0:ne.interfaceName)||((ie=X.attr("text/text"))===null||ie===void 0?void 0:ie.split(`
`)[0])||""}),A="eth0",x=0;p.includes(A);)x++,A="eth".concat(x);z({interfaceName:A,switchName:"",ipConfig:"dynamic",staticIP:""}),S(C),d(!0)}break;case"add-user":if(C.shape==="docker-container"){if(e.hasUniqueComponent(C,"docker-user")){alert("\u5BB9\u5668\u5DF2\u6709\u7528\u6237\u914D\u7F6E\uFF0C\u6BCF\u4E2A\u5BB9\u5668\u53EA\u80FD\u6709\u4E00\u4E2A\u7528\u6237\u914D\u7F6E");break}var L=prompt("\u8BF7\u8F93\u5165\u7528\u6237\u914D\u7F6E (\u4F8B\u5982: root \u6216 1000:1000)","root");if(L){var re=C.getPosition(),oe=r==null?void 0:r.addNode({shape:"docker-user",x:re.x+180,y:re.y+40,label:"user: ".concat(L),zIndex:10});oe&&C.addChild(oe)}}break;case"delete-component":i.nodeType==="component"&&confirm("\u786E\u5B9A\u8981\u5220\u9664\u6B64\u7EC4\u4EF6\u5417\uFF1F")&&e.removeChildComponent(C);break}U()}},[e,i.node,i.nodeType,r,U]);return{contextMenu:i,handleContextMenu:V,hideContextMenu:U,handleMenuItemClick:le,showNetworkModal:l,setShowNetworkModal:d,currentContainerNode:T,networkModalData:M,setNetworkModalData:z}},wt=function(r,e,a,n){return{container:r,width:a,height:n,grid:!0,scroller:{enabled:!0,pannable:!1,pageVisible:!1,pageBreak:!1,autoResize:!0,padding:50},mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10,excludeTerminals:[]}},connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge:function(){return new te.bn.kS({attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:0})},validateConnection:function(o){var s=o.targetMagnet;return!!s}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},resizing:!0,rotating:!0,selecting:{enabled:!0,rubberband:!0,showNodeSelectionBox:!0,showEdgeSelectionBox:!0,movable:!0,multiple:!0,strict:!1,following:!0},snapline:{enabled:!0},keyboard:!0,clipboard:!0,history:!0,minimap:{enabled:!0,container:e,width:250,height:150,padding:10,scalable:!0,graphOptions:{async:!0,createCellView:function(o){if(o.isEdge())return null}}}}},Pe=function(r){var e=new Set(r),a=function n(i){var o=i.getChildren();o&&o.length>0&&o.forEach(function(s){e.add(s),n(s)})};return r.forEach(function(n){a(n)}),Array.from(e)},Et=function(r,e,a){var n=(0,y.useCallback)(function(){if(r){r.bindKey(["meta+c","ctrl+c"],function(){var o=r.getSelectedCells();if(o.length){var s=Pe(o),h=s.filter(function(d){return d.isNode()}),l=s.filter(function(d){return d.isEdge()});r.copy(s),console.log("\u5DF2\u590D\u5236: \u76F4\u63A5\u9009\u4E2D ".concat(o.length," \u4E2A\u5143\u7D20\uFF0C\u5305\u542B\u7236\u5B50\u5173\u7CFB\u540E ").concat(s.length," \u4E2A\u5143\u7D20"),{\u9009\u4E2D:o.length,\u603B\u8BA1:s.length,\u8282\u70B9:h.length,\u8FB9:l.length})}return!1}),r.bindKey(["meta+x","ctrl+x"],function(){var o=r.getSelectedCells();if(o.length){var s=Pe(o),h=s.filter(function(d){return d.isNode()}),l=s.filter(function(d){return d.isEdge()});r.cut(s),console.log("\u5DF2\u526A\u5207: \u76F4\u63A5\u9009\u4E2D ".concat(o.length," \u4E2A\u5143\u7D20\uFF0C\u5305\u542B\u7236\u5B50\u5173\u7CFB\u540E ").concat(s.length," \u4E2A\u5143\u7D20"),{\u9009\u4E2D:o.length,\u603B\u8BA1:s.length,\u8282\u70B9:h.length,\u8FB9:l.length})}return!1}),r.bindKey(["meta+v","ctrl+v"],function(){if(!r.isClipboardEmpty()){var o=r.paste({offset:32});o.forEach(function(s,h){if(s.isNode()&&s.shape==="docker-container"){for(var l=s.getData()||{},d=l.config||{},m=s.attr("text/text")||"",E=m||d.containerName||"container",T=E.replace(/\d+$/,""),S=2,R=(r==null?void 0:r.getNodes().filter(function(U){return U.shape==="docker-container"}))||[],F=R.map(function(U){return U.attr("text/text")||""});F.includes("".concat(T).concat(S));)S++;var M="".concat(T).concat(S),z=M,V={containerName:z,image:d.image||"docker.io/library/nginx:latest",ports:d.ports||["80"],volumes:d.volumes||[],environment:d.environment||[],networkInterfaces:d.networkInterfaces||[{interfaceName:"eth0",switchName:"nginx-tomcat",ipConfig:"static",staticIP:"172.20.0.".concat(100+h)}],switchNetworks:d.switchNetworks||{"nginx-tomcat":{subnet:"172.20.0.0/16",gateway:"172.20.0.1"},switch1:{subnet:"172.18.0.0/16",gateway:"172.18.0.1"},switch2:{subnet:"172.19.0.0/16",gateway:"172.19.0.1"}},entrypoint:d.entrypoint||"",entrypointIsArray:d.entrypointIsArray,command:d.command||"tail -f /etc/hosts",commandIsArray:d.commandIsArray,restart:d.restart||"unless-stopped"};s.attr("text/text",M),s.setData(c()(c()({},l),{},{config:V}))}}),r.cleanSelection(),r.select(o),console.log("\u5DF2\u7C98\u8D34 ".concat(o.length," \u4E2A\u5143\u7D20"))}return!1}),r.bindKey(["meta+z","ctrl+z"],function(){return r.history.canUndo()&&r.history.undo(),!1}),r.bindKey(["meta+shift+z","ctrl+shift+z","ctrl+y","meta+y"],function(){return r.history.canRedo()&&r.history.redo(),!1}),r.bindKey(["meta+a","ctrl+a"],function(){var o=r.getNodes();o&&r.select(o)});var i=function(){var s=document.activeElement,h=s&&(s.tagName==="INPUT"||s.tagName==="TEXTAREA"||s.tagName==="SELECT"||s.getAttribute("contenteditable")==="true"||s.isContentEditable||s.tagName==="DIV"&&s.closest(".x6-widget-text-editor")),l=s&&(s.closest(".ant-modal")||s.closest('[role="dialog"]')||a);if(h||l)return!1;var d=r.getSelectedCells();if(d.length){var m=Pe(d),E=m.filter(function(S){return S.isNode()}),T=m.filter(function(S){return S.isEdge()});return r.removeCells(m),console.log("\u5DF2\u5220\u9664: \u76F4\u63A5\u9009\u4E2D ".concat(d.length," \u4E2A\u5143\u7D20\uFF0C\u5305\u542B\u7236\u5B50\u5173\u7CFB\u540E ").concat(m.length," \u4E2A\u5143\u7D20"),{\u9009\u4E2D:d.length,\u603B\u8BA1:m.length,\u8282\u70B9:E.length,\u8FB9:T.length}),!0}return!1};r.bindKey("delete",function(){var o=i();return o}),r.bindKey(["ctrl+1","meta+1"],function(){var o=r.zoom();o<1.5&&r.zoom(.1)}),r.bindKey(["ctrl+2","meta+2"],function(){var o=r.zoom();o>.5&&r.zoom(-.1)})}},[r,a]);return(0,y.useEffect)(function(){var i=!1,o=function(l){if(l.code==="Space"&&!i){var d=document.activeElement,m=d&&(d.tagName==="INPUT"||d.tagName==="TEXTAREA"||d.tagName==="SELECT"||d.getAttribute("contenteditable")==="true");if(m)return;l.preventDefault(),i=!0,e&&e(!0)}},s=function(l){l.code==="Space"&&i&&(l.preventDefault(),i=!1,e&&e(!1))};return document.addEventListener("keydown",o),document.addEventListener("keyup",s),function(){document.removeEventListener("keydown",o),document.removeEventListener("keyup",s)}},[e]),{bindShortcuts:n}},Ft=function(r){var e=(0,y.useState)(!1),a=j()(e,2),n=a[0],i=a[1],o=(0,y.useCallback)(function(s){r&&(i(s),s?(r.enablePanning(),r.disableSelection(),r.disableRubberband()):(r.disablePanning(),r.enableSelection(),r.enableRubberband()))},[r]);return{isDragMode:n,togglePanningMode:o}},Dt=function(r){var e=(0,y.useCallback)(function(){r&&r.getCells().forEach(function(o){o.removeTools()})},[r]),a=function(s,h){r&&(console.log("add node-editor"),s.addTools([{name:"node-editor",args:{event:h}}]))},n=(0,y.useCallback)(function(o,s){r&&o.addTools([{name:"edge-editor",args:{event:s,labelAddable:!0,attrs:{fontSize:"12px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:"#333",backgroundColor:"#fff"},getText:function(){var l;return((l=o.getLabels())===null||l===void 0||(l=l[0])===null||l===void 0||(l=l.attrs)===null||l===void 0||(l=l.text)===null||l===void 0?void 0:l.text)||""},setText:function(l){var d=l.trim();d?o.setLabels([{attrs:{text:{text:d,fontSize:12,fill:"#333",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},rect:{fill:"#fff",stroke:"#1890ff",strokeWidth:1,rx:4,ry:4,refWidth:"100%",refHeight:"100%",refX:"-50%",refY:"-50%"}}}]):o.setLabels([])}}}])},[r]),i=(0,y.useCallback)(function(o,s){o.isNode()?a(o,s):o.isEdge()&&n(o,s)},[a,n]);return{clearAllEditingTools:e,addNodeEditor:a,addEdgeEditor:n,handleDoubleClick:i}},St=function(){var r,e=(0,y.useRef)(null),a=(0,y.useRef)(null),n=(0,y.useRef)(null),i=(0,y.useState)(),o=j()(i,2),s=o[0],h=o[1],l=(0,y.useState)(!1),d=j()(l,2),m=d[0],E=d[1],T=(0,y.useState)(!1),S=j()(T,2),R=S[0],F=S[1],M=(0,y.useState)(!1),z=j()(M,2),V=z[0],U=z[1],le=(0,y.useState)(""),_=j()(le,2),C=_[0],G=_[1],H=(0,y.useState)(""),W=j()(H,2),p=W[0],A=W[1],x=(0,y.useRef)(),L=(0,y.useRef)(!1),re=(0,y.useState)(!1),oe=j()(re,2),X=oe[0],ne=oe[1],ie=et(),ue=ie.saveYaml,se=ie.clearStorage,D=ie.checkAndPromptRestore,ae=bt(x.current,s),q=ae.exportDockerCompose,O=ae.importDockerCompose,Q=Ft(x.current),he=Q.isDragMode,Ce=Q.togglePanningMode,we=m||R||V,Me=Et(x.current,Ce,we),Se=Me.bindShortcuts,Ue=Dt(x.current),We=Ue.handleDoubleClick,ee=Ct(x.current,s),ge=ee.contextMenu,Je=ee.handleContextMenu,Ae=ee.hideContextMenu,ve=ee.handleMenuItemClick,Le=ee.showNetworkModal,ze=ee.setShowNetworkModal,me=ee.currentContainerNode,b=ee.networkModalData,xe=ee.setNetworkModalData,Ee=function(){D(function(u){var N=O(u);N&&(U(!1),A(""))})},ye=function(){var u=q();G(u),F(!0)},Ve=function(u){var N=typeof u=="string"?u:p,k=O(N);k&&(U(!1),A(""))},Ke=function(){if(confirm("\u786E\u5B9A\u8981\u6E05\u7A7A\u753B\u5E03\u5417\uFF1F\u6240\u6709\u672A\u4FDD\u5B58\u7684\u5185\u5BB9\u5C06\u4E22\u5931\u3002")){var u;(u=x.current)===null||u===void 0||u.clearCells(),se(),console.log("\u753B\u5E03\u5DF2\u91CD\u7F6E")}},Ze=function(){x.current&&x.current.toPNG(function(u){var N=document.createElement("a");N.download="docker-compose-diagram.png",N.href=u,N.click()},{backgroundColor:"#f5f5f5",padding:20})},tt=function(){x.current&&x.current.toSVG(function(u){var N=document.createElement("a");N.download="docker-compose-diagram.svg",N.href=u,N.click()},{preserveDimensions:!0})},rt=function(){if(x.current){var u=x.current.toJSON(),N=JSON.stringify(u,null,2),k=new Blob([N],{type:"application/json"}),de=URL.createObjectURL(k),v=document.createElement("a");v.download="docker-compose-diagram.json",v.href=de,v.click(),URL.revokeObjectURL(de)}},Xe=function(){x.current&&x.current.zoomToFit({padding:20,maxScale:1})},Ne=function(){x.current&&x.current.centerContent()},Qe=function(){if(x.current){var u=x.current.zoom();u<2&&x.current.zoom(.1)}},$e=function(){if(x.current){var u=x.current.zoom();u>.2&&x.current.zoom(-.1)}},ce=function(){x.current&&x.current.zoomTo(1)};return(0,y.useEffect)(function(){if(!(!e.current||!a.current||!n.current)){ft();var f=e.current.clientWidth||window.innerWidth-180,u=e.current.clientHeight||window.innerHeight-125,N=wt(e.current,n.current,f,u),k=new te.kJ(N);x.current=k,Se();var de=new te.e9.tb({title:"\u6D41\u7A0B\u56FE",target:k,stencilGraphWidth:200,stencilGraphHeight:180,collapsable:!0,groups:[{title:"\u57FA\u7840\u6D41\u7A0B\u56FE",name:"group1"},{title:"\u7CFB\u7EDF\u8BBE\u8BA1\u56FE",name:"group2",graphHeight:250,layoutOptions:{rowHeight:70}}],layoutOptions:{columns:2,columnWidth:80,rowHeight:55}});k.on("node:contextmenu",function(K){var P=K.e,I=K.node;Je(P,I)}),document.addEventListener("click",Ae),k.on("blank:click",Ae);var v=function(P,I){for(var Y=0,pe=P.length;Y<pe;Y=Y+1)P[Y].style.visibility=I?"visible":"hidden"};k.on("node:mouseenter",function(K){var P=K.node,I=[];if(P.shape==="docker-container")I=[P];else if(["docker-service","docker-script","docker-image","docker-volume","docker-port","docker-network"].includes(P.shape)){var Y=P.getParent();Y&&Y.shape==="docker-container"&&(I=[Y]),I.push(P)}else["network-switch","network-router"].includes(P.shape)?I=[P]:I=[P];I.forEach(function(pe){var ke,Ge=(ke=k.findViewByCell(pe))===null||ke===void 0?void 0:ke.container;if(Ge){var Be=Ge.querySelectorAll(".x6-port-body");v(Be,!0)}})}),k.on("node:mouseleave",function(K){var P=K.node,I=K.e;setTimeout(function(){var Y=document.elementFromPoint(I.clientX||0,I.clientY||0),pe=Y==null?void 0:Y.closest(".x6-node");if(!pe){var ke=e.current.querySelectorAll(".x6-port-body");v(ke,!1)}},100)}),k.on("edge:mouseenter",function(K){var P=K.edge;if(P.addTools([{name:"vertices",args:{attrs:{fill:"#007bff",stroke:"#fff","stroke-width":2},snapRadius:20}},{name:"segments",args:{threshold:40,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#007bff",stroke:"#fff","stroke-width":2}}},{name:"source-arrowhead",args:{attrs:{fill:"#28a745",stroke:"#fff","stroke-width":2,cursor:"move"}}},{name:"target-arrowhead",args:{attrs:{fill:"#dc3545",stroke:"#fff","stroke-width":2,cursor:"move"}}},{name:"button-remove",args:{distance:20,markup:[{tagName:"circle",selector:"button",attrs:{r:8,stroke:"#dc3545","stroke-width":2,fill:"#fff",cursor:"pointer"}},{tagName:"text",textContent:"\xD7",selector:"icon",attrs:{fill:"#dc3545","font-size":12,"text-anchor":"middle","pointer-events":"none",y:"0.3em","font-weight":"bold"}}]}}]),!k.isSelected(P)){var I=P.getData()||{},Y=I.originalStroke||"#6c757d",pe=I.originalWidth||2;P.attr({line:{strokeWidth:pe+1,stroke:"#007bff"}}),I.originalStroke?P.setData(c()(c()({},I),{},{isHovering:!0})):P.setData(c()(c()({},I),{},{originalStroke:Y,originalWidth:pe,isHovering:!0}))}}),k.on("edge:mouseleave",function(K){var P,I=K.edge;if(I.removeTools(),!k.isSelected(I)&&(P=I.getData())!==null&&P!==void 0&&P.isHovering){var Y=I.getData();I.attr({line:{strokeWidth:Y.originalWidth||2,stroke:Y.originalStroke||"#6c757d"}}),I.setData(c()(c()({},Y),{},{isHovering:!1}))}}),k.on("cell:dblclick",function(K){var P=K.cell,I=K.e;We(P,I)}),k.on("selection:changed",function(K){var P=K.added,I=K.removed,Y=k.getSelectedCells();I.forEach(function(J){J.isEdge()&&J.removeTools()}),k.getEdges().forEach(function(J){var be,Ie,ot=J.getData()||{},Tt=ot.originalStroke||(((be=J.getTargetNode())===null||be===void 0?void 0:be.shape)==="network-router"?"#28a745":"#6c757d"),Mt=ot.originalWidth||(((Ie=J.getTargetNode())===null||Ie===void 0?void 0:Ie.shape)==="network-router"?3:2);J.attr({line:{strokeWidth:Mt,stroke:Tt}})});var pe=Y.filter(function(J){return J.isEdge()});if(pe.forEach(function(J){J.attr({line:{strokeWidth:4,stroke:"#ff6b35"}}),J.addTools([{name:"vertices",args:{attrs:{fill:"#ff6b35",stroke:"#fff","stroke-width":2},snapRadius:20}},{name:"segments",args:{threshold:30,attrs:{width:24,height:10,x:-12,y:-5,rx:5,ry:5,fill:"#ff6b35",stroke:"#fff","stroke-width":2}}},{name:"source-arrowhead",args:{attrs:{fill:"#28a745",stroke:"#fff","stroke-width":3,cursor:"move",d:"M 12 -10 -12 0 12 10 Z"}}},{name:"target-arrowhead",args:{attrs:{fill:"#dc3545",stroke:"#fff","stroke-width":3,cursor:"move",d:"M -12 -10 12 0 -12 10 Z"}}},{name:"button-remove",args:{distance:30,markup:[{tagName:"circle",selector:"button",attrs:{r:10,stroke:"#dc3545","stroke-width":3,fill:"#fff",cursor:"pointer"}},{tagName:"text",textContent:"\u2715",selector:"icon",attrs:{fill:"#dc3545","font-size":14,"text-anchor":"middle","pointer-events":"none",y:"0.3em","font-weight":"bold"}}]}}])}),Y.length>0){var ke=Y.filter(function(J){return J.isNode()}),Ge=Y.filter(function(J){return J.isEdge()}),Be=Pe(Y),Bt=Be.filter(function(J){return J.isNode()}),jt=Be.filter(function(J){return J.isEdge()});console.log("\u9009\u62E9\u53D8\u5316: \u76F4\u63A5\u9009\u4E2D ".concat(Y.length," \u4E2A\u5143\u7D20\uFF0C\u5305\u542BaddChild\u5173\u7CFB\u540E ").concat(Be.length," \u4E2A\u5143\u7D20"),{\u76F4\u63A5\u9009\u4E2D:{\u603B\u8BA1:Y.length,\u8282\u70B9:ke.length,\u8FB9:Ge.length},\u5305\u542B\u5B50\u8282\u70B9\u540E:{\u603B\u8BA1:Be.length,\u8282\u70B9:Bt.length,\u8FB9:jt.length},\u64CD\u4F5C:{\u65B0\u589E:P.length,\u79FB\u9664:I.length}}),ke.forEach(function(J){var be=J.getChildren();be&&be.length>0&&console.log("\u8282\u70B9 ".concat(J.id," \u6709 ").concat(be.length," \u4E2A\u5B50\u8282\u70B9:"),be.map(function(Ie){return Ie.id}))})}});var g={groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]};te.kJ.registerNode("custom-rect",{inherit:"rect",width:66,height:36,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF"},text:{fontSize:12,fill:"#262626"}},ports:c()({},g)},!0),te.kJ.registerNode("custom-polygon",{inherit:"polygon",width:66,height:36,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF"},text:{fontSize:12,fill:"#262626"}},ports:c()(c()({},g),{},{items:[{group:"top"},{group:"bottom"}]})},!0),te.kJ.registerNode("custom-circle",{inherit:"circle",width:45,height:45,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF"},text:{fontSize:12,fill:"#262626"}},ports:c()({},g)},!0),te.kJ.registerNode("custom-image",{inherit:"rect",width:52,height:52,markup:[{tagName:"rect",selector:"body"},{tagName:"image"},{tagName:"text",selector:"label"}],attrs:{body:{stroke:"#5F95FF",fill:"#5F95FF"},image:{width:26,height:26,refX:13,refY:16},label:{refX:3,refY:2,textAnchor:"left",textVerticalAnchor:"top",fontSize:12,fill:"#fff"}},ports:c()({},g)},!0);var w=k.createNode({shape:"custom-rect",label:"\u5F00\u59CB",attrs:{body:{rx:20,ry:26}}}),B=k.createNode({shape:"custom-rect",label:"\u8FC7\u7A0B"}),fe=k.createNode({shape:"custom-rect",attrs:{body:{rx:6,ry:6}},label:"\u53EF\u9009\u8FC7\u7A0B"}),Oe=k.createNode({shape:"custom-polygon",attrs:{body:{refPoints:"0,10 10,0 20,10 10,20"}},label:"\u51B3\u7B56"}),_e=k.createNode({shape:"custom-polygon",attrs:{body:{refPoints:"10,0 40,0 30,20 0,20"}},label:"\u6570\u636E"}),Fe=k.createNode({shape:"custom-circle",label:"\u8FDE\u63A5"});de.load([w,B,fe,Oe,_e,Fe],"group1");var Ye=[{label:"Client",image:"https://gw.alipayobjects.com/zos/bmw-prod/687b6cb9-4b97-42a6-96d0-34b3099133ac.svg"},{label:"Http",image:"https://gw.alipayobjects.com/zos/bmw-prod/dc1ced06-417d-466f-927b-b4a4d3265791.svg"},{label:"Api",image:"https://gw.alipayobjects.com/zos/bmw-prod/c55d7ae1-8d20-4585-bd8f-ca23653a4489.svg"},{label:"Sql",image:"https://gw.alipayobjects.com/zos/bmw-prod/6eb71764-18ed-4149-b868-53ad1542c405.svg"},{label:"Cloud",image:"https://gw.alipayobjects.com/zos/bmw-prod/c36fe7cb-dc24-4854-aeb5-88d8dc36d52e.svg"},{label:"Mq",image:"https://gw.alipayobjects.com/zos/bmw-prod/2010ac9f-40e7-49d4-8c4a-4fcf2f83033b.svg"}],He=Ye.map(function(K){return k.createNode({shape:"custom-image",label:K.label,attrs:{image:{"xlink:href":K.image}}})});de.load(He,"group2");var Nt=new pt(k);return h(Nt),function(){document.removeEventListener("click",Ae),k.dispose()}}},[]),(0,y.useEffect)(function(){x.current&&Se()},[Se]),(0,y.useEffect)(function(){if(s&&x.current&&!L.current){L.current=!0;var f=setTimeout(function(){Ee()},100);return function(){return clearTimeout(f)}}},[s,Ee]),(0,t.jsxs)("div",{className:"app",children:[(0,t.jsx)("div",{ref:a,className:"stencil-container"}),(0,t.jsx)("div",{className:"app-content",ref:e}),(0,t.jsx)("div",{ref:n,className:"minimap-container"}),(0,t.jsx)("button",{onClick:function(){return ne(!X)},style:{position:"fixed",top:"20px",right:"20px",width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#ffc107",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(255, 193, 7, 0.4)",transition:"all 0.3s ease",zIndex:1001},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#e0a800"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#ffc107"},title:X?"\u5C55\u5F00\u5DE5\u5177\u680F":"\u6298\u53E0\u5DE5\u5177\u680F",children:X?"\u2630":"\u2715"}),(0,t.jsxs)("div",{style:{position:"fixed",top:"20px",right:"80px",display:X?"none":"flex",gap:"10px",zIndex:1e3},children:[(0,t.jsx)("button",{onClick:function(){return U(!0)},style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#17a2b8",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(23, 162, 184, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#138496"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#17a2b8"},title:"\u5BFC\u5165Docker Compose",children:"\u{1F4E4}"}),(0,t.jsx)("button",{onClick:ye,style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#28a745",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(40, 167, 69, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#1e7e34"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#28a745"},title:"\u5BFC\u51FADocker Compose YAML",children:"\u{1F4C1}"}),(0,t.jsx)("button",{onClick:Ze,style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#6f42c1",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(111, 66, 193, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a32a3"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6f42c1"},title:"\u5BFC\u51FA\u4E3A PNG \u56FE\u7247",children:"\u{1F5BC}\uFE0F"}),(0,t.jsx)("button",{onClick:function(){return E(!0)},style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#007bff",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(0, 123, 255, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#0056b3"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#007bff"},title:"Docker\u914D\u7F6E",children:"\u{1F433}"}),(0,t.jsx)("button",{onClick:Ke,style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#dc3545",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(220, 53, 69, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#c82333"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#dc3545"},title:"\u91CD\u7F6E\u753B\u5E03\uFF08\u6E05\u7A7A\u6240\u6709\u5185\u5BB9\uFF09",children:"\u{1F504}"})]}),(0,t.jsxs)("div",{style:{position:"fixed",top:"100px",right:"80px",display:X?"none":"flex",gap:"10px",zIndex:1e3},children:[(0,t.jsx)("button",{onClick:Qe,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"20px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u653E\u5927",children:"\u2795"}),(0,t.jsx)("button",{onClick:$e,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"20px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u7F29\u5C0F",children:"\u2796"}),(0,t.jsx)("button",{onClick:ce,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"16px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u91CD\u7F6E\u7F29\u653E (100%)",children:"1:1"}),(0,t.jsx)("button",{onClick:Xe,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"20px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u7F29\u653E\u5230\u5408\u9002\u5927\u5C0F",children:"\u{1F50D}"}),(0,t.jsx)("button",{onClick:Ne,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"20px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u5C45\u4E2D\u663E\u793A",children:"\u{1F3AF}"})]}),m&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"600px",maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",padding:"20px",position:"relative"},children:[(0,t.jsx)("button",{onClick:function(){return E(!1)},style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"\xD7"}),s?(0,t.jsx)(ht,{dockerFactory:s,onClose:function(){return E(!1)}}):(0,t.jsx)("div",{style:{color:"#666",textAlign:"center",padding:"50px"},children:"\u6B63\u5728\u521D\u59CB\u5316..."})]})}),R&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"800px",maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",padding:"20px",position:"relative"},children:[(0,t.jsx)("button",{onClick:function(){return F(!1)},style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"\xD7"}),(0,t.jsx)("h2",{style:{margin:"0 0 20px 0",color:"#333"},children:"\u{1F4C1} \u5BFC\u51FA Docker Compose"}),(0,t.jsxs)("div",{style:{marginBottom:"20px",display:"flex",gap:"10px"},children:[(0,t.jsx)("button",{onClick:function(){navigator.clipboard.writeText(C),console.log("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")},style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\u{1F4CB} \u590D\u5236\u5230\u526A\u8D34\u677F"}),(0,t.jsx)("button",{onClick:function(){var u=new Blob([C],{type:"text/yaml"}),N=URL.createObjectURL(u),k=document.createElement("a");k.href=N,k.download="docker-compose.yml",k.click(),URL.revokeObjectURL(N)},style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\u{1F4BE} \u4E0B\u8F7D\u6587\u4EF6"})]}),(0,t.jsx)("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:"4px",padding:"15px",fontFamily:'Monaco, Consolas, "Courier New", monospace',fontSize:"14px",lineHeight:"1.5",whiteSpace:"pre-wrap",wordBreak:"break-all",maxHeight:"500px",overflow:"auto",color:"#333"},children:C})]})}),V&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"800px",maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",padding:"20px",position:"relative"},children:[(0,t.jsx)("button",{onClick:function(){U(!1),A("")},style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"\xD7"}),(0,t.jsx)("h2",{style:{margin:"0 0 20px 0",color:"#333"},children:"\u{1F4E4} \u5BFC\u5165 Docker Compose"}),(0,t.jsx)("p",{style:{color:"#666",marginBottom:"15px"},children:"\u8BF7\u7C98\u8D34\u60A8\u7684 docker-compose.yml \u5185\u5BB9\u5230\u4E0B\u65B9\u6587\u672C\u6846\u4E2D\uFF0C\u7136\u540E\u70B9\u51FB\u5BFC\u5165\u6309\u94AE\u3002"}),(0,t.jsxs)("div",{style:{marginBottom:"15px",display:"flex",gap:"10px",alignItems:"center"},children:[(0,t.jsx)("button",{onClick:function(){var u=`version: "3.8"
services:
  redis-master:
    image: redis:7-alpine
    command: redis-server --port 6379
    ports:
      - "6379:6379"
    volumes:
      - redis-master-data:/data
    networks:
      redis-cluster:
        ipv4_address: 172.20.0.10
    restart: unless-stopped

  redis-slave-1:
    image: redis:7-alpine
    command: redis-server --port 6380 --replicaof redis-master 6379
    ports:
      - "6380:6380"
    volumes:
      - redis-slave1-data:/data
    networks:
      redis-cluster:
        ipv4_address: 172.20.0.11
    depends_on:
      - redis-master
    restart: unless-stopped

  redis-slave-2:
    image: redis:7-alpine
    command: redis-server --port 6381 --replicaof redis-master 6379
    ports:
      - "6381:6381"
    volumes:
      - redis-slave2-data:/data
    networks:
      redis-cluster:
        ipv4_address: 172.20.0.12
    depends_on:
      - redis-master
    restart: unless-stopped

networks:
  redis-cluster:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/16
          gateway: 172.20.0.1

volumes:
  redis-master-data:
  redis-slave1-data:
  redis-slave2-data:`;A(u)},style:{padding:"6px 12px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\u{1F4DD} \u4F7F\u7528 Redis \u96C6\u7FA4\u793A\u4F8B"}),(0,t.jsx)("span",{style:{fontSize:"12px",color:"#999"},children:"\u70B9\u51FB\u540E\u4F1A\u586B\u5165\u4E00\u4E2A\u5B8C\u6574\u7684 Redis \u4E3B\u4ECE\u914D\u7F6E\u793A\u4F8B"})]}),(0,t.jsx)("textarea",{value:p,onChange:function(u){return A(u.target.value)},placeholder:"\u8BF7\u5728\u6B64\u5904\u7C98\u8D34 docker-compose.yml \u5185\u5BB9...",style:{width:"100%",height:"400px",padding:"15px",border:"1px solid #e9ecef",borderRadius:"4px",fontFamily:'Monaco, Consolas, "Courier New", monospace',fontSize:"14px",lineHeight:"1.5",resize:"vertical",outline:"none",marginBottom:"20px"}}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,t.jsx)("button",{onClick:function(){U(!1),A("")},style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\u53D6\u6D88"}),(0,t.jsx)("button",{onClick:Ve,disabled:!p.trim(),style:{padding:"8px 16px",backgroundColor:p.trim()?"#17a2b8":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:p.trim()?"pointer":"not-allowed"},children:"\u{1F680} \u5BFC\u5165"})]}),(0,t.jsxs)("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"4px",fontSize:"12px",color:"#666"},children:[(0,t.jsx)("strong",{children:"\u2728 \u667A\u80FD\u5BFC\u5165\u529F\u80FD\uFF1A"}),(0,t.jsxs)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u670D\u52A1\u67B6\u6784\uFF1A"})," \u81EA\u52A8\u521B\u5EFA\u5BB9\u5668\u8282\u70B9\uFF0C\u6E05\u6670\u5C55\u793A\u670D\u52A1\u540D\u3001\u955C\u50CF\u3001\u547D\u4EE4"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u7AEF\u53E3\u6620\u5C04\uFF1A"})," \u53EF\u89C6\u5316\u663E\u793A\u7AEF\u53E3\u914D\u7F6E\uFF0C\u652F\u6301\u591A\u7AEF\u53E3"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u5377\u6302\u8F7D\uFF1A"})," \u76F4\u89C2\u5C55\u793A\u6570\u636E\u5377\u6302\u8F7D\u5173\u7CFB"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u7F51\u7EDC\u62D3\u6251\uFF1A"})," \u81EA\u52A8\u521B\u5EFA\u4EA4\u6362\u673A\uFF0C\u5C55\u793A\u7F51\u7EDC\u8FDE\u63A5\u7ED3\u6784"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u667A\u80FD\u5E03\u5C40\uFF1A"})," \u81EA\u52A8\u6392\u5217\u5BB9\u5668\uFF0C\u907F\u514D\u91CD\u53E0\uFF0C\u652F\u6301\u4F9D\u8D56\u5173\u7CFB"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u914D\u7F6E\u5B8C\u6574\uFF1A"})," \u5305\u542B\u73AF\u5883\u53D8\u91CF\u3001\u91CD\u542F\u7B56\u7565\u3001\u542F\u52A8\u547D\u4EE4\u7B49"]})]}),(0,t.jsxs)("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#e8f5e8",borderRadius:"3px"},children:["\u{1F4A1} ",(0,t.jsx)("strong",{children:"\u63D0\u793A\uFF1A"})," \u5BFC\u5165\u540E\u53EF\u5728\u753B\u5E03\u4E0A\u624B\u52A8\u8C03\u6574\u5E03\u5C40\uFF0C\u8FDE\u63A5\u7F51\u7EDC\u63A5\u53E3\u5230\u4EA4\u6362\u673A"]})]})]})}),Le&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"500px",maxWidth:"90vw",padding:"20px",position:"relative"},children:[(0,t.jsx)("button",{onClick:function(){return ze(!1)},style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"\xD7"}),(0,t.jsx)("h2",{style:{margin:"0 0 20px 0",color:"#333"},children:"\u{1F310} \u6DFB\u52A0\u7F51\u7EDC\u63A5\u53E3"}),(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u63A5\u53E3\u540D\u79F0\uFF1A"}),(0,t.jsx)("input",{type:"text",value:b.interfaceName,onChange:function(u){return xe(function(N){return c()(c()({},N),{},{interfaceName:u.target.value})})},placeholder:"\u4F8B\u5982: eth0, eth1",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})]}),(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u8FDE\u63A5\u5230\u4EA4\u6362\u673A\uFF1A"}),(0,t.jsxs)("select",{value:b.switchName,onChange:function(u){return xe(function(N){return c()(c()({},N),{},{switchName:u.target.value})})},style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"},children:[(0,t.jsx)("option",{value:"",children:"\u8BF7\u9009\u62E9\u4EA4\u6362\u673A"}),(r=x.current)===null||r===void 0?void 0:r.getNodes().filter(function(f){return f.shape==="network-switch"}).map(function(f){var u=f.getData()||{},N=f.attr("text/text"),k=u.switchName||(typeof N=="string"?N.split(`
`)[0]:"switch");return(0,t.jsx)("option",{value:k,children:k},f.id)}),(0,t.jsx)("option",{value:"new-switch",children:"+ \u521B\u5EFA\u65B0\u4EA4\u6362\u673A"})]})]}),b.switchName==="new-switch"&&(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u65B0\u4EA4\u6362\u673A\u540D\u79F0\uFF1A"}),(0,t.jsx)("input",{type:"text",placeholder:"\u4F8B\u5982: switch1, redis-net",onChange:function(u){return xe(function(N){return c()(c()({},N),{},{switchName:u.target.value})})},style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})]}),(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"IP\u914D\u7F6E\uFF1A"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,t.jsx)("input",{type:"radio",name:"ipConfig",value:"dynamic",checked:b.ipConfig==="dynamic",onChange:function(u){return xe(function(N){return c()(c()({},N),{},{ipConfig:u.target.value,staticIP:""})})},style:{marginRight:"5px"}}),"\u52A8\u6001\u5206\u914D (DHCP)"]}),(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,t.jsx)("input",{type:"radio",name:"ipConfig",value:"static",checked:b.ipConfig==="static",onChange:function(u){return xe(function(N){return c()(c()({},N),{},{ipConfig:u.target.value})})},style:{marginRight:"5px"}}),"\u9759\u6001IP"]})]})]}),b.ipConfig==="static"&&(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u9759\u6001IP\u5730\u5740\uFF1A"}),(0,t.jsx)("input",{type:"text",value:b.staticIP,onChange:function(u){return xe(function(N){return c()(c()({},N),{},{staticIP:u.target.value})})},placeholder:"\u4F8B\u5982: 172.20.0.100",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,t.jsx)("button",{onClick:function(){return ze(!1)},style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\u53D6\u6D88"}),(0,t.jsx)("button",{onClick:function(){if(!b.interfaceName.trim()){alert("\u8BF7\u8F93\u5165\u63A5\u53E3\u540D\u79F0");return}if(!b.switchName.trim()){alert("\u8BF7\u9009\u62E9\u6216\u8F93\u5165\u4EA4\u6362\u673A\u540D\u79F0");return}if(b.ipConfig==="static"&&!b.staticIP.trim()){alert("\u8BF7\u8F93\u5165\u9759\u6001IP\u5730\u5740");return}var u=(me==null?void 0:me.getChildren())||[],N=u.filter(function(g){return g.shape==="docker-network"}).map(function(g){var w,B,fe=g.getData()||{};return((w=fe.networkInterface)===null||w===void 0?void 0:w.interfaceName)||((B=g.attr("text/text"))===null||B===void 0?void 0:B.split(`
`)[0])||""});if(N.includes(b.interfaceName)){alert('\u63A5\u53E3\u540D "'.concat(b.interfaceName,'" \u5DF2\u5B58\u5728\uFF0C\u8BF7\u4F7F\u7528\u5176\u4ED6\u540D\u79F0'));return}if(s&&me){var k=s.addNetworkToContainer(me,b.interfaceName,b.switchName),de={interfaceName:b.interfaceName,switchName:b.switchName,ipConfig:b.ipConfig,staticIP:b.ipConfig==="static"?b.staticIP:void 0};k.setData({networkInterface:de,isConnected:!1});var v=b.ipConfig==="static"&&b.staticIP?"".concat(b.interfaceName,`
`).concat(b.staticIP):"".concat(b.interfaceName,`
dynamic`);k.attr("text/text",v),setTimeout(function(){s.manualConnectNetworkToSwitch&&s.manualConnectNetworkToSwitch(k.id,b.switchName)},100),console.log("\u6DFB\u52A0\u7F51\u7EDC\u63A5\u53E3: ".concat(b.interfaceName," -> ").concat(b.switchName))}ze(!1)},disabled:!b.interfaceName.trim()||!b.switchName.trim(),style:{padding:"8px 16px",backgroundColor:!b.interfaceName.trim()||!b.switchName.trim()?"#6c757d":"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:!b.interfaceName.trim()||!b.switchName.trim()?"not-allowed":"pointer"},children:"\u{1F680} \u521B\u5EFA\u7F51\u7EDC\u63A5\u53E3"})]})]})}),ge.visible&&(0,t.jsxs)("div",{style:{position:"fixed",left:ge.x,top:ge.y,backgroundColor:"white",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)",zIndex:1e3,minWidth:"150px"},children:[ge.nodeType==="container"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",borderBottom:"1px solid #f0f0f0"},onClick:function(){return ve("add-port")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F50C} \u6DFB\u52A0\u7AEF\u53E3"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",borderBottom:"1px solid #f0f0f0"},onClick:function(){return ve("add-volume")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F4BE} \u6DFB\u52A0\u5377"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",borderBottom:"1px solid #f0f0f0"},onClick:function(){return ve("add-network")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F310} \u6DFB\u52A0\u7F51\u7EDC"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px"},onClick:function(){return ve("add-user")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F464} \u6DFB\u52A0\u7528\u6237"})]}),ge.nodeType==="component"&&(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",color:"#ff4d4f"},onClick:function(){return ve("delete-component")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#fff2f0"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F5D1}\uFE0F \u5220\u9664\u7EC4\u4EF6"})]})]})},At=St}}]);
