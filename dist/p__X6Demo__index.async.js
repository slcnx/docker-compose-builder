"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[171],{23847:function($t,nt,de){de.r(nt),de.d(nt,{default:function(){return Wt}});var dt=de(26068),c=de.n(dt),ct=de(48305),B=de.n(ct),m=de(75271),ae=de(26114),ft=de(15558),We=de.n(ft),ht=de(31759),Te=de.n(ht),pt=de(25298),gt=de.n(pt),vt=de(17069),mt=de.n(vt),xt=de(82092),Pe=de.n(xt),yt=function(){ae.kJ.registerNode("docker-container",{inherit:"rect",width:700,height:320,attrs:{body:{stroke:"#333",strokeWidth:2,fill:"transparent",strokeDasharray:"5,5",cursor:"move"},text:{fontSize:12,fill:"#333",textAnchor:"start",refX:10,refY:15}},ports:{groups:{top:{position:"top",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-service",{inherit:"rect",width:120,height:50,attrs:{body:{stroke:"#f39c12",strokeWidth:1,fill:"#fff3cd",rx:8,ry:8},text:{fontSize:12,fill:"#333",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#f39c12",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#f39c12",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#f39c12",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#f39c12",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-script",{inherit:"rect",width:140,height:40,attrs:{body:{stroke:"#17a2b8",strokeWidth:1,fill:"#d1ecf1",rx:6,ry:6},text:{fontSize:11,fill:"#333",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-image",{inherit:"rect",width:320,height:40,attrs:{body:{stroke:"#6f42c1",strokeWidth:1,fill:"#e2d9f3",rx:6,ry:6},text:{fontSize:12,fill:"#333",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-volume",{inherit:"ellipse",width:180,height:50,attrs:{body:{stroke:"#20c997",strokeWidth:2,fill:"#d4edda"},text:{fontSize:10,fill:"#333",textWrap:{width:-20,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#20c997",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#20c997",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#20c997",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#20c997",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-user",{inherit:"rect",width:100,height:25,attrs:{body:{stroke:"#fd7e14",strokeWidth:1,fill:"#fff3cd",rx:4},text:{fontSize:10,fill:"#333",fontWeight:"bold",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#fd7e14",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#fd7e14",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#fd7e14",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#fd7e14",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-port",{inherit:"polygon",width:80,height:40,attrs:{body:{refPoints:"0,10 60,0 80,10 60,20 0,10",stroke:"#dc3545",strokeWidth:1,fill:"#f8d7da"},text:{fontSize:12,fill:"#333",fontWeight:"bold"}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#dc3545",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#dc3545",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#dc3545",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#dc3545",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-network",{inherit:"polygon",width:120,height:40,attrs:{body:{refPoints:"0,20 20,0 100,0 120,20 100,40 20,40",stroke:"#6c757d",strokeWidth:1,fill:"#e9ecef"},text:{fontSize:11,fill:"#333",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#6c757d",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#6c757d",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#6c757d",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#6c757d",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-env",{inherit:"rect",width:200,height:80,attrs:{body:{stroke:"#17a2b8",strokeWidth:1,fill:"#d1ecf1",rx:5,ry:5},text:{fontSize:10,fill:"#0c5460",textAnchor:"start",textVerticalAnchor:"top",refX:5,refY:5,textWrap:{width:-10,height:-10,ellipsis:!1}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#17a2b8",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-build",{inherit:"rect",width:200,height:60,attrs:{body:{stroke:"#6f42c1",strokeWidth:1,fill:"#e7d9f5",rx:5,ry:5},text:{fontSize:10,fill:"#4a1d96",textAnchor:"start",textVerticalAnchor:"top",refX:5,refY:5,textWrap:{width:-10,height:-10,ellipsis:!1}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#6f42c1",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("docker-ulimits",{inherit:"rect",width:200,height:80,attrs:{body:{stroke:"#e83e8c",strokeWidth:1,fill:"#f8d7e9",rx:5,ry:5},text:{fontSize:10,fill:"#721c47",textAnchor:"start",textVerticalAnchor:"top",refX:5,refY:5,textWrap:{width:-10,height:-10,ellipsis:!1}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:3,magnet:!0,stroke:"#e83e8c",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#e83e8c",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:3,magnet:!0,stroke:"#e83e8c",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#e83e8c",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("network-switch",{inherit:"rect",width:100,height:60,attrs:{body:{stroke:"#007bff",strokeWidth:2,fill:"#e7f3ff",rx:8,ry:8},text:{fontSize:12,fill:"#007bff",fontWeight:"bold",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#007bff",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#007bff",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#007bff",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#007bff",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"left",id:"port1"},{group:"right",id:"port2"},{group:"top",id:"port3"},{group:"bottom",id:"port4"}]}},!0),ae.kJ.registerNode("network-router",{inherit:"rect",width:120,height:80,attrs:{body:{stroke:"#28a745",strokeWidth:2,fill:"#e8f5e8",rx:10,ry:10},text:{fontSize:12,fill:"#28a745",fontWeight:"bold",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{left:{position:"left",attrs:{circle:{r:5,magnet:!0,stroke:"#28a745",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:5,magnet:!0,stroke:"#28a745",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},top:{position:"top",attrs:{circle:{r:5,magnet:!0,stroke:"#28a745",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"left",id:"lan1"},{group:"right",id:"lan2"},{group:"top",id:"wan"}]}},!0),ae.kJ.registerNode("docker-dns",{inherit:"ellipse",width:100,height:40,attrs:{body:{stroke:"#00c853",strokeWidth:2,fill:"#e8f5e9"},text:{fontSize:11,fill:"#00c853",fontWeight:"bold",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#00c853",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#00c853",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#00c853",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#00c853",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0),ae.kJ.registerNode("external-node",{inherit:"rect",width:150,height:80,attrs:{body:{stroke:"#9e9e9e",strokeWidth:2,fill:"#f5f5f5",rx:5,ry:5,strokeDasharray:"5,5"},text:{fontSize:12,fill:"#424242",fontWeight:"bold",textWrap:{width:-10,height:-10,ellipsis:!0}}},ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#9e9e9e",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#9e9e9e",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#9e9e9e",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#9e9e9e",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}},!0)},kt=function(){function ue(r){gt()(this,ue),Pe()(this,"graph",void 0),Pe()(this,"components",new Map),Pe()(this,"autoLayout",!0),this.graph=r}return mt()(ue,[{key:"addContainer",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o={id:"container-".concat(Date.now()),type:"container",label:e,properties:a},i=this.graph.addNode({shape:"docker-container",label:"",position:this.getNextPosition("container")});return this.components.set(o.id,c()(c()({},o),{},{position:i.getPosition()})),this.autoLayout&&this.performAutoLayout(),{component:o,node:i}}},{key:"addService",value:function(e,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i={id:"service-".concat(Date.now()),type:"container",label:e,properties:o},n=this.graph.addNode({shape:"docker-service",label:e,position:{x:20,y:40}});return this.components.set(i.id,c()(c()({},i),{},{position:n.getPosition()})),{component:i,node:n}}},{key:"addScript",value:function(e,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"command",i={id:"script-".concat(Date.now()),type:o,label:e,properties:{text:e}},n=this.graph.addNode({shape:"docker-script",label:e,position:{x:180,y:40+(o==="entrypoint"?0:50)}});return this.components.set(i.id,c()(c()({},i),{},{position:n.getPosition()})),{component:i,node:n}}},{key:"addImage",value:function(e,a){var o={id:"image-".concat(Date.now()),type:"image",label:e,properties:{imageName:e}},i=this.graph.addNode({shape:"docker-image",label:e,position:{x:20,y:150}});return this.components.set(o.id,c()(c()({},o),{},{position:i.getPosition()})),{component:o,node:i}}},{key:"addVolume",value:function(e,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i={id:"volume-".concat(Date.now()),type:"volume",label:e,properties:{volumeMapping:e}},n=this.graph.addNode({shape:"docker-volume",label:e,position:{x:20+o*200,y:220}});return this.components.set(i.id,c()(c()({},i),{},{position:n.getPosition()})),{component:i,node:n}}},{key:"addPort",value:function(e,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i={id:"port-".concat(Date.now()),type:"port",label:e,properties:{port:e}},n=this.graph.addNode({shape:"docker-port",label:e,position:{x:1e3,y:20+o*50}});return this.components.set(i.id,c()(c()({},i),{},{position:n.getPosition()})),{component:i,node:n}}},{key:"addNetwork",value:function(e,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i={id:"network-".concat(Date.now()),type:"network",label:e,properties:{networkInfo:e}},n=this.graph.addNode({shape:"docker-network",label:e,position:{x:150,y:240+o*50}});return this.components.set(i.id,c()(c()({},i),{},{position:n.getPosition()})),{component:i,node:n}}},{key:"createDockerArchitecture",value:function(e){var a,o=this,i,n,s,f=e.position||this.getNextPosition("container"),v=this.graph.addNode({shape:"docker-container",x:f.x,y:f.y,width:770,height:320,zIndex:1,label:"",data:{config:e},attrs:{label:{refY:15,fontSize:12}}}),d=[],x=this.graph.addNode({shape:"docker-service",x:f.x+20,y:f.y+40,label:e.containerName,zIndex:10});if(d.push(x),e.user){var D=this.graph.addNode({shape:"docker-user",x:f.x+180,y:f.y+40,label:"user: ".concat(e.user),zIndex:10});d.push(D)}if(e.entrypoint){var T=this.graph.addNode({shape:"docker-script",x:f.x+20,y:f.y+100,label:e.entrypoint,zIndex:10,data:{scriptType:"entrypoint"}});d.push(T)}if(e.command){var I=this.graph.addNode({shape:"docker-script",x:f.x+200,y:f.y+100,label:e.command,data:{scriptType:"command"},zIndex:10});d.push(I)}if(e.build){var A="",j={};if(typeof e.build=="string")A="context: ".concat(e.build),j={context:e.build};else{var W=[];e.build.context&&W.push("context: ".concat(e.build.context)),e.build.dockerfile&&W.push("dockerfile: ".concat(e.build.dockerfile)),e.build.args&&(W.push("args:"),Object.entries(e.build.args).forEach(function(b){var l=B()(b,2),y=l[0],g=l[1];W.push("  ".concat(y,": ").concat(g))})),A=W.join(`
`),j=e.build}var P=this.graph.addNode({shape:"docker-build",x:f.x+20,y:f.y+160,label:A,zIndex:10,data:{build:j}});d.push(P)}if(e.image){var U=this.graph.addNode({shape:"docker-image",x:f.x+240,y:f.y+160,label:e.image,zIndex:10});d.push(U)}if((a=e.volumes)===null||a===void 0||a.forEach(function(b,l){var y=o.graph.addNode({shape:"docker-volume",x:f.x+20+l*200,y:f.y+220,label:b,zIndex:10});d.push(y)}),e.environment&&e.environment.length>0){var E=e.environment.join(`
`),F=this.graph.addNode({shape:"docker-env",x:f.x+20,y:f.y+270,label:E,zIndex:10,data:{envList:e.environment}});d.push(F)}if(e.ulimits){var k=[];Object.entries(e.ulimits).forEach(function(b){var l=B()(b,2),y=l[0],g=l[1];k.push("".concat(y,":")),Te()(g)==="object"&&g!==null?(g.soft!==void 0&&k.push("  soft: ".concat(g.soft)),g.hard!==void 0&&k.push("  hard: ".concat(g.hard))):k.push("  ".concat(g))});var h=k.join(`
`),S=this.graph.addNode({shape:"docker-ulimits",x:f.x+240,y:f.y+270,label:h,zIndex:10,data:{ulimits:e.ulimits}});d.push(S)}(i=e.ports)===null||i===void 0||i.forEach(function(b,l){var y=o.graph.addNode({shape:"docker-port",x:f.x+380,y:f.y+40+l*50,label:b,zIndex:10});d.push(y)}),(n=e.networkInterfaces)===null||n===void 0||n.forEach(function(b,l){var y=b.ipConfig==="static"&&b.staticIP?"".concat(b.interfaceName,`
`).concat(b.staticIP):"".concat(b.interfaceName,`
dynamic`),g=o.graph.addNode({shape:"docker-network",x:f.x+580,y:f.y+240+l*55,label:y,zIndex:10});d.push(g),g.setData({networkInterface:b,isConnected:!1}),console.log("\u521B\u5EFA\u7F51\u7EDC\u63A5\u53E3: ".concat(b.interfaceName," -> ").concat(b.switchName),b)}),(s=e.dns)===null||s===void 0||s.forEach(function(b,l){var y=o.graph.addNode({shape:"docker-dns",x:f.x-60,y:f.y+220+l*50,label:`DNS
`.concat(b),zIndex:10,data:{dnsAddress:b,dnsType:"external",needsConnection:!0}});d.push(y),console.log("\u521B\u5EFADNS\u8282\u70B9: ".concat(b))}),d.forEach(function(b){v.addChild(b)});var z={id:"container-".concat(Date.now()),type:"container",label:e.containerName,properties:e,position:v.getPosition()};return this.components.set(z.id,z),{containerNode:v,childNodes:d}}},{key:"getNextPosition",value:function(e){var a=this.graph.getNodes(),o=a.filter(function(i){return i.shape==="docker-container"});return{x:50,y:50+o.length*350}}},{key:"performAutoLayout",value:function(){}},{key:"getComponents",value:function(){return Array.from(this.components.values())}},{key:"clear",value:function(){this.components.clear(),this.graph.clearCells()}},{key:"getContainerCount",value:function(){var e=this.graph.getNodes().filter(function(a){return a.shape==="docker-container"});return e.length}},{key:"getAllContainers",value:function(){var e=this.graph.getNodes().filter(function(a){return a.shape==="docker-container"});return e.map(function(a){return{id:a.id,name:a.attr("text/text")||"container",position:a.getPosition(),children:(a.getChildren()||[]).map(function(o){return{id:o.id,shape:o.shape,label:o.attr("text/text")||""}})}})}},{key:"getDAGRelationships",value:function(){var e=this.getAllContainers(),a=this.graph.getEdges(),o={containers:e,connections:a.map(function(i){var n,s,f,v;return{id:i.id,source:(n=i.getSourceNode())===null||n===void 0?void 0:n.id,target:(s=i.getTargetNode())===null||s===void 0?void 0:s.id,sourceLabel:((f=i.getSourceNode())===null||f===void 0?void 0:f.attr("text/text"))||"",targetLabel:((v=i.getTargetNode())===null||v===void 0?void 0:v.attr("text/text"))||""}}),totalContainers:e.length,totalConnections:a.length};return o}},{key:"getTopologicalOrder",value:function(){var e=this.getAllContainers(),a=this.graph.getEdges(),o={},i={};e.forEach(function(d){o[d.id]=[],i[d.id]=0}),a.forEach(function(d){var x,D,T=(x=d.getSourceNode())===null||x===void 0?void 0:x.id,I=(D=d.getTargetNode())===null||D===void 0?void 0:D.id;T&&I&&(o[T].push(I),i[I]++)});var n=[],s=[];for(Object.keys(i).forEach(function(d){i[d]===0&&n.push(d)});n.length>0;){var f=n.shift();s.push(f),o[f].forEach(function(d){i[d]--,i[d]===0&&n.push(d)})}var v=s.length!==e.length;return{order:s.map(function(d){var x=e.find(function(D){return D.id===d});return{id:d,name:(x==null?void 0:x.name)||"Unknown"}}),hasCircle:v,isValidDAG:!v}}},{key:"createSwitch",value:function(e,a){var o=this.getNextSwitchPosition(),i=e;a&&a.subnet&&(i="".concat(e,`
`).concat(a.subnet));var n=this.graph.addNode({shape:"network-switch",x:o.x,y:o.y,label:i,zIndex:5,data:{switchName:e,networkConfig:a}});return a&&a.gateway&&this.createAndConnectRouter(n,e,a),console.log("\u521B\u5EFA\u4EA4\u6362\u673A: ".concat(e),a),n}},{key:"createAndConnectRouter",value:function(e,a,o){var i="".concat(a,"_router"),n=this.graph.getNodes().filter(function(d){var x=d.attr("text/text");return d.shape==="network-router"&&typeof x=="string"&&x.includes(i)});if(n.length===0){var s=o!=null&&o.gateway?"".concat(i,`
GW: `).concat(o.gateway):i,f=this.createRouter(s),v=e.getPosition();f.setPosition({x:v.x+100,y:v.y}),this.graph.addEdge({source:{cell:e.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:f.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#28a745",strokeWidth:3,strokeDasharray:5,targetMarker:{name:"block",width:8,height:6},style:{animation:"ant-line 30s infinite linear"}}},zIndex:2}),console.log("\u521B\u5EFA\u8DEF\u7531\u5668\u5E76\u8FDE\u63A5: ".concat(i))}}},{key:"createRouter",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Router",a=this.getNextRouterPosition(),o=this.graph.addNode({shape:"network-router",x:a.x,y:a.y,label:e,zIndex:5});return console.log("\u521B\u5EFA\u8DEF\u7531\u5668: ".concat(e)),o}},{key:"getNextSwitchPosition",value:function(){var e=this.graph.getNodes().filter(function(a){return a.shape==="network-switch"});return{x:800+e.length%3*150,y:100+Math.floor(e.length/3)*150}}},{key:"getNextRouterPosition",value:function(){var e=this.graph.getNodes().filter(function(n){return n.shape==="network-router"}),a=this.graph.getNodes().filter(function(n){return n.shape==="network-switch"}),o=800;a.length>0&&(o=Math.max.apply(Math,We()(a.map(function(n){return n.getPosition().x}))));var i=o+200;return{x:i+e.length%2*150,y:100+Math.floor(e.length/2)*150}}},{key:"connectNetworkToSwitch",value:function(e,a){var o=this.graph.getNodes().filter(function(s){return s.shape==="network-switch"&&(s.attr("text/text")||"")===a}),i;o.length>0?(i=o[0],console.log("\u627E\u5230\u73B0\u6709\u4EA4\u6362\u673A: ".concat(a))):(console.log("\u672A\u627E\u5230\u4EA4\u6362\u673A ".concat(a,"\uFF0C\u81EA\u52A8\u521B\u5EFA")),i=this.createSwitch(a));var n=this.graph.addEdge({source:{cell:e.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:i.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#6c757d",strokeWidth:2,strokeDasharray:"2,2",style:{animation:"ant-line 30s infinite linear"}}},data:{originalStroke:"#6c757d",originalWidth:2},labels:[{attrs:{text:{text:"\u7F51\u7EDC\u8FDE\u63A5",fontSize:10,fill:"#666"}}}]});return console.log("\u8FDE\u63A5\u7F51\u5361 ".concat(e.attr("text/text")||"network"," \u5230\u4EA4\u6362\u673A ").concat(a)),{edge:n,switchNode:i}}},{key:"connectSwitchToRouter",value:function(e){var a=this.graph.getNodes().filter(function(s){return s.shape==="network-router"});a.length===0&&(a=[this.createRouter("Default Router")]);var o=a[0],i=this.graph.getEdges().filter(function(s){var f,v;return((f=s.getSourceNode())===null||f===void 0?void 0:f.id)===e.id&&((v=s.getTargetNode())===null||v===void 0?void 0:v.id)===o.id});if(i.length>0)return console.log("\u4EA4\u6362\u673A ".concat(e.attr("text/text")||"switch"," \u5DF2\u7ECF\u8FDE\u63A5\u5230\u8DEF\u7531\u5668\uFF0C\u8DF3\u8FC7")),i[0];var n=this.graph.addEdge({source:{cell:e.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:o.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#28a745",strokeWidth:3,strokeDasharray:5,targetMarker:{name:"block",width:8,height:6},style:{animation:"ant-line 30s infinite linear"}}},data:{originalStroke:"#28a745",originalWidth:3},labels:[{attrs:{text:{text:"Bridge",fontSize:10,fill:"#28a745"}}}]});return console.log("\u8FDE\u63A5\u4EA4\u6362\u673A ".concat(e.attr("text/text")||"switch"," \u5230\u8DEF\u7531\u5668")),n}},{key:"manualConnectNetworkToSwitch",value:function(e,a,o){var i=this,n=this.graph.getCellById(e);if(!n||n.shape!=="docker-network")return console.error("\u65E0\u6548\u7684\u7F51\u5361\u8282\u70B9"),!1;var s=this.graph.getConnectedEdges(n).filter(function(I){var A=I.getTargetNode();return A&&A.shape==="network-switch"});if(s.length>0)return console.log("\u7F51\u5361\u5DF2\u7ECF\u8FDE\u63A5\u5230\u4EA4\u6362\u673A\uFF0C\u8BF7\u5148\u65AD\u5F00\u8FDE\u63A5"),!1;var f=this.graph.getNodes().filter(function(I){return I.shape==="network-switch"&&(I.attr("text/text")||"")===a}),v;f.length>0?v=f[0]:v=this.createSwitch(a);var d=this.connectNetworkToSwitch(n,a),x=n.getData()||{},D=x.networkInterface||{};if(D.ipConfig==="static"&&D.staticIP){var T="".concat(D.interfaceName,`
`).concat(D.staticIP);n.attr("text/text",T)}return n.setData(c()(c()({},x),{},{isConnected:!0,connectedSwitch:a,switchNetworkConfig:o,networkInterface:c()(c()({},D),{},{switchName:a})})),d&&d.switchNode&&setTimeout(function(){i.connectSwitchToRouter(d.switchNode)},50),console.log("\u624B\u52A8\u8FDE\u63A5\u7F51\u5361 ".concat(n.attr("text/text")||"network"," \u5230\u4EA4\u6362\u673A ").concat(a)),!0}},{key:"disconnectNetworkFromSwitch",value:function(e){var a=this,o=this.graph.getCellById(e);if(!o||o.shape!=="docker-network")return console.error("\u65E0\u6548\u7684\u7F51\u5361\u8282\u70B9"),!1;var i=this.graph.getConnectedEdges(o).filter(function(n){var s=n.getTargetNode();return s&&s.shape==="network-switch"});return i.length===0?(console.log("\u7F51\u5361\u672A\u8FDE\u63A5\u5230\u4EFB\u4F55\u4EA4\u6362\u673A"),!1):(i.forEach(function(n){a.graph.removeCell(n)}),o.setData(c()(c()({},o.getData()),{},{isConnected:!1,connectedSwitch:void 0})),console.log("\u65AD\u5F00\u7F51\u5361 ".concat(o.attr("text/text")||"network"," \u7684\u8FDE\u63A5")),!0)}},{key:"getNetworkNodes",value:function(){return this.graph.getNodes().filter(function(e){return e.shape==="docker-network"})}},{key:"getSwitchNodes",value:function(){return this.graph.getNodes().filter(function(e){return e.shape==="network-switch"})}},{key:"isNetworkConnected",value:function(e){var a=this.graph.getCellById(e);if(!a)return!1;var o=this.graph.getConnectedEdges(a).filter(function(i){var n=i.getTargetNode();return n&&n.shape==="network-switch"});return o.length>0}},{key:"getConnectedSwitch",value:function(e){var a=this.graph.getCellById(e);if(!a)return null;var o=this.graph.getConnectedEdges(a).filter(function(n){var s=n.getTargetNode();return s&&s.shape==="network-switch"});if(o.length>0){var i=o[0].getTargetNode();return i&&i.attr("text/text")||null}return null}},{key:"addPortToContainer",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"8080",o=e.getChildren()||[],i=o.filter(function(v){return v.shape==="docker-port"}),n=e.getPosition(),s=70+i.length*30,f=this.graph.addNode({shape:"docker-port",x:n.x+500,y:n.y+s,label:a,zIndex:10});return e.addChild(f),console.log("\u6DFB\u52A0\u7AEF\u53E3: ".concat(a)),f}},{key:"addVolumeToContainer",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"/data:/app/data",o=e.getChildren()||[],i=o.filter(function(v){return v.shape==="docker-volume"}),n=e.getPosition(),s=180+i.length*30,f=this.graph.addNode({shape:"docker-volume",x:n.x+350,y:n.y+s,label:a,zIndex:10});return e.addChild(f),console.log("\u6DFB\u52A0\u5377: ".concat(a)),f}},{key:"addNetworkToContainer",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"eth0",o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"default",i=e.getChildren()||[],n=i.filter(function(x){return x.shape==="docker-network"}),s=e.getPosition(),f=e.getSize().height||320,v=f-80+n.length*55,d=this.graph.addNode({shape:"docker-network",x:s.x+580,y:s.y+v,label:a,zIndex:10,data:{networkInterface:{interfaceName:a,switchName:o,ipConfig:"dynamic"}}});return e.addChild(d),console.log("\u6DFB\u52A0\u7F51\u7EDC\u63A5\u53E3: ".concat(a," -> ").concat(o)),d}},{key:"addDNSToContainer",value:function(e){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"8.8.8.8",i=e.getChildren()||[],n=i.filter(function(x){return x.shape==="docker-dns"}),s=e.getPosition(),f=-120,v=220+n.length*50,d=this.graph.addNode({shape:"docker-dns",x:s.x+f,y:s.y+v,label:`DNS
`.concat(o),zIndex:10,data:{dnsAddress:o,dnsType:"external"}});return e.addChild(d),setTimeout(function(){a.connectDNS(d,o)},100),console.log("\u6DFB\u52A0DNS\u914D\u7F6E: ".concat(o)),d}},{key:"removeChildComponent",value:function(e){var a=this,o=e.getParent();if(o){var i=o.getData()||{},n=i.config||{},s=e.shape,f=e.attr("text/text");switch(s){case"docker-user":o.setData(c()(c()({},i),{},{config:c()(c()({},n),{},{user:void 0})})),console.log("\u6E05\u7A7A\u5BB9\u5668 ".concat(o.attr("text/text")," \u7684\u7528\u6237\u914D\u7F6E"));break;case"docker-image":o.setData(c()(c()({},i),{},{config:c()(c()({},n),{},{image:"nginx:latest"})})),console.log("\u6E05\u7A7A\u5BB9\u5668 ".concat(o.attr("text/text")," \u7684\u955C\u50CF\u914D\u7F6E"));break;case"docker-port":var v=(n.ports||[]).filter(function(E){return E!==f});o.setData(c()(c()({},i),{},{config:c()(c()({},n),{},{ports:v})})),console.log("\u4ECE\u5BB9\u5668 ".concat(o.attr("text/text")," \u79FB\u9664\u7AEF\u53E3 ").concat(f));break;case"docker-volume":var d=(n.volumes||[]).filter(function(E){return E!==f});o.setData(c()(c()({},i),{},{config:c()(c()({},n),{},{volumes:d})})),console.log("\u4ECE\u5BB9\u5668 ".concat(o.attr("text/text")," \u79FB\u9664\u5377 ").concat(f));break;case"docker-script":var x=e.getData(),D=x==null?void 0:x.scriptType;D==="entrypoint"?(o.setData(c()(c()({},i),{},{config:c()(c()({},n),{},{entrypoint:""})})),console.log("\u6E05\u7A7A\u5BB9\u5668 ".concat(o.attr("text/text")," \u7684 entrypoint"))):(D==="command"||!D)&&(o.setData(c()(c()({},i),{},{config:c()(c()({},n),{},{command:"tail -f /etc/hosts"})})),console.log("\u6E05\u7A7A\u5BB9\u5668 ".concat(o.attr("text/text")," \u7684 command")));break;case"docker-network":var T=e.getData(),I=T==null?void 0:T.networkInterface;if(I){var A=(n.networkInterfaces||[]).filter(function(E){return E.interfaceName!==I.interfaceName});o.setData(c()(c()({},i),{},{config:c()(c()({},n),{},{networkInterfaces:A})})),console.log("\u4ECE\u5BB9\u5668 ".concat(o.attr("text/text")," \u79FB\u9664\u7F51\u7EDC\u63A5\u53E3 ").concat(I.interfaceName))}break;case"docker-dns":var j=e.getData(),W=j==null?void 0:j.dnsAddress;if(W){var P=(n.dns||[]).filter(function(E){return E!==W});o.setData(c()(c()({},i),{},{config:c()(c()({},n),{},{dns:P})})),console.log("\u4ECE\u5BB9\u5668 ".concat(o.attr("text/text")," \u79FB\u9664DNS ").concat(W))}break}o.removeChild(e)}var U=this.graph.getConnectedEdges(e);U.forEach(function(E){return a.graph.removeEdge(E)}),this.graph.removeNode(e),console.log("\u5220\u9664\u7EC4\u4EF6: ".concat(e.shape))}},{key:"hasUniqueComponent",value:function(e,a){var o=e.getChildren()||[];return o.some(function(i){return i.shape===a})}},{key:"getContainerComponentStats",value:function(e){var a=e.getChildren()||[],o={service:a.filter(function(i){return i.shape==="docker-service"}).length,image:a.filter(function(i){return i.shape==="docker-image"}).length,user:a.filter(function(i){return i.shape==="docker-user"}).length,script:a.filter(function(i){return i.shape==="docker-script"}).length,port:a.filter(function(i){return i.shape==="docker-port"}).length,volume:a.filter(function(i){return i.shape==="docker-volume"}).length,network:a.filter(function(i){return i.shape==="docker-network"}).length};return o}},{key:"determineDNSType",value:function(e){var a=/^(\d{1,3}\.){3}\d{1,3}$/.test(e);if(a){var o=["8.8.8.8","8.8.4.4","1.1.1.1","1.0.0.1","114.114.114.114"];return o.includes(e)?"external":e.endsWith(".1")?"gateway":"container"}return"container"}},{key:"getOrCreateExternalNode",value:function(e){var a=this.graph.getNodes().find(function(n){return n.shape==="external-node"&&n.attr("text/text")===`\u5916\u90E8DNS
`.concat(e)});if(a)return a;var o=this.graph.getNodes().filter(function(n){return n.shape==="external-node"}),i=this.graph.addNode({shape:"external-node",x:1200+o.length%3*160,y:50+Math.floor(o.length/3)*100,label:`\u5916\u90E8DNS
`.concat(e),zIndex:5,data:{type:"external-dns",address:e}});return console.log("\u521B\u5EFA\u5916\u90E8DNS\u8282\u70B9: ".concat(e)),i}},{key:"connectDNS",value:function(e,a){var o=e.getData()||{},i=o.dnsAddress||a,n=this.determineDNSType(i),s=null;switch(n){case"external":s=this.getOrCreateExternalNode(i);break;case"gateway":var f=this.graph.getNodes().filter(function(A){return A.shape==="network-router"});f.length>0?s=f[0]:s=this.createRouter(`Gateway
`+i);break;case"container":var v=/^(\d{1,3}\.){3}\d{1,3}$/.test(i);if(v){var d=this.graph.getNodes().filter(function(A){return A.shape==="docker-network"}),x=d.find(function(A){var j=A.attr("text/text");return typeof j=="string"&&j.includes(i)});x&&(s=x.getParent())}else{var D=this.graph.getNodes().filter(function(A){return A.shape==="docker-container"}),T=D.find(function(A){var j=A.getChildren()||[],W=j.find(function(U){return U.shape==="docker-service"});if(W){var P=W.attr("text/text");return P===i}return!1});T&&(s=T)}s||(s=this.getOrCreateExternalNode(i));break}if(!s)return console.warn("\u672A\u627E\u5230DNS\u76EE\u6807: ".concat(i)),null;var I=this.graph.addEdge({source:{cell:e.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:s.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,step:10}},attrs:{line:{stroke:"#00c853",strokeWidth:2,strokeDasharray:"5,5",targetMarker:{name:"block",width:8,height:6},style:{animation:"ant-line 30s infinite linear"}}},data:{originalStroke:"#00c853",originalWidth:2,connectionType:"dns"},labels:[{attrs:{text:{text:"DNS",fontSize:10,fill:"#00c853"}}}],zIndex:2});return e.setData(c()(c()({},o),{},{dnsType:n,isConnected:!0,targetAddress:i})),console.log("DNS\u8FDE\u63A5: ".concat(i," (\u7C7B\u578B: ").concat(n,")")),{edge:I,targetNode:s,dnsType:n}}}]),ue}(),t=de(52676),bt=function(r){var e=r.dockerFactory,a=r.onClose,o=(0,m.useState)("n1"),i=B()(o,2),n=i[0],s=i[1],f=(0,m.useState)("nginx:latest"),v=B()(f,2),d=v[0],x=v[1],D=(0,m.useState)(""),T=B()(D,2),I=T[0],A=T[1],j=(0,m.useState)("tail -f /etc/hosts"),W=B()(j,2),P=W[0],U=W[1],E=(0,m.useState)("80"),F=B()(E,2),k=F[0],h=F[1],S=(0,m.useState)(""),z=B()(S,2),b=z[0],l=z[1],y=(0,m.useState)("always"),g=B()(y,2),N=g[0],Y=g[1],_=(0,m.useState)([]),Q=B()(_,2),G=Q[0],X=Q[1],q=(0,m.useState)("nginx-tomcat"),re=B()(q,2),ee=re[0],he=re[1],ne=(0,m.useState)("172.20.0.0/16"),V=B()(ne,2),K=V[0],J=V[1],$=(0,m.useState)("172.20.0.1"),oe=B()($,2),fe=oe[0],se=oe[1],ve=(0,m.useState)(["switch1","switch2"]),ye=B()(ve,2),le=ye[0],me=ye[1],ge=(0,m.useState)([]),M=B()(ge,2),te=M[0],ce=M[1],be=(0,m.useState)({switch1:{subnet:"172.18.0.0/16",gateway:"172.18.0.1"},switch2:{subnet:"172.19.0.0/16",gateway:"172.19.0.1"}}),Le=B()(be,2),pe=Le[0],_e=Le[1],De=function(){if(e){var C=e.graph.getNodes().filter(function(Z){return Z.shape==="network-switch"}).map(function(Z){return Z.attr("text/text")||"switch"}),R=We()(new Set([].concat(We()(le),We()(C))));me(R)}},xe=function(){if(e){var C=e.getNetworkNodes(),R=C.map(function(Z){return{id:Z.id,label:Z.attr("text/text")||"network",isConnected:e.isNetworkConnected(Z.id),connectedSwitch:e.getConnectedSwitch(Z.id)}});ce(R)}},O=function(C,R){if(e){var Z=pe[R],Fe=e.manualConnectNetworkToSwitch(C,R,Z);Fe&&(xe(),De())}},Se=function(C){if(e){var R=e.disconnectNetworkFromSwitch(C);R&&xe()}};m.useEffect(function(){e&&(De(),xe())},[e]);var Ce=function(){if(e){var C={containerName:n||"my-container",image:d||"docker.io/library/nginx:latest",entrypoint:I.trim()||void 0,command:P.trim()||"tail -f /etc/hosts",restart:N,ports:k.split(",").map(function(R){return R.trim()}).filter(Boolean),volumes:b.split(",").map(function(R){return R.trim()}).filter(Boolean),networkInterfaces:G,switchNetworks:pe};e.createDockerArchitecture(C),setTimeout(function(){xe()},200),a==null||a()}},Qe=function(){if(!(!e||!ee.trim())){var C=ee.trim();if(le.includes(C)){alert("\u4EA4\u6362\u673A\u5DF2\u5B58\u5728\uFF01");return}if(!K.trim()||!fe.trim()){alert("\u8BF7\u586B\u5199\u5B8C\u6574\u7684\u7F51\u7EDC\u914D\u7F6E\uFF01");return}e.createSwitch(C),_e(function(Fe){return c()(c()({},Fe),{},Pe()({},C,{subnet:K.trim(),gateway:fe.trim()}))}),setTimeout(function(){De()},100),he("");var R=parseInt(K.split(".")[2]),Z=R+1;J("172.".concat(Z,".0.0/16")),se("172.".concat(Z,".0.1"))}},qe=function(){var C={interfaceName:"eth".concat(G.length),switchName:le[0]||"",ipConfig:"dynamic",staticIP:void 0};X(function(R){return[].concat(We()(R),[C])})},Ue=function(C){X(function(R){return R.filter(function(Z,Fe){return Fe!==C})})},ze=function(C,R,Z){X(function(Fe){return Fe.map(function(Ke,tt){if(tt===C){var Be=c()(c()({},Ke),{},Pe()({},R,Z));if(R==="ipConfig"&&Z==="static"&&!Be.staticIP){var Ze=pe[Be.switchName];if(Ze){var p=Ze.gateway.split(".");p[3]=String(100+C),Be.staticIP=p.join(".")}}return R==="ipConfig"&&Z==="dynamic"&&(Be.staticIP=void 0),Be}return Ke})})},it=function(){e&&(e.clear(),me(["switch1","switch2"]),ce([]))},at=function(){if(e){le.includes("switch1")||e.createSwitch("switch1"),le.includes("switch2")||e.createSwitch("switch2"),setTimeout(function(){De()},100);var C={containerName:"nginx-container",image:"docker.io/library/nginx:latest",entrypoint:"/docker-entrypoint",command:"nginx -g daemon off",ports:["8080","9090","9091"],volumes:["/data/container1/app:/app/data","/data/container1/app2:/app/data2"],networkInterfaces:[{interfaceName:"eth0",switchName:"switch1",ipConfig:"static",staticIP:"172.16.0.100"},{interfaceName:"eth1",switchName:"switch2",ipConfig:"dynamic"}]};e.createDockerArchitecture(C),setTimeout(function(){xe()},200),a==null||a()}},ke={width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",marginBottom:"8px"},Xe=c()(c()({},ke),{},{minHeight:"60px",resize:"vertical",fontFamily:"monospace"}),Ae={padding:"10px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginRight:"8px",marginBottom:"8px"},et=c()(c()({},Ae),{},{backgroundColor:"#dc3545"}),Ee={display:"block",marginBottom:"4px",fontSize:"13px",fontWeight:500,color:"#333"},Oe={marginBottom:"16px",padding:"12px",backgroundColor:"#fff",borderRadius:"6px",border:"1px solid #e9ecef"};return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{marginBottom:"16px",fontWeight:600,color:"#333",fontSize:"16px"},children:"\u{1F433} Docker \u914D\u7F6E\u9762\u677F"}),(0,t.jsxs)("div",{style:Oe,children:[(0,t.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#495057",fontSize:"14px"},children:"\u57FA\u7840\u914D\u7F6E"}),(0,t.jsx)("label",{style:Ee,children:"\u5BB9\u5668\u540D\u79F0"}),(0,t.jsx)("input",{type:"text",value:n,onChange:function(C){return s(C.target.value)},placeholder:"\u5BB9\u5668\u540D\u79F0",style:ke}),(0,t.jsx)("label",{style:Ee,children:"\u955C\u50CF"}),(0,t.jsx)("input",{type:"text",value:d,onChange:function(C){return x(C.target.value)},placeholder:"docker.io/library/nginx:latest",style:ke})]}),(0,t.jsxs)("div",{style:Oe,children:[(0,t.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#495057",fontSize:"14px"},children:"\u542F\u52A8\u914D\u7F6E"}),(0,t.jsx)("label",{style:Ee,children:"\u5165\u53E3\u70B9\u811A\u672C"}),(0,t.jsx)("input",{type:"text",value:I,onChange:function(C){return A(C.target.value)},placeholder:"/docker-entrypoint",style:ke}),(0,t.jsx)("label",{style:Ee,children:"\u542F\u52A8\u547D\u4EE4"}),(0,t.jsx)("input",{type:"text",value:P,onChange:function(C){return U(C.target.value)},placeholder:"tail -f /etc/hosts",style:ke}),(0,t.jsx)("label",{style:Ee,children:"\u91CD\u542F\u7B56\u7565"}),(0,t.jsxs)("select",{value:N,onChange:function(C){return Y(C.target.value)},style:ke,children:[(0,t.jsx)("option",{value:"no",children:"no - \u4E0D\u81EA\u52A8\u91CD\u542F"}),(0,t.jsx)("option",{value:"always",children:"always - \u603B\u662F\u91CD\u542F"}),(0,t.jsx)("option",{value:"unless-stopped",children:"unless-stopped - \u9664\u975E\u624B\u52A8\u505C\u6B62"}),(0,t.jsx)("option",{value:"on-failure",children:"on-failure - \u4EC5\u6545\u969C\u65F6\u91CD\u542F"})]})]}),(0,t.jsxs)("div",{style:Oe,children:[(0,t.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#495057",fontSize:"14px"},children:"\u7F51\u7EDC\u4E0E\u5B58\u50A8"}),(0,t.jsx)("label",{style:Ee,children:"\u7AEF\u53E3\u6620\u5C04 (\u9017\u53F7\u5206\u9694)"}),(0,t.jsx)("textarea",{value:k,onChange:function(C){return h(C.target.value)},placeholder:"8080,9090,9091",style:Xe}),(0,t.jsx)("label",{style:Ee,children:"\u5377\u6620\u5C04 (\u9017\u53F7\u5206\u9694)"}),(0,t.jsx)("textarea",{value:b,onChange:function(C){return l(C.target.value)},placeholder:"/host/path:/container/path",style:Xe}),(0,t.jsx)("label",{style:Ee,children:"\u4EA4\u6362\u673A\u7BA1\u7406"}),(0,t.jsxs)("div",{style:{marginBottom:"12px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f8f9fa"},children:[(0,t.jsx)("div",{style:{marginBottom:"6px",fontSize:"12px",fontWeight:"bold"},children:"\u521B\u5EFA\u65B0\u4EA4\u6362\u673A"}),(0,t.jsx)("div",{style:{marginBottom:"6px"},children:(0,t.jsx)("input",{type:"text",value:ee,onChange:function(C){return he(C.target.value)},placeholder:"\u4EA4\u6362\u673A\u540D\u79F0",style:c()(c()({},ke),{},{marginBottom:"0",fontSize:"12px"})})}),(0,t.jsxs)("div",{style:{display:"flex",gap:"4px",marginBottom:"6px"},children:[(0,t.jsx)("input",{type:"text",value:K,onChange:function(C){return J(C.target.value)},placeholder:"\u7F51\u7EDC\u5B50\u7F51 (\u5982: 172.20.0.0/16)",style:c()(c()({},ke),{},{marginBottom:"0",fontSize:"12px",flex:2})}),(0,t.jsx)("input",{type:"text",value:fe,onChange:function(C){return se(C.target.value)},placeholder:"\u7F51\u5173 (\u5982: 172.20.0.1)",style:c()(c()({},ke),{},{marginBottom:"0",fontSize:"12px",flex:1})})]}),(0,t.jsx)("button",{onClick:Qe,style:{width:"100%",padding:"6px 12px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\u2795 \u521B\u5EFA\u4EA4\u6362\u673A"})]}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:"12px",color:"#666"},children:"\u7F51\u7EDC\u63A5\u53E3\u914D\u7F6E\uFF1A"}),(0,t.jsx)("button",{onClick:qe,style:{padding:"4px 8px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"11px"},children:"\u2795 \u6DFB\u52A0\u63A5\u53E3"})]}),(0,t.jsx)("div",{style:{border:"1px solid #ddd",borderRadius:"4px",padding:"8px",maxHeight:"200px",overflowY:"auto"},children:G.length===0?(0,t.jsx)("div",{style:{color:"#999",fontSize:"12px",textAlign:"center",padding:"16px"},children:'\u6682\u65E0\u7F51\u7EDC\u63A5\u53E3\uFF0C\u70B9\u51FB"\u6DFB\u52A0\u63A5\u53E3"\u521B\u5EFA'}):G.map(function(w,C){return(0,t.jsxs)("div",{style:{border:"1px solid #e9ecef",borderRadius:"3px",padding:"8px",marginBottom:"8px",backgroundColor:"#f8f9fa"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,t.jsxs)("span",{style:{fontSize:"12px",fontWeight:"bold"},children:["\u63A5\u53E3 ",C+1]}),(0,t.jsx)("button",{onClick:function(){return Ue(C)},style:{padding:"2px 6px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"10px"},children:"\u5220\u9664"})]}),(0,t.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,t.jsx)("label",{style:{fontSize:"11px",color:"#666"},children:"\u63A5\u53E3\u540D\u79F0\uFF1A"}),(0,t.jsx)("input",{type:"text",value:w.interfaceName,onChange:function(Z){return ze(C,"interfaceName",Z.target.value)},style:{width:"100%",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"11px"}})]}),(0,t.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,t.jsx)("label",{style:{fontSize:"11px",color:"#666"},children:"\u8FDE\u63A5\u4EA4\u6362\u673A\uFF1A"}),(0,t.jsx)("select",{value:w.switchName,onChange:function(Z){return ze(C,"switchName",Z.target.value)},style:{width:"100%",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"11px"},children:le.map(function(R){return(0,t.jsx)("option",{value:R,children:R},R)})})]}),pe[w.switchName]&&(0,t.jsxs)("div",{style:{padding:"4px",backgroundColor:"#e7f3ff",borderRadius:"2px",marginBottom:"4px",fontSize:"10px",color:"#0066cc"},children:["\u{1F4E1} \u7F51\u7EDC: ",pe[w.switchName].subnet,(0,t.jsx)("br",{}),"\u{1F3E0} \u7F51\u5173: ",pe[w.switchName].gateway]}),(0,t.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,t.jsx)("label",{style:{fontSize:"11px",color:"#666"},children:"IP\u914D\u7F6E\uFF1A"}),(0,t.jsxs)("select",{value:w.ipConfig,onChange:function(Z){return ze(C,"ipConfig",Z.target.value)},style:{width:"100%",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"11px"},children:[(0,t.jsx)("option",{value:"dynamic",children:"\u52A8\u6001\u5206\u914D (DHCP)"}),(0,t.jsx)("option",{value:"static",children:"\u9759\u6001IP"})]})]}),w.ipConfig==="static"&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{fontSize:"11px",color:"#666"},children:"\u9759\u6001IP\u5730\u5740\uFF1A"}),(0,t.jsx)("input",{type:"text",value:w.staticIP||"",onChange:function(Z){return ze(C,"staticIP",Z.target.value)},placeholder:pe[w.switchName]?"\u5728 ".concat(pe[w.switchName].subnet," \u4E2D\u7684IP"):"\u5982: 172.20.0.100",style:{width:"100%",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"11px"}}),pe[w.switchName]&&(0,t.jsxs)("div",{style:{fontSize:"9px",color:"#999",marginTop:"2px"},children:["\u{1F4A1} \u5EFA\u8BAEIP\u8303\u56F4: ",pe[w.switchName].subnet]})]})]},C)})}),(0,t.jsxs)("div",{style:{marginTop:"16px"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:"12px",color:"#666"},children:"\u73B0\u6709\u7F51\u5361\u8FDE\u63A5\u7BA1\u7406\uFF1A"}),(0,t.jsx)("button",{onClick:xe,style:{padding:"4px 8px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"11px"},children:"\u{1F504} \u5237\u65B0"})]}),(0,t.jsx)("div",{style:{border:"1px solid #ddd",borderRadius:"4px",padding:"8px",maxHeight:"200px",overflowY:"auto"},children:te.length===0?(0,t.jsx)("div",{style:{color:"#999",fontSize:"12px",textAlign:"center",padding:"16px"},children:"\u6682\u65E0\u7F51\u5361\u8282\u70B9\uFF0C\u8BF7\u5148\u521B\u5EFA\u5BB9\u5668\u67B6\u6784"}):te.map(function(w){return(0,t.jsxs)("div",{style:{border:"1px solid #e9ecef",borderRadius:"3px",padding:"8px",marginBottom:"8px",backgroundColor:w.isConnected?"#e8f5e8":"#f8f9fa"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,t.jsxs)("span",{style:{fontSize:"12px",fontWeight:"bold",color:w.isConnected?"#28a745":"#6c757d"},children:["\u{1F4E1} ",w.label]}),(0,t.jsx)("span",{style:{fontSize:"10px",padding:"2px 6px",borderRadius:"10px",backgroundColor:w.isConnected?"#28a745":"#6c757d",color:"white"},children:w.isConnected?"\u5DF2\u8FDE\u63A5":"\u672A\u8FDE\u63A5"})]}),w.isConnected&&w.connectedSwitch&&(0,t.jsxs)("div",{style:{fontSize:"10px",color:"#28a745",marginBottom:"6px",padding:"2px 0"},children:["\u{1F517} \u8FDE\u63A5\u5230: ",w.connectedSwitch]}),(0,t.jsx)("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:w.isConnected?(0,t.jsx)("button",{onClick:function(){return Se(w.id)},style:{width:"100%",padding:"2px 8px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"10px"},children:"\u65AD\u5F00\u8FDE\u63A5"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("select",{style:{flex:1,padding:"2px 4px",border:"1px solid #ddd",borderRadius:"2px",fontSize:"10px"},defaultValue:le[0]||"",id:"switch-select-".concat(w.id),children:le.map(function(C){return(0,t.jsx)("option",{value:C,children:C},C)})}),(0,t.jsx)("button",{onClick:function(){var R=document.getElementById("switch-select-".concat(w.id)),Z=R==null?void 0:R.value;Z&&O(w.id,Z)},style:{padding:"2px 8px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"10px"},children:"\u8FDE\u63A5"})]})})]},w.id)})})]})]}),(0,t.jsxs)("div",{style:{borderTop:"1px solid #e9ecef",paddingTop:"16px"},children:[(0,t.jsx)("button",{onClick:Ce,style:Ae,title:"\u6839\u636E\u914D\u7F6E\u751F\u6210Docker\u67B6\u6784\u56FE",children:"\u{1F680} \u751F\u6210\u67B6\u6784\u56FE"}),(0,t.jsx)("button",{onClick:at,style:c()(c()({},Ae),{},{backgroundColor:"#28a745"}),title:"\u751F\u6210\u793A\u4F8BNginx\u67B6\u6784",children:"\u{1F4CB} \u793A\u4F8B\u67B6\u6784"}),(0,t.jsx)("button",{onClick:it,style:et,title:"\u6E05\u9664\u753B\u5E03\u4E0A\u7684\u6240\u6709\u5185\u5BB9",children:"\u{1F5D1}\uFE0F \u6E05\u9664\u753B\u5E03"}),(0,t.jsx)("button",{onClick:function(){if(e){var C=e.getContainerCount(),R=e.getDAGRelationships();alert("\u5BB9\u5668\u6570\u91CF: ".concat(C,`
DAG\u4FE1\u606F: `).concat(JSON.stringify(R,null,2)))}},style:c()(c()({},Ae),{},{backgroundColor:"#6c757d"}),title:"\u67E5\u770B\u5BB9\u5668\u7EDF\u8BA1\u548CDAG\u5173\u7CFB",children:"\u{1F4CA} \u67E5\u770B\u7EDF\u8BA1"})]}),(0,t.jsxs)("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#f8f9fa",borderRadius:"4px",fontSize:"12px",color:"#6c757d",lineHeight:"1.4"},children:[(0,t.jsx)("strong",{children:"\u{1F4A1} \u4F7F\u7528\u63D0\u793A\uFF1A"}),(0,t.jsx)("br",{}),"\u2022 \u5148\u521B\u5EFA\u4EA4\u6362\u673A\uFF0C\u7136\u540E\u9009\u62E9\u5BB9\u5668\u8981\u8FDE\u63A5\u7684\u4EA4\u6362\u673A",(0,t.jsx)("br",{}),'\u2022 \u70B9\u51FB"\u793A\u4F8B\u67B6\u6784"\u5FEB\u901F\u751F\u6210\u793A\u4F8B',(0,t.jsx)("br",{}),'\u2022 \u586B\u5199\u5404\u9879\u914D\u7F6E\u540E\u70B9\u51FB"\u751F\u6210\u67B6\u6784\u56FE"',(0,t.jsx)("br",{}),"\u2022 \u5BB9\u5668\u4F1A\u81EA\u52A8\u8FDE\u63A5\u5230\u9009\u4E2D\u7684\u4EA4\u6362\u673A",(0,t.jsx)("br",{}),"\u2022 \u652F\u6301\u591A\u4E2A\u7AEF\u53E3\u3001\u5377\u7528\u9017\u53F7\u5206\u9694",(0,t.jsx)("br",{}),"\u2022 \u751F\u6210\u540E\u53EF\u53CC\u51FB\u8282\u70B9\u7F16\u8F91\u6587\u672C\u5185\u5BB9"]})]})},Ct=function(r){var e=r.contextMenu,a=r.onMenuItemClick,o=r.onHide;return e.visible?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:o}),(0,t.jsxs)("div",{style:{position:"fixed",left:e.x,top:e.y,background:"white",border:"1px solid #d9d9d9",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"150px"},children:[(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid #f0f0f0",transition:"background 0.2s"},onMouseEnter:function(n){n.currentTarget.style.background="#f5f5f5"},onMouseLeave:function(n){n.currentTarget.style.background="white"},onClick:function(){return a("solid-line")},children:"\u5B9E\u7EBF"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid #f0f0f0",transition:"background 0.2s"},onMouseEnter:function(n){n.currentTarget.style.background="#f5f5f5"},onMouseLeave:function(n){n.currentTarget.style.background="white"},onClick:function(){return a("dashed-line")},children:"\u865A\u7EBF"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",transition:"background 0.2s"},onMouseEnter:function(n){n.currentTarget.style.background="#f5f5f5"},onMouseLeave:function(n){n.currentTarget.style.background="white"},onClick:function(){return a("focus-relation")},children:"\u{1F50D} \u805A\u7126\u5173\u7CFB"})]})]}):null},Ie={YAML:"docker-compose-builder-yaml",TIMESTAMP:"docker-compose-builder-timestamp"},ot=function(){var r=(0,m.useCallback)(function(i){try{return localStorage.setItem(Ie.YAML,i),localStorage.setItem(Ie.TIMESTAMP,new Date().toISOString()),console.log("\u81EA\u52A8\u4FDD\u5B58\u5230localStorage\u6210\u529F"),!0}catch(n){return console.warn("\u4FDD\u5B58\u5230localStorage\u5931\u8D25:",n),!1}},[]),e=(0,m.useCallback)(function(){try{var i=localStorage.getItem(Ie.YAML),n=localStorage.getItem(Ie.TIMESTAMP);if(!i||!n)return null;var s=new Date(n),f=new Date,v=(f.getTime()-s.getTime())/(1e3*60*60);return v>=24?null:{yaml:i,timestamp:s,hoursDiff:v}}catch(d){return console.warn("\u8BFB\u53D6localStorage\u5931\u8D25:",d),null}},[]),a=(0,m.useCallback)(function(){try{return localStorage.removeItem(Ie.YAML),localStorage.removeItem(Ie.TIMESTAMP),console.log("\u5DF2\u6E05\u7406localStorage\u6570\u636E"),!0}catch(i){return console.warn("\u6E05\u7406localStorage\u5931\u8D25:",i),!1}},[]),o=(0,m.useCallback)(function(i){var n=e();if(n){var s=window.confirm("\u53D1\u73B0 ".concat(Math.round(n.hoursDiff*10)/10,` \u5C0F\u65F6\u524D\u7684\u4FDD\u5B58\u6570\u636E\uFF0C\u662F\u5426\u6062\u590D\uFF1F

`)+"\u4FDD\u5B58\u65F6\u95F4: ".concat(n.timestamp.toLocaleString()));s&&(console.log("\u5F00\u59CB\u5C1D\u8BD5\u6062\u590D\u6570\u636E..."),i(n.yaml))}},[e]);return{saveYaml:r,loadYaml:e,clearStorage:a,checkAndPromptRestore:o}},Et=de(48464),wt=function ue(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a="  ".repeat(e),o="",i=0,n=Object.entries(r);i<n.length;i++){var s=B()(n[i],2),f=s[0],v=s[1];if(v==null)o+="".concat(a).concat(f,`: null
`);else if(Array.isArray(v))v.length===0?o+="".concat(a).concat(f,`: []
`):(o+="".concat(a).concat(f,`:
`),v.forEach(function(x){if(Te()(x)==="object"&&x!==null){var D=Object.keys(x);if(D.length===0)o+="".concat(a,`  - {}
`);else if(D.length===1){var T=B()(Object.entries(x)[0],2),I=T[0],A=T[1];o+="".concat(a,"  - ").concat(I,": ").concat(A,`
`)}else{var j=D[0],W=x[j];o+="".concat(a,"  - ").concat(j,": ").concat(W,`
`),D.slice(1).forEach(function(U){o+="".concat(a,"    ").concat(U,": ").concat(x[U],`
`)})}}else{var P=String(x);P.includes(":")||P.includes(" ")||P.includes("-")?o+="".concat(a,'  - "').concat(P,`"
`):o+="".concat(a,"  - ").concat(P,`
`)}}));else if(Te()(v)==="object"&&v!==null)Object.keys(v).length===0?o+="".concat(a).concat(f,`: {}
`):(o+="".concat(a).concat(f,`:
`),o+=ue(v,e+1));else{var d=String(v);d.includes(":")||d.includes("#")||d.includes('"')?o+="".concat(a).concat(f,': "').concat(d,`"
`):o+="".concat(a).concat(f,": ").concat(d,`
`)}}return o},Ft=function(r){try{return Et.Qc(r)}catch(a){console.error("YAML\u89E3\u6790\u9519\u8BEF:",a);var e=a instanceof Error?a.message:"YAML\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u8BED\u6CD5";throw new Error(e)}},Dt=function(r){var e={};if(r.image&&(e.image=r.image),r.build&&(e.build=r.build),r.user&&(e.user=r.user),r.entrypoint&&(r.entrypoint==="[]"?e.entrypoint=[]:r.entrypoint.trim()&&(r.entrypointIsArray?e.entrypoint=r.entrypoint.includes(" ")?r.entrypoint.split(" "):[r.entrypoint]:e.entrypoint=r.entrypoint)),r.command&&r.command!=="tail -f /etc/hosts"&&r.command.trim()&&(r.commandIsArray?e.command=r.command.includes(" ")?r.command.split(" "):[r.command]:e.command=r.command),r.ports&&r.ports.length>0&&(e.ports=r.ports),r.volumes&&r.volumes.length>0&&(e.volumes=r.volumes),r.environment&&(e.environment=r.environment),r.ulimits&&(e.ulimits=r.ulimits),r.networkInterfaces&&r.networkInterfaces.length>0){var a={};r.networkInterfaces.forEach(function(o){o.ipConfig==="static"&&o.staticIP?a[o.switchName]={ipv4_address:o.staticIP}:a[o.switchName]={}}),e.networks=a}return r.dns&&r.dns.length>0&&(e.dns=r.dns),r.restart&&(e.restart=r.restart),r.depends_on&&r.depends_on.length>0&&(e.depends_on=r.depends_on),e},St=function(r){var e={};return Object.entries(r).forEach(function(a){var o=B()(a,2),i=o[0],n=o[1];e[i]={driver:"bridge",ipam:{config:[{subnet:n.subnet,gateway:n.gateway}]}}}),e},Nt=function(r,e){var a=ot(),o=a.saveYaml,i=a.clearStorage,n=(0,m.useCallback)(function(){if(!e||!r)return console.log("Docker Factory\u6216Graph\u672A\u521D\u59CB\u5316"),"";var f=r.getNodes(),v=f.filter(function(A){return A.shape==="docker-container"});if(v.length===0)return i(),`# \u672A\u627E\u5230\u4EFB\u4F55Docker\u5BB9\u5668
version: "3.8"
services: {}`;var d={},x={},D=new Set;v.forEach(function(A){var j=A.getChildren()||[],W=A.getData(),P=(W==null?void 0:W.config)||{},U=j.find(function(M){return M.shape==="docker-service"}),E=U==null?void 0:U.attr("text/text"),F=(typeof E=="string"?E:null)||(typeof A.attr("text/text")=="string"?A.attr("text/text"):null)||"service",k=j.find(function(M){return M.shape==="docker-image"}),h=k==null?void 0:k.attr("text/text"),S=(typeof h=="string"?h:null)||"nginx:latest",z=j.find(function(M){return M.shape==="docker-user"}),b=(z==null?void 0:z.attr("text/text"))||"",l=b&&typeof b=="string"?b.replace("user: ",""):void 0,y=j.filter(function(M){return M.shape==="docker-script"}),g="",N="";y.forEach(function(M){var te=M.getData(),ce=te==null?void 0:te.scriptType,be=M.attr("text/text");ce==="entrypoint"?g=be:(ce==="command"||!ce)&&(N=be)});var Y=j.filter(function(M){return M.shape==="docker-port"}),_=Y.map(function(M){return M.attr("text/text")}),Q=j.filter(function(M){return M.shape==="docker-volume"}),G=Q.map(function(M){return M.attr("text/text")});G.forEach(function(M){if(M&&M.includes(":")){var te=M.split(":"),ce=B()(te,1),be=ce[0];!be.startsWith("/")&&!be.startsWith(".")&&D.add(be)}});var X=j.filter(function(M){return M.shape==="docker-env"}),q=[];if(X.length>0){var re=X[0],ee=re.getData();if(ee!=null&&ee.envList&&Array.isArray(ee.envList))q=ee.envList;else{var he=re.attr("text/text")||"";q=he.split(`
`).filter(function(M){return M.trim()})}}var ne=j.filter(function(M){return M.shape==="docker-build"}),V=void 0;if(ne.length>0){var K=ne[0],J=K.getData();J!=null&&J.build&&(V=J.build)}var $=j.filter(function(M){return M.shape==="docker-ulimits"}),oe=void 0;if($.length>0){var fe=$[0],se=fe.getData();se!=null&&se.ulimits&&(oe=se.ulimits)}var ve=j.filter(function(M){return M.shape==="docker-network"}),ye=[];ve.forEach(function(M){var te=M.getData(),ce=te==null?void 0:te.networkInterface;ce&&ye.push(ce)});var le=j.filter(function(M){return M.shape==="docker-dns"}),me=[];le.forEach(function(M){var te=M.getData(),ce=te==null?void 0:te.dnsAddress;ce&&me.push(ce)});var ge={containerName:F,user:l,ports:_,volumes:G,environment:q.length>0?q:P.environment||[],networkInterfaces:ye,switchNetworks:P.switchNetworks||{},dns:me.length>0?me:void 0,entrypoint:g,entrypointIsArray:P.entrypointIsArray,command:N,commandIsArray:P.commandIsArray,restart:P.restart||"unless-stopped",depends_on:P.depends_on||[]};V&&(ge.build=V),S&&S!=="nginx:latest"?ge.image=S:V||(ge.image=S),oe&&(ge.ulimits=oe),d[F]=Dt(ge),ge.switchNetworks&&Object.assign(x,ge.switchNetworks)});var T={version:"3.8",services:d};Object.keys(x).length>0&&(T.networks=St(x)),D.size>0&&(T.volumes={},D.forEach(function(A){T.volumes[A]={}}));var I=wt(T);return o(I),I},[e,r,o,i]),s=(0,m.useCallback)(function(f){if(!e||!r||!f.trim())return console.log("\u8BF7\u8F93\u5165\u6709\u6548\u7684YAML\u5185\u5BB9"),!1;try{var v=Ft(f);if(!v.services)throw new Error("\u672A\u627E\u5230services\u914D\u7F6E");var d=r.getNodes(),x=d.filter(function(h){return h.shape==="docker-container"});if(x.length>0){var D=window.confirm("\u753B\u5E03\u4E0A\u5DF2\u6709\u5BB9\u5668\uFF0C\u662F\u5426\u6E05\u7A7A\u73B0\u6709\u5185\u5BB9\uFF1F");D&&r.clearCells()}var T=750,I=350,A=50,j=50,W=50,P=50,U=2,E={};Object.entries(v.services).forEach(function(h,S){var z=B()(h,2),b=z[0],l=z[1],y=l.ports?Array.isArray(l.ports)?l.ports:[l.ports]:[],g=l.volumes?Array.isArray(l.volumes)?l.volumes:[l.volumes]:[],N=[];l.networks&&(Array.isArray(l.networks)?l.networks.forEach(function(K,J){N.push({interfaceName:"eth".concat(J),switchName:K,ipConfig:"dynamic"})}):Te()(l.networks)==="object"&&Object.entries(l.networks).forEach(function(K,J){var $=B()(K,2),oe=$[0],fe=$[1];N.push({interfaceName:"eth".concat(J),switchName:oe,ipConfig:"static",staticIP:fe.ipv4_address||"172.20.0.100"})}));var Y=Math.floor(S/U),_=S%U,Q=W+_*(T+A),G=P+Y*(I+j),X=[];l.environment&&(Array.isArray(l.environment)?X=l.environment:Te()(l.environment)==="object"&&(X=Object.entries(l.environment).map(function(K){var J=B()(K,2),$=J[0],oe=J[1];return"".concat($,"=").concat(oe)})));var q=[];l.dns&&(Array.isArray(l.dns)?q=l.dns:typeof l.dns=="string"&&(q=[l.dns]));var re=e.createDockerArchitecture({containerName:b,image:l.image,build:l.build,user:l.user,entrypoint:l.entrypoint!==void 0?Array.isArray(l.entrypoint)?l.entrypoint.length>0?l.entrypoint.join(" "):"[]":l.entrypoint:void 0,command:l.command?Array.isArray(l.command)?l.command.join(" "):l.command:void 0,ports:y,volumes:g,environment:X,ulimits:l.ulimits,networkInterfaces:N,dns:q,position:{x:Q,y:G}}),ee=re.containerNode;E[b]=ee;var he={};v.networks&&Object.entries(v.networks).forEach(function(K){var J,$,oe=B()(K,2),fe=oe[0],se=oe[1];he[fe]={subnet:(se==null||(J=se.ipam)===null||J===void 0||(J=J.config)===null||J===void 0||(J=J[0])===null||J===void 0?void 0:J.subnet)||"172.20.0.0/16",gateway:(se==null||($=se.ipam)===null||$===void 0||($=$.config)===null||$===void 0||($=$[0])===null||$===void 0?void 0:$.gateway)||"172.20.0.1"}});var ne=[];l.depends_on&&(Array.isArray(l.depends_on)?ne=l.depends_on:Te()(l.depends_on)==="object"&&(ne=Object.keys(l.depends_on)));var V={containerName:b,user:l.user,ports:y,volumes:g,environment:l.environment||[],networkInterfaces:N,switchNetworks:he,entrypoint:l.entrypoint!==void 0?Array.isArray(l.entrypoint)?l.entrypoint.length>0?l.entrypoint.join(" "):"[]":l.entrypoint:"",entrypointIsArray:Array.isArray(l.entrypoint),command:l.command?Array.isArray(l.command)?l.command.join(" "):l.command:void 0,commandIsArray:Array.isArray(l.command),restart:l.restart||"unless-stopped",depends_on:ne};l.build&&(V.build=l.build),l.image?V.image=l.image:l.build||(V.image="docker.io/library/nginx:latest"),l.ulimits&&(V.ulimits=l.ulimits),ee.setData({config:V}),ee.attr("text/text","")});var F={};return v.networks&&Object.keys(v.networks).forEach(function(h,S){var z=r.getNodes().find(function(re){if(re.shape==="network-switch"){var ee=re.getData();return(ee==null?void 0:ee.switchName)===h}return!1});if(!z){var b,l,y,g=(b=v.networks)===null||b===void 0?void 0:b[h],N=g?{subnet:(l=g.ipam)===null||l===void 0||(l=l.config)===null||l===void 0||(l=l[0])===null||l===void 0?void 0:l.subnet,gateway:(y=g.ipam)===null||y===void 0||(y=y.config)===null||y===void 0||(y=y[0])===null||y===void 0?void 0:y.gateway}:void 0,Y=N?{subnet:N.subnet}:void 0;z=e.createSwitch(h,Y);var _=W+U*(T+A)+100,Q=P+S*150;if(z.setPosition({x:_,y:Q}),N!=null&&N.gateway){var G="".concat(h,"_router"),X="".concat(G,`
GW: `).concat(N.gateway),q=e.createRouter(X);q.setPosition({x:_+200,y:Q}),r.addEdge({source:{cell:z.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:q.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#28a745",strokeWidth:3,strokeDasharray:5,targetMarker:"classic",style:{animation:"ant-line 30s infinite linear"}}},zIndex:2,data:{originalStroke:"#28a745",originalWidth:3}})}}F[h]=z}),setTimeout(function(){Object.values(E).forEach(function(b){var l=b.getChildren()||[],y=l.filter(function(g){return g.shape==="docker-network"});y.forEach(function(g){var N=g.getData(),Y=N==null?void 0:N.networkInterface;if(Y&&Y.switchName){var _=F[Y.switchName];if(_){var Q=r.getCellById(g.id),G=r.getCellById(_.id);if(!Q||!G){console.error("\u8282\u70B9\u4E0D\u5B58\u5728\uFF0C\u8DF3\u8FC7\u8FDE\u63A5");return}r.addEdge({source:{cell:g.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},target:{cell:_.id,anchor:{name:"center"},connectionPoint:{name:"boundary"}},router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10}},attrs:{line:{stroke:"#28a745",strokeWidth:2,strokeDasharray:5,targetMarker:{name:"block",width:8,height:6},style:{animation:"ant-line 30s infinite linear"}}},zIndex:1}),console.log("\u8FDE\u63A5\u7F51\u5361 ".concat(Y.interfaceName," \u5230\u4EA4\u6362\u673A ").concat(Y.switchName))}}})}),console.log("\u6240\u6709\u7F51\u7EDC\u8FDE\u63A5\u521B\u5EFA\u5B8C\u6210"),Object.values(E).forEach(function(b){var l=b.getChildren()||[],y=l.filter(function(g){return g.shape==="docker-dns"});y.forEach(function(g){var N=g.getData();N!=null&&N.needsConnection&&N!==null&&N!==void 0&&N.dnsAddress&&(e.connectDNS(g,N.dnsAddress),console.log("\u81EA\u52A8\u8FDE\u63A5DNS\u8282\u70B9: ".concat(N.dnsAddress)))})}),console.log("\u6240\u6709DNS\u8FDE\u63A5\u521B\u5EFA\u5B8C\u6210");var h={},S={},z={};Object.entries(v.services).forEach(function(b){var l,y=B()(b,2),g=y[0],N=y[1],Y=E[g];if(Y){var _=Y.getData(),Q=(_==null||(l=_.config)===null||l===void 0?void 0:l.depends_on)||[];Q.forEach(function(G){var X=E[G];if(X){var q=X.getBBox(),re=Y.getBBox(),ee=re.center.x-q.center.x,he=re.center.y-q.center.y,ne,V;Math.abs(ee)>Math.abs(he)?ee>0?(ne="right",V="left"):(ne="left",V="right"):he>0?(ne="bottom",V="top"):(ne="top",V="bottom");var K=S[X.id];if(!K){K={portId:"out-port",group:ne},S[X.id]=K;var J=X.getPorts(),$=J.some(function(le){return le.id==="out-port"});$||X.addPort({id:"out-port",group:ne})}var oe=h[Y.id];if(!oe){oe={portId:"in-port",group:V},h[Y.id]=oe;var fe=Y.getPorts(),se=fe.some(function(le){return le.id==="in-port"});se||Y.addPort({id:"in-port",group:V})}var ve=z[X.id]||0;z[X.id]=ve+1;var ye=32+ve%3*16;r.addEdge({source:{cell:X.id,port:K.portId},target:{cell:Y.id,port:oe.portId},router:{name:"er",args:{offset:ye,direction:"H"}},attrs:{line:{stroke:"#ff6b6b",strokeWidth:2,strokeDasharray:"5 5",targetMarker:{name:"block",width:8,height:6},style:{animation:"ant-line 30s infinite linear"}}},zIndex:10,data:{type:"dependency",originalStroke:"#ff6b6b",originalWidth:2}}),console.log("\u521B\u5EFA\u4F9D\u8D56\u5173\u7CFB\u8FDE\u63A5: ".concat(G," -> ").concat(g," (\u6E90\u7AEF\u53E3: ").concat(K.portId,", \u76EE\u6807\u7AEF\u53E3: ").concat(oe.portId,")"))}})}}),console.log("\u6240\u6709\u4F9D\u8D56\u5173\u7CFB\u8FDE\u63A5\u521B\u5EFA\u5B8C\u6210")},100),o(f),console.log("Docker Compose\u5BFC\u5165\u6210\u529F - \u5305\u542B\u7F51\u7EDC\u62D3\u6251"),!0}catch(h){console.error("\u5BFC\u5165\u5931\u8D25:",h);var k=h instanceof Error?h.message:"\u672A\u77E5\u9519\u8BEF";return alert("\u5BFC\u5165\u5931\u8D25: ".concat(k)),!1}},[e,r,o]);return{exportDockerCompose:n,importDockerCompose:s}},At=function(r,e){var a=(0,m.useState)({visible:!1,x:0,y:0,node:null,nodeType:""}),o=B()(a,2),i=o[0],n=o[1],s=(0,m.useState)(!1),f=B()(s,2),v=f[0],d=f[1],x=(0,m.useState)(null),D=B()(x,2),T=D[0],I=D[1],A=(0,m.useState)({interfaceName:"",switchName:"",ipConfig:"dynamic",staticIP:""}),j=B()(A,2),W=j[0],P=j[1],U=(0,m.useCallback)(function(k,h){k.preventDefault();var S="";h.shape==="docker-container"?S="container":["docker-service","docker-image","docker-port","docker-volume","docker-network","docker-script","docker-user","docker-dns"].includes(h.shape)?S="component":S="other",n({visible:!0,x:k.clientX,y:k.clientY,node:h,nodeType:S})},[]),E=(0,m.useCallback)(function(){n(function(k){return c()(c()({},k),{},{visible:!1})})},[]),F=(0,m.useCallback)(function(k){if(!(!e||!i.node)){var h=i.node;switch(k){case"add-port":if(h.shape==="docker-container"){var S=prompt("\u8BF7\u8F93\u5165\u7AEF\u53E3\u6620\u5C04 (\u4F8B\u5982: 8080:80)","8080:80");S&&e.addPortToContainer(h,S)}break;case"add-volume":if(h.shape==="docker-container"){var z=prompt("\u8BF7\u8F93\u5165\u5377\u6302\u8F7D (\u4F8B\u5982: /host/path:/container/path)","/data:/app/data");z&&e.addVolumeToContainer(h,z)}break;case"add-network":if(h.shape==="docker-container"){for(var b=h.getChildren()||[],l=b.filter(function(G){return G.shape==="docker-network"}).map(function(G){var X,q,re=G.getData()||{};return((X=re.networkInterface)===null||X===void 0?void 0:X.interfaceName)||((q=G.attr("text/text"))===null||q===void 0?void 0:q.split(`
`)[0])||""}),y="eth0",g=0;l.includes(y);)g++,y="eth".concat(g);P({interfaceName:y,switchName:"",ipConfig:"dynamic",staticIP:""}),I(h),d(!0)}break;case"add-user":if(h.shape==="docker-container"){if(e.hasUniqueComponent(h,"docker-user")){alert("\u5BB9\u5668\u5DF2\u6709\u7528\u6237\u914D\u7F6E\uFF0C\u6BCF\u4E2A\u5BB9\u5668\u53EA\u80FD\u6709\u4E00\u4E2A\u7528\u6237\u914D\u7F6E");break}var N=prompt("\u8BF7\u8F93\u5165\u7528\u6237\u914D\u7F6E (\u4F8B\u5982: root \u6216 1000:1000)","root");if(N){var Y=h.getPosition(),_=r==null?void 0:r.addNode({shape:"docker-user",x:Y.x+180,y:Y.y+40,label:"user: ".concat(N),zIndex:10});_&&h.addChild(_)}}break;case"add-dns":if(h.shape==="docker-container"){var Q=prompt("\u8BF7\u8F93\u5165DNS\u5730\u5740 (\u4F8B\u5982: 8.8.8.8, 10.0.0.13, \u6216\u5BB9\u5668\u540D)","8.8.8.8");Q&&e.addDNSToContainer(h,Q)}break;case"delete-component":i.nodeType==="component"&&confirm("\u786E\u5B9A\u8981\u5220\u9664\u6B64\u7EC4\u4EF6\u5417\uFF1F")&&e.removeChildComponent(h);break}E()}},[e,i.node,i.nodeType,r,E]);return{contextMenu:i,handleContextMenu:U,hideContextMenu:E,handleMenuItemClick:F,showNetworkModal:v,setShowNetworkModal:d,currentContainerNode:T,networkModalData:W,setNetworkModalData:P}},Bt=function(r){var e=(0,m.useState)({visible:!1,x:0,y:0,edge:null}),a=B()(e,2),o=a[0],i=a[1],n=(0,m.useState)({visible:!1,edge:null,sourceNode:null,targetNode:null}),s=B()(n,2),f=s[0],v=s[1],d=(0,m.useState)(!1),x=B()(d,2),D=x[0],T=x[1],I=(0,m.useState)([]),A=B()(I,2),j=A[0],W=A[1],P=(0,m.useState)([]),U=B()(P,2),E=U[0],F=U[1],k=(0,m.useCallback)(function(y,g){y.preventDefault(),y.stopPropagation(),i({visible:!0,x:y.clientX,y:y.clientY,edge:g})},[]),h=(0,m.useCallback)(function(){i(function(y){return c()(c()({},y),{},{visible:!1})})},[]),S=(0,m.useCallback)(function(){if(!(!r||!o.edge)){var y=o.edge,g=y.getSourceNode(),N=y.getTargetNode();if(!(!g||!N)){var Y=function(V){if(V.shape==="docker-container")return V;var K=V.getParent();return K&&K.shape==="docker-container"?K:V},_=Y(g),Q=Y(N),G=new Set,X=function(V){G.add(V.id);var K=V.getChildren();K&&K.forEach(function(J){G.add(J.id)})};X(_),Q.id!==_.id&&X(Q);var q=function(V){var K=V.getChildren()||[],J=K.filter(function($){return $.shape==="docker-network"});J.forEach(function($){G.add($.id);var oe=r.getConnectedEdges($);oe.forEach(function(fe){var se;G.add(fe.id);var ve=((se=fe.getSourceNode())===null||se===void 0?void 0:se.id)===$.id?fe.getTargetNode():fe.getSourceNode();if(ve&&ve.shape==="network-switch"){G.add(ve.id);var ye=r.getConnectedEdges(ve);ye.forEach(function(le){var me;G.add(le.id);var ge=((me=le.getSourceNode())===null||me===void 0?void 0:me.id)===ve.id?le.getTargetNode():le.getSourceNode();ge&&ge.shape==="network-router"&&G.add(ge.id)})}})})};q(_),Q.id!==_.id&&q(Q);var re=r.getCells(),ee=[],he=[];re.forEach(function(ne){ne.id!==y.id&&(G.has(ne.id)||(ne.hide(),ee.push(ne),he.push(ne.id)))}),W(ee),F(he),T(!0),console.log("\u805A\u7126\u6A21\u5F0F: \u663E\u793A ".concat(G.size," \u4E2A\u8282\u70B9\u548C 1 \u6761\u8FB9\uFF0C\u9690\u85CF ").concat(ee.length," \u4E2A\u5143\u7D20")),console.log("\u9690\u85CF\u7684\u5143\u7D20ID:",he)}}},[r,o.edge]),z=(0,m.useCallback)(function(){if(r){console.log("\u5F00\u59CB\u9000\u51FA\u805A\u7126\u6A21\u5F0F\uFF0C\u9700\u8981\u6062\u590D\u7684\u5143\u7D20ID:",E),E.forEach(function(N){var Y=r.getCellById(N);Y?Y.isVisible()||(Y.show(),console.log("\u901A\u8FC7ID\u6062\u590D\u663E\u793A:",N,Y.isNode()?"\u8282\u70B9":"\u8FB9")):console.warn("\u65E0\u6CD5\u627E\u5230\u5143\u7D20:",N)});var y=r.getCells(),g=0;y.forEach(function(N){N.isVisible()||(N.show(),g++,console.log("\u989D\u5916\u6062\u590D\u9690\u85CF\u5143\u7D20:",N.id))}),console.log("\u9000\u51FA\u805A\u7126\u6A21\u5F0F\u5B8C\u6210: \u901A\u8FC7ID\u6062\u590D ".concat(E.length," \u4E2A\u5143\u7D20\uFF0C\u989D\u5916\u6062\u590D ").concat(g," \u4E2A\u5143\u7D20")),W([]),F([]),T(!1)}},[r,E]),b=(0,m.useCallback)(function(y){if(!(!r||!o.edge)){var g=o.edge;switch(y){case"solid-line":g.attr("line/strokeDasharray",0);break;case"dashed-line":g.attr("line/strokeDasharray","5 5");break;case"focus-relation":S();break}h()}},[r,o.edge,h,S]),l=(0,m.useCallback)(function(){v({visible:!1,edge:null,sourceNode:null,targetNode:null})},[]);return{edgeContextMenu:o,handleEdgeContextMenu:k,hideEdgeContextMenu:h,handleEdgeMenuItemClick:b,edgeRelationModal:f,closeEdgeRelationModal:l,isFocusMode:D,exitFocusMode:z}},jt=function(r,e,a,o){return{container:r,width:a,height:o,grid:!0,scroller:{enabled:!0,pannable:!1,pageVisible:!1,pageBreak:!1,autoResize:!0,padding:50},mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:{name:"manhattan",args:{padding:1,startDirections:["right"],endDirections:["left"],step:10,excludeTerminals:[]}},connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge:function(){return new ae.bn.kS({attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:0})},validateConnection:function(n){var s=n.targetMagnet;return!!s}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},resizing:!0,rotating:!0,selecting:{enabled:!0,rubberband:!0,showNodeSelectionBox:!0,showEdgeSelectionBox:!0,movable:!0,multiple:!0,strict:!1,following:!0},snapline:{enabled:!0},keyboard:!0,clipboard:!0,history:!0,minimap:{enabled:!0,container:e,width:250,height:150,padding:10,scalable:!0,graphOptions:{async:!0,createCellView:function(n){if(n.isEdge())return null}}}}},Ve=function(r){var e=new Set(r),a=function o(i){var n=i.getChildren();n&&n.length>0&&n.forEach(function(s){e.add(s),o(s)})};return r.forEach(function(o){a(o)}),Array.from(e)},Mt=function(r,e,a){var o=(0,m.useCallback)(function(){if(r){r.bindKey(["meta+c","ctrl+c"],function(){var n=r.getSelectedCells();if(n.length){var s=Ve(n),f=s.filter(function(d){return d.isNode()}),v=s.filter(function(d){return d.isEdge()});r.copy(s),console.log("\u5DF2\u590D\u5236: \u76F4\u63A5\u9009\u4E2D ".concat(n.length," \u4E2A\u5143\u7D20\uFF0C\u5305\u542B\u7236\u5B50\u5173\u7CFB\u540E ").concat(s.length," \u4E2A\u5143\u7D20"),{\u9009\u4E2D:n.length,\u603B\u8BA1:s.length,\u8282\u70B9:f.length,\u8FB9:v.length})}return!1}),r.bindKey(["meta+x","ctrl+x"],function(){var n=r.getSelectedCells();if(n.length){var s=Ve(n),f=s.filter(function(d){return d.isNode()}),v=s.filter(function(d){return d.isEdge()});r.cut(s),console.log("\u5DF2\u526A\u5207: \u76F4\u63A5\u9009\u4E2D ".concat(n.length," \u4E2A\u5143\u7D20\uFF0C\u5305\u542B\u7236\u5B50\u5173\u7CFB\u540E ").concat(s.length," \u4E2A\u5143\u7D20"),{\u9009\u4E2D:n.length,\u603B\u8BA1:s.length,\u8282\u70B9:f.length,\u8FB9:v.length})}return!1}),r.bindKey(["meta+v","ctrl+v"],function(){if(!r.isClipboardEmpty()){var n=r.paste({offset:32});n.forEach(function(s,f){if(s.isNode()&&s.shape==="docker-container"){for(var v=s.getData()||{},d=v.config||{},x=s.attr("text/text")||"",D=x||d.containerName||"container",T=D.replace(/\d+$/,""),I=2,A=(r==null?void 0:r.getNodes().filter(function(E){return E.shape==="docker-container"}))||[],j=A.map(function(E){return E.attr("text/text")||""});j.includes("".concat(T).concat(I));)I++;var W="".concat(T).concat(I),P=W,U={containerName:P,image:d.image||"docker.io/library/nginx:latest",ports:d.ports||["80"],volumes:d.volumes||[],environment:d.environment||[],networkInterfaces:d.networkInterfaces||[{interfaceName:"eth0",switchName:"nginx-tomcat",ipConfig:"static",staticIP:"172.20.0.".concat(100+f)}],switchNetworks:d.switchNetworks||{"nginx-tomcat":{subnet:"172.20.0.0/16",gateway:"172.20.0.1"},switch1:{subnet:"172.18.0.0/16",gateway:"172.18.0.1"},switch2:{subnet:"172.19.0.0/16",gateway:"172.19.0.1"}},entrypoint:d.entrypoint||"",entrypointIsArray:d.entrypointIsArray,command:d.command||"tail -f /etc/hosts",commandIsArray:d.commandIsArray,restart:d.restart||"unless-stopped"};s.attr("text/text",W),s.setData(c()(c()({},v),{},{config:U}))}}),r.cleanSelection(),r.select(n),console.log("\u5DF2\u7C98\u8D34 ".concat(n.length," \u4E2A\u5143\u7D20"))}return!1}),r.bindKey(["meta+z","ctrl+z"],function(){return r.history.canUndo()&&r.history.undo(),!1}),r.bindKey(["meta+shift+z","ctrl+shift+z","ctrl+y","meta+y"],function(){return r.history.canRedo()&&r.history.redo(),!1}),r.bindKey(["meta+a","ctrl+a"],function(){var n=r.getNodes();n&&r.select(n)});var i=function(){var s=document.activeElement,f=s&&(s.tagName==="INPUT"||s.tagName==="TEXTAREA"||s.tagName==="SELECT"||s.getAttribute("contenteditable")==="true"||s.isContentEditable||s.tagName==="DIV"&&s.closest(".x6-widget-text-editor")),v=s&&(s.closest(".ant-modal")||s.closest('[role="dialog"]')||a);if(f||v)return!1;var d=r.getSelectedCells();if(d.length){var x=Ve(d),D=x.filter(function(I){return I.isNode()}),T=x.filter(function(I){return I.isEdge()});return r.removeCells(x),console.log("\u5DF2\u5220\u9664: \u76F4\u63A5\u9009\u4E2D ".concat(d.length," \u4E2A\u5143\u7D20\uFF0C\u5305\u542B\u7236\u5B50\u5173\u7CFB\u540E ").concat(x.length," \u4E2A\u5143\u7D20"),{\u9009\u4E2D:d.length,\u603B\u8BA1:x.length,\u8282\u70B9:D.length,\u8FB9:T.length}),!0}return!1};r.bindKey("delete",function(){var n=i();return n}),r.bindKey(["ctrl+1","meta+1"],function(){var n=r.zoom();n<1.5&&r.zoom(.1)}),r.bindKey(["ctrl+2","meta+2"],function(){var n=r.zoom();n>.5&&r.zoom(-.1)})}},[r,a]);return(0,m.useEffect)(function(){var i=!1,n=function(v){if(v.code==="Space"&&!i){var d=document.activeElement,x=d&&(d.tagName==="INPUT"||d.tagName==="TEXTAREA"||d.tagName==="SELECT"||d.getAttribute("contenteditable")==="true");if(x)return;v.preventDefault(),i=!0,e&&e(!0)}},s=function(v){v.code==="Space"&&i&&(v.preventDefault(),i=!1,e&&e(!1))};return document.addEventListener("keydown",n),document.addEventListener("keyup",s),function(){document.removeEventListener("keydown",n),document.removeEventListener("keyup",s)}},[e]),{bindShortcuts:o}},Tt=function(r){var e=(0,m.useState)(!1),a=B()(e,2),o=a[0],i=a[1],n=(0,m.useCallback)(function(s){r&&(i(s),s?(r.enablePanning(),r.disableSelection(),r.disableRubberband()):(r.disablePanning(),r.enableSelection(),r.enableRubberband()))},[r]);return{isDragMode:o,togglePanningMode:n}},It=function(r){var e=(0,m.useCallback)(function(){r&&r.getCells().forEach(function(n){n.removeTools()})},[r]),a=function(s,f){r&&s.addTools([{name:"node-editor",args:{event:f}}])},o=(0,m.useCallback)(function(n,s){r&&n.addTools([{name:"edge-editor",args:{event:s}}])},[r]),i=(0,m.useCallback)(function(n,s){n.isNode()?a(n,s):n.isEdge()&&o(n,s)},[a,o]);return{clearAllEditingTools:e,addNodeEditor:a,addEdgeEditor:o,handleDoubleClick:i}},zt=function(r){var e=r.graph,a=r.handleContextMenu,o=r.hideContextMenu,i=r.handleDoubleClick,n=r.handleEdgeClick,s=r.hideEdgeContextMenu;(0,m.useEffect)(function(){if(e){var f=function(F,k){for(var h=0,S=F.length;h<S;h=h+1)F[h].style.visibility=k?"visible":"hidden"},v=function(F){var k=F.e,h=F.node;a(k,h)},d=function(){o(),s&&s()},x=function(F){var k=F.e,h=F.x,S=F.y,z=F.edge,b=F.view;n&&n(k,z)},D=function(F){var k=F.e,h=F.edge;n&&n(k,h)},T=function(F){var k=F.node,h=F.e;i(k,h)},I=function(F){var k=F.cell,h=F.e;i(k,h)},A=function(F){var k=F.node,h=[];if(k.shape==="docker-container")h=[k];else if(["docker-service","docker-script","docker-image","docker-volume","docker-port","docker-network","docker-env"].includes(k.shape)){var S=k.getParent();S&&S.shape==="docker-container"&&(h=[S]),h.push(k)}else["network-switch","network-router"].includes(k.shape)?h=[k]:h=[k];h.forEach(function(z){var b,l=(b=e.findViewByCell(z))===null||b===void 0?void 0:b.container;if(l){var y=l.querySelectorAll(".x6-port-body");f(y,!0)}})},j=function(F){var k=F.node,h=F.e;setTimeout(function(){var S=document.elementFromPoint(h.clientX||0,h.clientY||0),z=S==null?void 0:S.closest(".x6-node");if(!z){var b=e.container,l=b.querySelectorAll(".x6-port-body");f(l,!1)}},100)},W=function(F){var k=F.edge;if(k.addTools([{name:"vertices",args:{attrs:{fill:"#007bff",stroke:"#fff","stroke-width":2},snapRadius:20}},{name:"segments",args:{threshold:40,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#007bff",stroke:"#fff","stroke-width":2}}},{name:"source-arrowhead",args:{attrs:{fill:"#28a745",stroke:"#fff","stroke-width":2,cursor:"move"}}},{name:"target-arrowhead",args:{attrs:{fill:"#dc3545",stroke:"#fff","stroke-width":2,cursor:"move"}}},{name:"button-remove",args:{distance:20,markup:[{tagName:"circle",selector:"button",attrs:{r:8,stroke:"#dc3545","stroke-width":2,fill:"#fff",cursor:"pointer"}},{tagName:"text",textContent:"\xD7",selector:"icon",attrs:{fill:"#dc3545","font-size":12,"text-anchor":"middle","pointer-events":"none",y:"0.3em","font-weight":"bold"}}]}}]),!e.isSelected(k)){var h=k.getData()||{},S=h.originalStroke||"#6c757d",z=h.originalWidth||2,b="#007bff";h.type==="dependency"&&(b="#e63946"),k.attr({line:{strokeWidth:z+2,stroke:b}}),h.originalStroke?k.setData(c()(c()({},h),{},{isHovering:!0})):k.setData(c()(c()({},h),{},{originalStroke:S,originalWidth:z,isHovering:!0}))}},P=function(F){var k,h=F.edge;if(h.removeTools(),!e.isSelected(h)&&(k=h.getData())!==null&&k!==void 0&&k.isHovering){var S=h.getData();h.attr({line:{strokeWidth:S.originalWidth||2,stroke:S.originalStroke||"#6c757d"}}),h.setData(c()(c()({},S),{},{isHovering:!1}))}},U=function(F){var k=F.added,h=F.removed;h.forEach(function(z){z.isEdge()&&z.removeTools()});var S=e.getSelectedCells();console.log("\u9009\u4E2D\u7684\u5355\u5143\u683C:",S)};return e.on("node:contextmenu",v),e.on("blank:click",d),e.on("node:dblclick",T),e.on("node:mouseenter",A),e.on("node:mouseleave",j),e.on("edge:mouseenter",W),e.on("edge:mouseleave",P),e.on("edge:click",x),e.on("edge:contextmenu",D),e.on("selection:changed",U),document.addEventListener("click",o),function(){e.off("node:contextmenu",v),e.off("blank:click",d),e.off("node:dblclick",T),e.off("node:mouseenter",A),e.off("node:mouseleave",j),e.off("edge:mouseenter",W),e.off("edge:mouseleave",P),e.off("edge:click",x),e.off("edge:contextmenu",D),e.off("selection:changed",U),document.removeEventListener("click",o)}}},[e,a,o,i,n,s])},Rt=function(){var r,e=(0,m.useRef)(null),a=(0,m.useRef)(null),o=(0,m.useRef)(null),i=(0,m.useState)(),n=B()(i,2),s=n[0],f=n[1],v=(0,m.useState)(!1),d=B()(v,2),x=d[0],D=d[1],T=(0,m.useState)(!1),I=B()(T,2),A=I[0],j=I[1],W=(0,m.useState)(!1),P=B()(W,2),U=P[0],E=P[1],F=(0,m.useState)(""),k=B()(F,2),h=k[0],S=k[1],z=(0,m.useState)(""),b=B()(z,2),l=b[0],y=b[1],g=(0,m.useRef)(),N=(0,m.useRef)(!1),Y=(0,m.useState)(!1),_=B()(Y,2),Q=_[0],G=_[1],X=(0,m.useState)("manhattan"),q=B()(X,2),re=q[0],ee=q[1],he=ot(),ne=he.saveYaml,V=he.clearStorage,K=he.checkAndPromptRestore,J=Nt(g.current,s),$=J.exportDockerCompose,oe=J.importDockerCompose,fe=Tt(g.current),se=fe.isDragMode,ve=fe.togglePanningMode,ye=x||A||U,le=Mt(g.current,ve,ye),me=le.bindShortcuts,ge=It(g.current),M=ge.handleDoubleClick,te=At(g.current,s),ce=te.contextMenu,be=te.handleContextMenu,Le=te.hideContextMenu,pe=te.handleMenuItemClick,_e=te.showNetworkModal,De=te.setShowNetworkModal,xe=te.currentContainerNode,O=te.networkModalData,Se=te.setNetworkModalData,Ce=Bt(g.current),Qe=Ce.edgeContextMenu,qe=Ce.handleEdgeContextMenu,Ue=Ce.hideEdgeContextMenu,ze=Ce.handleEdgeMenuItemClick,it=Ce.edgeRelationModal,at=Ce.closeEdgeRelationModal,ke=Ce.isFocusMode,Xe=Ce.exitFocusMode;zt({graph:g.current,handleContextMenu:be,hideContextMenu:Le,handleDoubleClick:M,handleEdgeClick:qe,hideEdgeContextMenu:Ue});var Ae=function(){K(function(u){var L=oe(u);L&&(E(!1),y(""))})},et=function(){var u=$();S(u),j(!0)},Ee=function(u){var L=typeof u=="string"?u:l,H=oe(L);H&&(E(!1),y(""))},Oe=function(){if(confirm("\u786E\u5B9A\u8981\u6E05\u7A7A\u753B\u5E03\u5417\uFF1F\u6240\u6709\u672A\u4FDD\u5B58\u7684\u5185\u5BB9\u5C06\u4E22\u5931\u3002")){var u;(u=g.current)===null||u===void 0||u.clearCells(),V(),console.log("\u753B\u5E03\u5DF2\u91CD\u7F6E")}},w=function(){g.current&&g.current.toPNG(function(u){var L=document.createElement("a");L.download="docker-compose-diagram.png",L.href=u,L.click()},{backgroundColor:"#f5f5f5",padding:20})},C=function(){g.current&&g.current.toSVG(function(u){var L=document.createElement("a");L.download="docker-compose-diagram.svg",L.href=u,L.click()},{preserveDimensions:!0})},R=function(){if(g.current){var u=g.current.toJSON(),L=JSON.stringify(u,null,2),H=new Blob([L],{type:"application/json"}),je=URL.createObjectURL(H),we=document.createElement("a");we.download="docker-compose-diagram.json",we.href=je,we.click(),URL.revokeObjectURL(je)}},Z=function(){g.current&&g.current.zoomToFit({padding:20,maxScale:1})},Fe=function(){g.current&&g.current.centerContent()},Ke=function(){if(g.current){var u=g.current.zoom();u<2&&g.current.zoom(.1)}},tt=function(){if(g.current){var u=g.current.zoom();u>.2&&g.current.zoom(-.1)}},Be=function(){g.current&&g.current.zoomTo(1)},Ze=function(){if(g.current){var u=re==="manhattan"?"smooth":"manhattan";ee(u);var L=g.current.getEdges();L.forEach(function(H){u==="smooth"?(H.setRouter({name:"normal"}),H.setConnector({name:"smooth"})):(H.setRouter({name:"manhattan",args:{padding:1,step:10}}),H.setConnector({name:"normal"}))})}};return(0,m.useEffect)(function(){if(!(!e.current||!a.current||!o.current)){yt();var p=e.current.clientWidth||window.innerWidth-180,u=e.current.clientHeight||window.innerHeight-125,L=jt(e.current,o.current,p,u),H=new ae.kJ(L);g.current=H,me();var je=new ae.e9.tb({title:"\u6D41\u7A0B\u56FE",target:H,stencilGraphWidth:200,stencilGraphHeight:180,collapsable:!0,groups:[{title:"\u57FA\u7840\u6D41\u7A0B\u56FE",name:"group1"},{title:"\u7CFB\u7EDF\u8BBE\u8BA1\u56FE",name:"group2",graphHeight:250,layoutOptions:{rowHeight:70}}],layoutOptions:{columns:2,columnWidth:80,rowHeight:55}});H.on("selection:changed",function(Ge){var Gt=Ge.added,ut=Ge.removed,Me=H.getSelectedCells();ut.forEach(function(ie){ie.isEdge()&&ie.removeTools()}),H.getEdges().forEach(function(ie){var Ne,Je,lt=ie.getData()||{},Kt=lt.originalStroke||(((Ne=ie.getTargetNode())===null||Ne===void 0?void 0:Ne.shape)==="network-router"?"#28a745":"#6c757d"),Zt=lt.originalWidth||(((Je=ie.getTargetNode())===null||Je===void 0?void 0:Je.shape)==="network-router"?3:2);ie.attr({line:{strokeWidth:Zt,stroke:Kt}})});var Jt=Me.filter(function(ie){return ie.isEdge()});if(Jt.forEach(function(ie){ie.attr({line:{strokeWidth:4,stroke:"#ff6b35"}}),ie.addTools([{name:"vertices",args:{attrs:{fill:"#ff6b35",stroke:"#fff","stroke-width":2},snapRadius:20}},{name:"segments",args:{threshold:30,attrs:{width:24,height:10,x:-12,y:-5,rx:5,ry:5,fill:"#ff6b35",stroke:"#fff","stroke-width":2}}},{name:"source-arrowhead",args:{attrs:{fill:"#28a745",stroke:"#fff","stroke-width":3,cursor:"move",d:"M 12 -10 -12 0 12 10 Z"}}},{name:"target-arrowhead",args:{attrs:{fill:"#dc3545",stroke:"#fff","stroke-width":3,cursor:"move",d:"M -12 -10 12 0 -12 10 Z"}}},{name:"button-remove",args:{distance:30,markup:[{tagName:"circle",selector:"button",attrs:{r:10,stroke:"#dc3545","stroke-width":3,fill:"#fff",cursor:"pointer"}},{tagName:"text",textContent:"\u2715",selector:"icon",attrs:{fill:"#dc3545","font-size":14,"text-anchor":"middle","pointer-events":"none",y:"0.3em","font-weight":"bold"}}]}}])}),Me.length>0){var st=Me.filter(function(ie){return ie.isNode()}),Vt=Me.filter(function(ie){return ie.isEdge()}),$e=Ve(Me),Ut=$e.filter(function(ie){return ie.isNode()}),Xt=$e.filter(function(ie){return ie.isEdge()});console.log("\u9009\u62E9\u53D8\u5316: \u76F4\u63A5\u9009\u4E2D ".concat(Me.length," \u4E2A\u5143\u7D20\uFF0C\u5305\u542BaddChild\u5173\u7CFB\u540E ").concat($e.length," \u4E2A\u5143\u7D20"),{\u76F4\u63A5\u9009\u4E2D:{\u603B\u8BA1:Me.length,\u8282\u70B9:st.length,\u8FB9:Vt.length},\u5305\u542B\u5B50\u8282\u70B9\u540E:{\u603B\u8BA1:$e.length,\u8282\u70B9:Ut.length,\u8FB9:Xt.length},\u64CD\u4F5C:{\u65B0\u589E:Gt.length,\u79FB\u9664:ut.length}}),st.forEach(function(ie){var Ne=ie.getChildren();Ne&&Ne.length>0&&console.log("\u8282\u70B9 ".concat(ie.id," \u6709 ").concat(Ne.length," \u4E2A\u5B50\u8282\u70B9:"),Ne.map(function(Je){return Je.id}))})}});var we={groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]};ae.kJ.registerNode("custom-rect",{inherit:"rect",width:66,height:36,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF"},text:{fontSize:12,fill:"#262626"}},ports:c()({},we)},!0),ae.kJ.registerNode("custom-polygon",{inherit:"polygon",width:66,height:36,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF"},text:{fontSize:12,fill:"#262626"}},ports:c()(c()({},we),{},{items:[{group:"top"},{group:"bottom"}]})},!0),ae.kJ.registerNode("custom-circle",{inherit:"circle",width:45,height:45,attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#EFF4FF"},text:{fontSize:12,fill:"#262626"}},ports:c()({},we)},!0),ae.kJ.registerNode("custom-image",{inherit:"rect",width:52,height:52,markup:[{tagName:"rect",selector:"body"},{tagName:"image"},{tagName:"text",selector:"label"}],attrs:{body:{stroke:"#5F95FF",fill:"#5F95FF"},image:{width:26,height:26,refX:13,refY:16},label:{refX:3,refY:2,textAnchor:"left",textVerticalAnchor:"top",fontSize:12,fill:"#fff"}},ports:c()({},we)},!0);var Re=H.createNode({shape:"custom-rect",label:"\u5F00\u59CB",attrs:{body:{rx:20,ry:26}}}),Ye=H.createNode({shape:"custom-rect",label:"\u8FC7\u7A0B"}),He=H.createNode({shape:"custom-rect",attrs:{body:{rx:6,ry:6}},label:"\u53EF\u9009\u8FC7\u7A0B"}),rt=H.createNode({shape:"custom-polygon",attrs:{body:{refPoints:"0,10 10,0 20,10 10,20"}},label:"\u51B3\u7B56"}),Pt=H.createNode({shape:"custom-polygon",attrs:{body:{refPoints:"10,0 40,0 30,20 0,20"}},label:"\u6570\u636E"}),Lt=H.createNode({shape:"custom-circle",label:"\u8FDE\u63A5"});je.load([Re,Ye,He,rt,Pt,Lt],"group1");var Ot=[{label:"Client",image:"https://gw.alipayobjects.com/zos/bmw-prod/687b6cb9-4b97-42a6-96d0-34b3099133ac.svg"},{label:"Http",image:"https://gw.alipayobjects.com/zos/bmw-prod/dc1ced06-417d-466f-927b-b4a4d3265791.svg"},{label:"Api",image:"https://gw.alipayobjects.com/zos/bmw-prod/c55d7ae1-8d20-4585-bd8f-ca23653a4489.svg"},{label:"Sql",image:"https://gw.alipayobjects.com/zos/bmw-prod/6eb71764-18ed-4149-b868-53ad1542c405.svg"},{label:"Cloud",image:"https://gw.alipayobjects.com/zos/bmw-prod/c36fe7cb-dc24-4854-aeb5-88d8dc36d52e.svg"},{label:"Mq",image:"https://gw.alipayobjects.com/zos/bmw-prod/2010ac9f-40e7-49d4-8c4a-4fcf2f83033b.svg"}],Yt=Ot.map(function(Ge){return H.createNode({shape:"custom-image",label:Ge.label,attrs:{image:{"xlink:href":Ge.image}}})});je.load(Yt,"group2");var Ht=new kt(H);return f(Ht),function(){document.removeEventListener("click",Le),H.dispose()}}},[]),(0,m.useEffect)(function(){g.current&&me()},[me]),(0,m.useEffect)(function(){if(s&&g.current&&!N.current){N.current=!0;var p=setTimeout(function(){Ae()},100);return function(){return clearTimeout(p)}}},[s,Ae]),(0,t.jsxs)("div",{className:"app",children:[(0,t.jsx)("div",{ref:a,className:"stencil-container"}),(0,t.jsx)("div",{className:"app-content",ref:e}),(0,t.jsx)("div",{ref:o,className:"minimap-container"}),ke&&(0,t.jsx)("button",{onClick:Xe,style:{position:"fixed",bottom:"30px",left:"50%",transform:"translateX(-50%)",padding:"12px 24px",borderRadius:"24px",backgroundColor:"#ff4d4f",color:"white",border:"none",fontSize:"16px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 16px rgba(255, 77, 79, 0.4)",transition:"all 0.3s ease",zIndex:1002,display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:function(u){u.currentTarget.style.transform="translateX(-50%) scale(1.05)",u.currentTarget.style.backgroundColor="#cf1322"},onMouseLeave:function(u){u.currentTarget.style.transform="translateX(-50%) scale(1)",u.currentTarget.style.backgroundColor="#ff4d4f"},title:"\u9000\u51FA\u805A\u7126\u6A21\u5F0F\uFF0C\u663E\u793A\u6240\u6709\u5143\u7D20",children:"\u21A9\uFE0F \u9000\u51FA\u805A\u7126\u6A21\u5F0F"}),(0,t.jsx)("button",{onClick:function(){return G(!Q)},style:{position:"fixed",top:"20px",right:"20px",width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#ffc107",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(255, 193, 7, 0.4)",transition:"all 0.3s ease",zIndex:1001},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#e0a800"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#ffc107"},title:Q?"\u5C55\u5F00\u5DE5\u5177\u680F":"\u6298\u53E0\u5DE5\u5177\u680F",children:Q?"\u2630":"\u2715"}),(0,t.jsxs)("div",{style:{position:"fixed",top:"20px",right:"80px",display:Q?"none":"flex",gap:"10px",zIndex:1e3},children:[(0,t.jsx)("button",{onClick:function(){return E(!0)},style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#17a2b8",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(23, 162, 184, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#138496"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#17a2b8"},title:"\u5BFC\u5165Docker Compose",children:"\u{1F4E4}"}),(0,t.jsx)("button",{onClick:et,style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#28a745",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(40, 167, 69, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#1e7e34"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#28a745"},title:"\u5BFC\u51FADocker Compose YAML",children:"\u{1F4C1}"}),(0,t.jsx)("button",{onClick:w,style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#6f42c1",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(111, 66, 193, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a32a3"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6f42c1"},title:"\u5BFC\u51FA\u4E3A PNG \u56FE\u7247",children:"\u{1F5BC}\uFE0F"}),(0,t.jsx)("button",{onClick:function(){return D(!0)},style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#007bff",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(0, 123, 255, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#0056b3"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#007bff"},title:"Docker\u914D\u7F6E",children:"\u{1F433}"}),(0,t.jsx)("button",{onClick:Oe,style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#dc3545",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(220, 53, 69, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#c82333"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#dc3545"},title:"\u91CD\u7F6E\u753B\u5E03\uFF08\u6E05\u7A7A\u6240\u6709\u5185\u5BB9\uFF09",children:"\u{1F504}"}),(0,t.jsx)("button",{onClick:Ze,style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:re==="manhattan"?"#fd7e14":"#20c997",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:re==="manhattan"?"0 4px 12px rgba(253, 126, 20, 0.3)":"0 4px 12px rgba(32, 201, 151, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor=re==="manhattan"?"#e8590c":"#1aa179"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor=re==="manhattan"?"#fd7e14":"#20c997"},title:re==="manhattan"?"\u5207\u6362\u5230\u66F2\u7EBF":"\u5207\u6362\u5230\u76F4\u89D2\u8FDE\u7EBF",children:re==="manhattan"?"\u{1F4D0}":"\u3030\uFE0F"})]}),(0,t.jsxs)("div",{style:{position:"fixed",top:"100px",right:"80px",display:Q?"none":"flex",gap:"10px",zIndex:1e3},children:[(0,t.jsx)("button",{onClick:Ke,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"20px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u653E\u5927",children:"\u2795"}),(0,t.jsx)("button",{onClick:tt,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"20px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u7F29\u5C0F",children:"\u2796"}),(0,t.jsx)("button",{onClick:Be,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"16px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u91CD\u7F6E\u7F29\u653E (100%)",children:"1:1"}),(0,t.jsx)("button",{onClick:Z,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"20px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u7F29\u653E\u5230\u5408\u9002\u5927\u5C0F",children:"\u{1F50D}"}),(0,t.jsx)("button",{onClick:Fe,style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#6c757d",color:"white",border:"none",fontSize:"20px",cursor:"pointer",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",transition:"all 0.3s ease"},onMouseEnter:function(u){u.currentTarget.style.transform="scale(1.1)",u.currentTarget.style.backgroundColor="#5a6268"},onMouseLeave:function(u){u.currentTarget.style.transform="scale(1)",u.currentTarget.style.backgroundColor="#6c757d"},title:"\u5C45\u4E2D\u663E\u793A",children:"\u{1F3AF}"})]}),x&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"600px",maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",padding:"20px",position:"relative"},children:[(0,t.jsx)("button",{onClick:function(){return D(!1)},style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"\xD7"}),s?(0,t.jsx)(bt,{dockerFactory:s,onClose:function(){return D(!1)}}):(0,t.jsx)("div",{style:{color:"#666",textAlign:"center",padding:"50px"},children:"\u6B63\u5728\u521D\u59CB\u5316..."})]})}),A&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"800px",maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",padding:"20px",position:"relative"},children:[(0,t.jsx)("button",{onClick:function(){return j(!1)},style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"\xD7"}),(0,t.jsx)("h2",{style:{margin:"0 0 20px 0",color:"#333"},children:"\u{1F4C1} \u5BFC\u51FA Docker Compose"}),(0,t.jsxs)("div",{style:{marginBottom:"20px",display:"flex",gap:"10px"},children:[(0,t.jsx)("button",{onClick:function(){navigator.clipboard.writeText(h),console.log("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")},style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\u{1F4CB} \u590D\u5236\u5230\u526A\u8D34\u677F"}),(0,t.jsx)("button",{onClick:function(){var u=new Blob([h],{type:"text/yaml"}),L=URL.createObjectURL(u),H=document.createElement("a");H.href=L,H.download="docker-compose.yml",H.click(),URL.revokeObjectURL(L)},style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\u{1F4BE} \u4E0B\u8F7D\u6587\u4EF6"})]}),(0,t.jsx)("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:"4px",padding:"15px",fontFamily:'Monaco, Consolas, "Courier New", monospace',fontSize:"14px",lineHeight:"1.5",whiteSpace:"pre-wrap",wordBreak:"break-all",maxHeight:"500px",overflow:"auto",color:"#333"},children:h})]})}),U&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"800px",maxWidth:"90vw",maxHeight:"90vh",overflowY:"auto",padding:"20px",position:"relative"},children:[(0,t.jsx)("button",{onClick:function(){E(!1),y("")},style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"\xD7"}),(0,t.jsx)("h2",{style:{margin:"0 0 20px 0",color:"#333"},children:"\u{1F4E4} \u5BFC\u5165 Docker Compose"}),(0,t.jsx)("p",{style:{color:"#666",marginBottom:"15px"},children:"\u8BF7\u7C98\u8D34\u60A8\u7684 docker-compose.yml \u5185\u5BB9\u5230\u4E0B\u65B9\u6587\u672C\u6846\u4E2D\uFF0C\u7136\u540E\u70B9\u51FB\u5BFC\u5165\u6309\u94AE\u3002"}),(0,t.jsxs)("div",{style:{marginBottom:"15px",display:"flex",gap:"10px",alignItems:"center"},children:[(0,t.jsx)("button",{onClick:function(){var u=`version: "3.8"
services:
  redis-master:
    image: redis:7-alpine
    command: redis-server --port 6379
    ports:
      - "6379:6379"
    volumes:
      - redis-master-data:/data
    networks:
      redis-cluster:
        ipv4_address: 172.20.0.10
    restart: unless-stopped

  redis-slave-1:
    image: redis:7-alpine
    command: redis-server --port 6380 --replicaof redis-master 6379
    ports:
      - "6380:6380"
    volumes:
      - redis-slave1-data:/data
    networks:
      redis-cluster:
        ipv4_address: 172.20.0.11
    depends_on:
      - redis-master
    restart: unless-stopped

  redis-slave-2:
    image: redis:7-alpine
    command: redis-server --port 6381 --replicaof redis-master 6379
    ports:
      - "6381:6381"
    volumes:
      - redis-slave2-data:/data
    networks:
      redis-cluster:
        ipv4_address: 172.20.0.12
    depends_on:
      - redis-master
    restart: unless-stopped

networks:
  redis-cluster:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/16
          gateway: 172.20.0.1

volumes:
  redis-master-data:
  redis-slave1-data:
  redis-slave2-data:`;y(u)},style:{padding:"6px 12px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\u{1F4DD} \u4F7F\u7528 Redis \u96C6\u7FA4\u793A\u4F8B"}),(0,t.jsx)("span",{style:{fontSize:"12px",color:"#999"},children:"\u70B9\u51FB\u540E\u4F1A\u586B\u5165\u4E00\u4E2A\u5B8C\u6574\u7684 Redis \u4E3B\u4ECE\u914D\u7F6E\u793A\u4F8B"})]}),(0,t.jsx)("textarea",{value:l,onChange:function(u){return y(u.target.value)},placeholder:"\u8BF7\u5728\u6B64\u5904\u7C98\u8D34 docker-compose.yml \u5185\u5BB9...",style:{width:"100%",height:"400px",padding:"15px",border:"1px solid #e9ecef",borderRadius:"4px",fontFamily:'Monaco, Consolas, "Courier New", monospace',fontSize:"14px",lineHeight:"1.5",resize:"vertical",outline:"none",marginBottom:"20px"}}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,t.jsx)("button",{onClick:function(){E(!1),y("")},style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\u53D6\u6D88"}),(0,t.jsx)("button",{onClick:Ee,disabled:!l.trim(),style:{padding:"8px 16px",backgroundColor:l.trim()?"#17a2b8":"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:l.trim()?"pointer":"not-allowed"},children:"\u{1F680} \u5BFC\u5165"})]}),(0,t.jsxs)("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"4px",fontSize:"12px",color:"#666"},children:[(0,t.jsx)("strong",{children:"\u2728 \u667A\u80FD\u5BFC\u5165\u529F\u80FD\uFF1A"}),(0,t.jsxs)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u670D\u52A1\u67B6\u6784\uFF1A"})," \u81EA\u52A8\u521B\u5EFA\u5BB9\u5668\u8282\u70B9\uFF0C\u6E05\u6670\u5C55\u793A\u670D\u52A1\u540D\u3001\u955C\u50CF\u3001\u547D\u4EE4"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u7AEF\u53E3\u6620\u5C04\uFF1A"})," \u53EF\u89C6\u5316\u663E\u793A\u7AEF\u53E3\u914D\u7F6E\uFF0C\u652F\u6301\u591A\u7AEF\u53E3"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u5377\u6302\u8F7D\uFF1A"})," \u76F4\u89C2\u5C55\u793A\u6570\u636E\u5377\u6302\u8F7D\u5173\u7CFB"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u7F51\u7EDC\u62D3\u6251\uFF1A"})," \u81EA\u52A8\u521B\u5EFA\u4EA4\u6362\u673A\uFF0C\u5C55\u793A\u7F51\u7EDC\u8FDE\u63A5\u7ED3\u6784"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u667A\u80FD\u5E03\u5C40\uFF1A"})," \u81EA\u52A8\u6392\u5217\u5BB9\u5668\uFF0C\u907F\u514D\u91CD\u53E0\uFF0C\u652F\u6301\u4F9D\u8D56\u5173\u7CFB"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"\u914D\u7F6E\u5B8C\u6574\uFF1A"})," \u5305\u542B\u73AF\u5883\u53D8\u91CF\u3001\u91CD\u542F\u7B56\u7565\u3001\u542F\u52A8\u547D\u4EE4\u7B49"]})]}),(0,t.jsxs)("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#e8f5e8",borderRadius:"3px"},children:["\u{1F4A1} ",(0,t.jsx)("strong",{children:"\u63D0\u793A\uFF1A"})," \u5BFC\u5165\u540E\u53EF\u5728\u753B\u5E03\u4E0A\u624B\u52A8\u8C03\u6574\u5E03\u5C40\uFF0C\u8FDE\u63A5\u7F51\u7EDC\u63A5\u53E3\u5230\u4EA4\u6362\u673A"]})]})]})}),_e&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"500px",maxWidth:"90vw",padding:"20px",position:"relative"},children:[(0,t.jsx)("button",{onClick:function(){return De(!1)},style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:"\xD7"}),(0,t.jsx)("h2",{style:{margin:"0 0 20px 0",color:"#333"},children:"\u{1F310} \u6DFB\u52A0\u7F51\u7EDC\u63A5\u53E3"}),(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u63A5\u53E3\u540D\u79F0\uFF1A"}),(0,t.jsx)("input",{type:"text",value:O.interfaceName,onChange:function(u){return Se(function(L){return c()(c()({},L),{},{interfaceName:u.target.value})})},placeholder:"\u4F8B\u5982: eth0, eth1",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})]}),(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u8FDE\u63A5\u5230\u4EA4\u6362\u673A\uFF1A"}),(0,t.jsxs)("select",{value:O.switchName,onChange:function(u){return Se(function(L){return c()(c()({},L),{},{switchName:u.target.value})})},style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"},children:[(0,t.jsx)("option",{value:"",children:"\u8BF7\u9009\u62E9\u4EA4\u6362\u673A"}),(r=g.current)===null||r===void 0?void 0:r.getNodes().filter(function(p){return p.shape==="network-switch"}).map(function(p){var u=p.getData()||{},L=p.attr("text/text"),H=u.switchName||(typeof L=="string"?L.split(`
`)[0]:"switch");return(0,t.jsx)("option",{value:H,children:H},p.id)}),(0,t.jsx)("option",{value:"new-switch",children:"+ \u521B\u5EFA\u65B0\u4EA4\u6362\u673A"})]})]}),O.switchName==="new-switch"&&(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u65B0\u4EA4\u6362\u673A\u540D\u79F0\uFF1A"}),(0,t.jsx)("input",{type:"text",placeholder:"\u4F8B\u5982: switch1, redis-net",onChange:function(u){return Se(function(L){return c()(c()({},L),{},{switchName:u.target.value})})},style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})]}),(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"IP\u914D\u7F6E\uFF1A"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,t.jsx)("input",{type:"radio",name:"ipConfig",value:"dynamic",checked:O.ipConfig==="dynamic",onChange:function(u){return Se(function(L){return c()(c()({},L),{},{ipConfig:u.target.value,staticIP:""})})},style:{marginRight:"5px"}}),"\u52A8\u6001\u5206\u914D (DHCP)"]}),(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,t.jsx)("input",{type:"radio",name:"ipConfig",value:"static",checked:O.ipConfig==="static",onChange:function(u){return Se(function(L){return c()(c()({},L),{},{ipConfig:u.target.value})})},style:{marginRight:"5px"}}),"\u9759\u6001IP"]})]})]}),O.ipConfig==="static"&&(0,t.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u9759\u6001IP\u5730\u5740\uFF1A"}),(0,t.jsx)("input",{type:"text",value:O.staticIP,onChange:function(u){return Se(function(L){return c()(c()({},L),{},{staticIP:u.target.value})})},placeholder:"\u4F8B\u5982: 172.20.0.100",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,t.jsx)("button",{onClick:function(){return De(!1)},style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"\u53D6\u6D88"}),(0,t.jsx)("button",{onClick:function(){if(!O.interfaceName.trim()){alert("\u8BF7\u8F93\u5165\u63A5\u53E3\u540D\u79F0");return}if(!O.switchName.trim()){alert("\u8BF7\u9009\u62E9\u6216\u8F93\u5165\u4EA4\u6362\u673A\u540D\u79F0");return}if(O.ipConfig==="static"&&!O.staticIP.trim()){alert("\u8BF7\u8F93\u5165\u9759\u6001IP\u5730\u5740");return}var u=(xe==null?void 0:xe.getChildren())||[],L=u.filter(function(Re){return Re.shape==="docker-network"}).map(function(Re){var Ye,He,rt=Re.getData()||{};return((Ye=rt.networkInterface)===null||Ye===void 0?void 0:Ye.interfaceName)||((He=Re.attr("text/text"))===null||He===void 0?void 0:He.split(`
`)[0])||""});if(L.includes(O.interfaceName)){alert('\u63A5\u53E3\u540D "'.concat(O.interfaceName,'" \u5DF2\u5B58\u5728\uFF0C\u8BF7\u4F7F\u7528\u5176\u4ED6\u540D\u79F0'));return}if(s&&xe){var H=s.addNetworkToContainer(xe,O.interfaceName,O.switchName),je={interfaceName:O.interfaceName,switchName:O.switchName,ipConfig:O.ipConfig,staticIP:O.ipConfig==="static"?O.staticIP:void 0};H.setData({networkInterface:je,isConnected:!1});var we=O.ipConfig==="static"&&O.staticIP?"".concat(O.interfaceName,`
`).concat(O.staticIP):"".concat(O.interfaceName,`
dynamic`);H.attr("text/text",we),setTimeout(function(){s.manualConnectNetworkToSwitch&&s.manualConnectNetworkToSwitch(H.id,O.switchName)},100),console.log("\u6DFB\u52A0\u7F51\u7EDC\u63A5\u53E3: ".concat(O.interfaceName," -> ").concat(O.switchName))}De(!1)},disabled:!O.interfaceName.trim()||!O.switchName.trim(),style:{padding:"8px 16px",backgroundColor:!O.interfaceName.trim()||!O.switchName.trim()?"#6c757d":"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:!O.interfaceName.trim()||!O.switchName.trim()?"not-allowed":"pointer"},children:"\u{1F680} \u521B\u5EFA\u7F51\u7EDC\u63A5\u53E3"})]})]})}),ce.visible&&(0,t.jsxs)("div",{style:{position:"fixed",left:ce.x,top:ce.y,backgroundColor:"white",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)",zIndex:1e3,minWidth:"150px"},children:[ce.nodeType==="container"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",borderBottom:"1px solid #f0f0f0"},onClick:function(){return pe("add-port")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F50C} \u6DFB\u52A0\u7AEF\u53E3"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",borderBottom:"1px solid #f0f0f0"},onClick:function(){return pe("add-volume")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F4BE} \u6DFB\u52A0\u5377"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",borderBottom:"1px solid #f0f0f0"},onClick:function(){return pe("add-network")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F310} \u6DFB\u52A0\u7F51\u7EDC"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",borderBottom:"1px solid #f0f0f0"},onClick:function(){return pe("add-dns")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F50D} \u6DFB\u52A0DNS"}),(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px"},onClick:function(){return pe("add-user")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F464} \u6DFB\u52A0\u7528\u6237"})]}),ce.nodeType==="component"&&(0,t.jsx)("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:"14px",color:"#ff4d4f"},onClick:function(){return pe("delete-component")},onMouseEnter:function(u){return u.currentTarget.style.backgroundColor="#fff2f0"},onMouseLeave:function(u){return u.currentTarget.style.backgroundColor="white"},children:"\u{1F5D1}\uFE0F \u5220\u9664\u7EC4\u4EF6"})]}),(0,t.jsx)(Ct,{contextMenu:Qe,onMenuItemClick:ze,onHide:Ue})]})},Wt=Rt}}]);
