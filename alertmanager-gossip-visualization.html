<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alertmanager Gossip é›†ç¾¤ç«¯å£é€šä¿¡å¯è§†åŒ–</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 15px;
            font-size: 32px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 16px;
        }

        /* é›†ç¾¤å¯è§†åŒ–å®¹å™¨ */
        .cluster-visualization {
            position: relative;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 60px 40px;
            min-height: 600px;
        }

        /* èŠ‚ç‚¹å®¹å™¨ */
        .node {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .node.node-A {
            left: 50%;
            top: 80px;
            transform: translateX(-50%);
        }

        .node.node-B {
            left: 15%;
            bottom: 120px;
        }

        .node.node-C {
            right: 15%;
            bottom: 120px;
        }

        /* ç¨‹åºä¸»ä½“ */
        .program-box {
            background: white;
            border: 3px solid #667eea;
            border-radius: 12px;
            padding: 20px 40px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .node-A .program-box { border-color: #667eea; }
        .node-B .program-box { border-color: #f093fb; }
        .node-C .program-box { border-color: #4facfe; }

        .node-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .program-name {
            font-size: 16px;
            color: #666;
            font-family: 'Courier New', monospace;
        }

        /* ç«¯å£Cell */
        .port-cell {
            background: linear-gradient(135deg, #48bb78, #38a169);
            border-radius: 10px;
            padding: 15px 25px;
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            min-width: 200px;
            text-align: center;
        }

        .port-cell.cluster {
            background: linear-gradient(135deg, #ed8936, #c05621);
        }

        .port-number {
            font-size: 24px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            margin-bottom: 8px;
        }

        .port-config {
            font-size: 11px;
            opacity: 0.95;
            font-family: 'Courier New', monospace;
            line-height: 1.4;
            border-top: 1px solid rgba(255,255,255,0.3);
            padding-top: 8px;
            margin-top: 8px;
        }


        /* SVGè¿æ¥çº¿ */
        .connections {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .connection-line {
            fill: none;
            stroke-width: 3;
        }

        .cluster-line {
            stroke: #ed8936;
            stroke-width: 4;
            stroke-dasharray: 8,4;
        }

        /* åŠ¨ç”» */
        @keyframes flow {
            0% { stroke-dashoffset: 0; }
            100% { stroke-dashoffset: 12; }
        }

        .cluster-line {
            animation: flow 1.5s linear infinite;
        }

        /* å›¾ä¾‹ */
        .legend {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            padding: 25px;
            background: #fff3cd;
            border-radius: 10px;
            border: 2px solid #ffc107;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .legend-line {
            width: 50px;
            height: 4px;
            border-radius: 2px;
        }

        .legend-line.cluster {
            background: #ed8936;
            background-image: repeating-linear-gradient(
                90deg,
                #ed8936,
                #ed8936 8px,
                transparent 8px,
                transparent 12px
            );
        }

        .legend-text {
            font-size: 14px;
            font-weight: bold;
            color: #333;
        }

        /* è¯´æ˜åŒºåŸŸ */
        .info-section {
            margin-top: 30px;
            padding: 25px;
            background: #e8f4f8;
            border-left: 5px solid #667eea;
            border-radius: 10px;
        }

        .info-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .info-section ul {
            list-style: none;
            padding-left: 0;
        }

        .info-section li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            line-height: 1.6;
        }

        .info-section li::before {
            content: 'â†’';
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
        }

        /* Peeré…ç½®æ ‡æ³¨ */
        .peer-label {
            position: absolute;
            background: white;
            border: 2px solid #e53e3e;
            border-radius: 6px;
            padding: 8px 12px;
            font-size: 11px;
            font-family: 'Courier New', monospace;
            color: #e53e3e;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Alertmanager Gossip é›†ç¾¤ç«¯å£é€šä¿¡å¯è§†åŒ–</h1>
        <p class="subtitle">é…ç½®é€‰é¡¹ç›´æ¥å†™åœ¨ç«¯å£ä¸Š | ç«¯å£é€šè¿‡ç®­å¤´è¿æ¥é€šä¿¡ | Node B/Cé€šè¿‡peerè¿æ¥Node A</p>

        <!-- ä¸»å¯è§†åŒ–åŒºåŸŸ -->
        <div class="cluster-visualization">
            <!-- SVGè¿æ¥çº¿ -->
            <svg class="connections">
                <defs>
                    <!-- ç®­å¤´å®šä¹‰ -->
                    <marker id="arrow-orange" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
                        <polygon points="0 0, 10 5, 0 10" fill="#ed8936" />
                    </marker>
                </defs>

                <!-- Node A Clusterç«¯å£ <-> Node B Clusterç«¯å£ -->
                <path d="M 48% 35% Q 30% 50%, 25% 72%"
                      class="connection-line cluster-line"
                      marker-end="url(#arrow-orange)" />
                <path d="M 25% 75% Q 30% 52%, 48% 38%"
                      class="connection-line cluster-line"
                      marker-end="url(#arrow-orange)" />

                <!-- Node A Clusterç«¯å£ <-> Node C Clusterç«¯å£ -->
                <path d="M 52% 35% Q 70% 50%, 75% 72%"
                      class="connection-line cluster-line"
                      marker-end="url(#arrow-orange)" />
                <path d="M 75% 75% Q 70% 52%, 52% 38%"
                      class="connection-line cluster-line"
                      marker-end="url(#arrow-orange)" />

                <!-- Node B Clusterç«¯å£ <-> Node C Clusterç«¯å£ -->
                <line x1="30%" y1="78%" x2="70%" y2="78%"
                      class="connection-line cluster-line"
                      marker-end="url(#arrow-orange)" />
                <line x1="70%" y1="81%" x2="30%" y2="81%"
                      class="connection-line cluster-line"
                      marker-end="url(#arrow-orange)" />
            </svg>

            <!-- èŠ‚ç‚¹A -->
            <div class="node node-A">
                <div class="port-cell">
                    <div class="port-number">:9093</div>
                    <div style="font-size: 12px; opacity: 0.9;">Webç«¯å£</div>
                    <div class="port-config">
                        --web.listen-address<br>
                        0.0.0.0:9093
                    </div>
                </div>

                <div class="program-box">
                    <div class="node-title">Node A</div>
                    <div class="program-name">alertmanager</div>
                </div>

                <div class="port-cell cluster">
                    <div class="port-number">:9094</div>
                    <div style="font-size: 12px; opacity: 0.9;">Clusterç«¯å£</div>
                    <div class="port-config">
                        --cluster.listen-address<br>
                        0.0.0.0:9094
                    </div>
                </div>
            </div>

            <!-- èŠ‚ç‚¹B -->
            <div class="node node-B">
                <div class="port-cell">
                    <div class="port-number">:9093</div>
                    <div style="font-size: 12px; opacity: 0.9;">Webç«¯å£</div>
                    <div class="port-config">
                        --web.listen-address<br>
                        0.0.0.0:9093
                    </div>
                </div>

                <div class="program-box">
                    <div class="node-title">Node B</div>
                    <div class="program-name">alertmanager</div>
                </div>

                <div class="port-cell cluster">
                    <div class="port-number">:9094</div>
                    <div style="font-size: 12px; opacity: 0.9;">Clusterç«¯å£</div>
                    <div class="port-config">
                        --cluster.listen-address<br>
                        0.0.0.0:9094
                    </div>
                </div>
            </div>

            <!-- èŠ‚ç‚¹C -->
            <div class="node node-C">
                <div class="port-cell">
                    <div class="port-number">:9093</div>
                    <div style="font-size: 12px; opacity: 0.9;">Webç«¯å£</div>
                    <div class="port-config">
                        --web.listen-address<br>
                        0.0.0.0:9093
                    </div>
                </div>

                <div class="program-box">
                    <div class="node-title">Node C</div>
                    <div class="program-name">alertmanager</div>
                </div>

                <div class="port-cell cluster">
                    <div class="port-number">:9094</div>
                    <div style="font-size: 12px; opacity: 0.9;">Clusterç«¯å£</div>
                    <div class="port-config">
                        --cluster.listen-address<br>
                        0.0.0.0:9094
                    </div>
                </div>
            </div>

            <!-- Peeré…ç½®æ ‡æ³¨ -->
            <div class="peer-label" style="left: 15%; bottom: 35%;">
                --cluster.peer<br>nodeA:9094
            </div>
            <div class="peer-label" style="right: 15%; bottom: 35%;">
                --cluster.peer<br>nodeA:9094
            </div>
        </div>

        <!-- å›¾ä¾‹ -->
        <div class="legend">
            <div class="legend-item">
                <div style="width: 50px; height: 20px; background: linear-gradient(135deg, #48bb78, #38a169); border-radius: 4px;"></div>
                <span class="legend-text">Webç«¯å£ :9093 (æ¥æ”¶å‘Šè­¦)</span>
            </div>
            <div class="legend-item">
                <div class="legend-line cluster"></div>
                <span class="legend-text">Clusterç«¯å£é€šä¿¡ (:9094 â†” :9094 Gossipåè®®)</span>
            </div>
            <div class="legend-item">
                <div style="width: 50px; height: 20px; border: 2px solid #e53e3e; border-radius: 4px;"></div>
                <span class="legend-text">--cluster.peer é…ç½® (æŒ‡å®šè¿æ¥èŠ‚ç‚¹)</span>
            </div>
        </div>

        <!-- æ ¸å¿ƒè¦ç‚¹è¯´æ˜ -->
        <div class="info-section">
            <h3>ğŸ”‘ é›†ç¾¤å»ºç«‹çš„æ ¸å¿ƒè¦ç´ </h3>
            <ul>
                <li><strong>ç«¯å£ :9093 (Web)</strong>ï¼šç”± <code>--web.listen-address</code> æ‰“å¼€ï¼Œç”¨äºæ¥æ”¶å¤–éƒ¨å‘Šè­¦ï¼ˆå¦‚Prometheusï¼‰</li>
                <li><strong>ç«¯å£ :9094 (Cluster)</strong>ï¼šç”± <code>--cluster.listen-address</code> æ‰“å¼€ï¼Œç”¨äºGossipåè®®é›†ç¾¤é€šä¿¡</li>
                <li><strong>é…ç½® --cluster.peer</strong>ï¼šNode B/Cé€šè¿‡æ­¤é…ç½®æŒ‡å®šè¿æ¥Node Açš„9094ç«¯å£ï¼ˆæ ¼å¼ï¼šnodeA:9094ï¼‰ï¼Œå»ºç«‹é›†ç¾¤æ‹“æ‰‘</li>
                <li><strong>é€šä¿¡æ–¹å¼</strong>ï¼šä¸‰ä¸ªèŠ‚ç‚¹é€šè¿‡9094ç«¯å£è¿›è¡ŒåŒå‘Gossipé€šä¿¡ï¼ŒåŒæ­¥å‘Šè­¦çŠ¶æ€ã€é™é»˜è§„åˆ™ç­‰é›†ç¾¤æ•°æ®</li>
                <li><strong>é«˜å¯ç”¨</strong>ï¼šä»»æ„èŠ‚ç‚¹æ¥æ”¶çš„å‘Šè­¦ä¼šé€šè¿‡Gossipåè®®åŒæ­¥åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Œå®ç°é›†ç¾¤çº§å»é‡å’Œä¸€è‡´æ€§</li>
            </ul>
        </div>

        <!-- Gossipåè®®è¯´æ˜ -->
        <div class="info-section" style="background: #fff3cd; border-left-color: #ffc107;">
            <h3>ğŸ”„ Gossipåè®®å·¥ä½œåŸç†</h3>
            <ul>
                <li><strong>Push-based</strong>ï¼šèŠ‚ç‚¹ä¸»åŠ¨å‘éšæœºèŠ‚ç‚¹æ¨é€çŠ¶æ€æ›´æ–°ï¼ˆå®æ—¶æ€§é«˜ï¼Œä½†å¯èƒ½é‡å¤ï¼‰</li>
                <li><strong>Pull-based</strong>ï¼šèŠ‚ç‚¹å®šæœŸä»éšæœºèŠ‚ç‚¹æ‹‰å–æœ€æ–°çŠ¶æ€ï¼ˆé¿å…é‡å¤ï¼Œä½†å®æ—¶æ€§ç¨å·®ï¼‰</li>
                <li><strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ï¼šé€šè¿‡èŠ‚ç‚¹é—´æŒç»­çš„çŠ¶æ€äº¤æ¢ï¼Œæœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹è¾¾åˆ°ä¸€è‡´çŠ¶æ€</li>
                <li><strong>å»ä¸­å¿ƒåŒ–</strong>ï¼šæ— éœ€ä¸­å¿ƒèŠ‚ç‚¹åè°ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹åœ°ä½å¹³ç­‰ï¼Œæ•…éšœå®¹å¿åº¦é«˜</li>
                <li><strong>ç«¯å£ :9094</strong>ï¼šæ‰€æœ‰Gossipé€šä¿¡éƒ½é€šè¿‡æ­¤ç«¯å£è¿›è¡Œï¼Œæ˜¯é›†ç¾¤çš„"ç¥ç»ç½‘ç»œ"</li>
            </ul>
        </div>
    </div>

    <script>
        // å¯é€‰ï¼šæ·»åŠ äº¤äº’æ•ˆæœ
        const portCells = document.querySelectorAll('.port-cell');
        const lines = document.querySelectorAll('.connection-line');

        portCells.forEach(cell => {
            cell.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.05)';
                this.style.boxShadow = '0 6px 20px rgba(0,0,0,0.25)';
            });

            cell.addEventListener('mouseleave', function() {
                this.style.transform = '';
                this.style.boxShadow = '';
            });
        });
    </script>
</body>
</html>