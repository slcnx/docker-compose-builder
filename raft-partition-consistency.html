<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raft ç½‘ç»œåˆ†åŒºä¸‹çš„å¼ºä¸€è‡´æ€§ä¿è¯</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 15px;
            font-size: 32px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        /* CAPè¯´æ˜ */
        .cap-explanation {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .cap-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .cap-card.chosen {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }

        .cap-card.sacrificed {
            background: linear-gradient(135deg, #e53e3e, #c53030);
        }

        .cap-card h3 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .cap-card p {
            font-size: 14px;
            opacity: 0.95;
            line-height: 1.6;
        }

        /* åœºæ™¯æ§åˆ¶ */
        .scenario-control {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .scenario-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .scenario-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .scenario-btn.active {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }

        /* å¯è§†åŒ–åŒºåŸŸ */
        .visualization {
            position: relative;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 60px 40px;
            min-height: 500px;
            margin-bottom: 30px;
        }

        /* åˆ†åŒºçº¿ */
        .partition-line {
            position: absolute;
            left: 50%;
            top: 10%;
            bottom: 10%;
            width: 4px;
            background: repeating-linear-gradient(
                0deg,
                #e53e3e,
                #e53e3e 10px,
                transparent 10px,
                transparent 20px
            );
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 5;
        }

        .partition-line.show {
            opacity: 1;
        }

        .partition-label {
            position: absolute;
            left: 50%;
            top: 5%;
            transform: translateX(-50%);
            background: #e53e3e;
            color: white;
            padding: 8px 20px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 6;
        }

        .partition-label.show {
            opacity: 1;
        }

        /* åˆ†åŒºåŒºåŸŸæ ‡è¯† */
        .partition-zone {
            position: absolute;
            top: 15%;
            bottom: 15%;
            border: 3px dashed transparent;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.5s;
        }

        .partition-zone.minority {
            left: 5%;
            width: 35%;
            border-color: #e53e3e;
            background: rgba(229, 62, 62, 0.05);
        }

        .partition-zone.majority {
            right: 5%;
            width: 45%;
            border-color: #48bb78;
            background: rgba(72, 187, 120, 0.05);
        }

        .partition-zone.hidden {
            border-color: transparent;
            background: transparent;
        }

        .zone-label {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: bold;
            font-size: 14px;
            padding: 5px 15px;
            border-radius: 5px;
        }

        .zone-label.minority {
            background: #e53e3e;
            color: white;
        }

        .zone-label.majority {
            background: #48bb78;
            color: white;
        }

        /* RaftèŠ‚ç‚¹ */
        .raft-node {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            transition: all 0.5s;
        }

        .node-1 { left: 15%; top: 30%; }
        .node-2 { left: 15%; bottom: 30%; }
        .node-3 { left: 50%; top: 20%; transform: translateX(-50%); }
        .node-4 { right: 20%; top: 35%; }
        .node-5 { right: 20%; bottom: 35%; }

        .node-card {
            background: white;
            border: 4px solid #667eea;
            border-radius: 12px;
            padding: 20px 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            min-width: 130px;
            transition: all 0.3s;
        }

        .node-card.leader {
            border-color: #f5c518;
            background: linear-gradient(135deg, #fff9e6, #ffffff);
            box-shadow: 0 0 30px rgba(245, 197, 24, 0.5);
        }

        .node-card.follower {
            border-color: #48bb78;
        }

        .node-card.unavailable {
            border-color: #e53e3e;
            opacity: 0.6;
            background: #fff5f5;
        }

        .node-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .node-role {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
            margin-top: 5px;
        }

        .role-leader {
            background: #f5c518;
            color: #333;
        }

        .role-follower {
            background: #d4edda;
            color: #155724;
        }

        .role-unavailable {
            background: #f8d7da;
            color: #721c24;
        }

        .crown {
            font-size: 28px;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        /* å®¢æˆ·ç«¯ */
        .client {
            position: absolute;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.5s;
        }

        .client-left {
            left: 5%;
            top: 50%;
            transform: translateY(-50%);
        }

        .client-right {
            right: 5%;
            top: 50%;
            transform: translateY(-50%);
        }

        /* è¯·æ±‚ç®­å¤´ */
        .request-arrow {
            position: absolute;
            height: 3px;
            background: #667eea;
            opacity: 0;
            transition: all 0.5s;
            z-index: 3;
        }

        .request-arrow.show {
            opacity: 1;
        }

        .request-arrow::after {
            content: '';
            position: absolute;
            right: -10px;
            top: -4px;
            width: 0;
            height: 0;
            border-left: 10px solid #667eea;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
        }

        .request-arrow.success {
            background: #48bb78;
        }

        .request-arrow.success::after {
            border-left-color: #48bb78;
        }

        .request-arrow.failed {
            background: #e53e3e;
        }

        .request-arrow.failed::after {
            border-left-color: #e53e3e;
        }

        /* å“åº”æ–‡å­— */
        .response-text {
            position: absolute;
            background: white;
            border: 2px solid;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
            opacity: 0;
            transition: all 0.5s;
            z-index: 4;
        }

        .response-text.show {
            opacity: 1;
        }

        .response-text.success {
            border-color: #48bb78;
            color: #48bb78;
        }

        .response-text.failed {
            border-color: #e53e3e;
            color: #e53e3e;
        }

        /* è¯´æ˜æ¡† */
        .explanation {
            background: #e8f4f8;
            border-left: 5px solid #667eea;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .explanation h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .explanation p {
            color: #333;
            line-height: 1.8;
            font-size: 15px;
            margin-bottom: 10px;
        }

        .explanation .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }

        /* å¯¹æ¯”è¡¨æ ¼ */
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .comparison-item {
            background: white;
            border: 3px solid;
            border-radius: 12px;
            padding: 20px;
        }

        .comparison-item.majority {
            border-color: #48bb78;
        }

        .comparison-item.minority {
            border-color: #e53e3e;
        }

        .comparison-item h4 {
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
        }

        .comparison-item ul {
            list-style: none;
            padding: 0;
        }

        .comparison-item li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            line-height: 1.6;
        }

        .comparison-item li::before {
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        .comparison-item.majority li::before {
            content: 'âœ“';
            color: #48bb78;
        }

        .comparison-item.minority li::before {
            content: 'âœ—';
            color: #e53e3e;
        }

        /* å…³é”®ç‚¹ */
        .key-points {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            border-radius: 8px;
        }

        .key-points h3 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .key-points ul {
            list-style: none;
            padding: 0;
        }

        .key-points li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
            color: #856404;
            line-height: 1.6;
        }

        .key-points li::before {
            content: 'â†’';
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        .key-points strong {
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Raftï¼šç½‘ç»œåˆ†åŒºä¸‹å¦‚ä½•ä¿è¯å¼ºä¸€è‡´æ€§ï¼Ÿ</h1>
        <p class="subtitle">CAPç†è®ºï¼šRafté€‰æ‹©CPï¼ˆä¸€è‡´æ€§+åˆ†åŒºå®¹é”™ï¼‰ï¼Œç‰ºç‰²å¯ç”¨æ€§æ¥ä¿è¯å¼ºä¸€è‡´</p>

        <!-- CAPè¯´æ˜ -->
        <div class="cap-explanation">
            <div class="cap-card chosen">
                <h3>C - ä¸€è‡´æ€§ âœ…</h3>
                <p>æ‰€æœ‰èŠ‚ç‚¹åœ¨åŒä¸€æ—¶é—´çœ‹åˆ°ç›¸åŒçš„æ•°æ®<br><strong>Raftä¿è¯å¼ºä¸€è‡´æ€§</strong></p>
            </div>
            <div class="cap-card sacrificed">
                <h3>A - å¯ç”¨æ€§ âŒ</h3>
                <p>æ¯ä¸ªè¯·æ±‚éƒ½èƒ½å¾—åˆ°å“åº”<br><strong>åˆ†åŒºæ—¶å°‘æ•°æ´¾ä¸å¯ç”¨</strong></p>
            </div>
            <div class="cap-card chosen">
                <h3>P - åˆ†åŒºå®¹é”™ âœ…</h3>
                <p>ç½‘ç»œåˆ†åŒºæ—¶ç³»ç»Ÿç»§ç»­è¿è¡Œ<br><strong>å¤šæ•°æ´¾ç»§ç»­å·¥ä½œ</strong></p>
            </div>
        </div>

        <!-- åœºæ™¯æ§åˆ¶ -->
        <div class="scenario-control">
            <button class="scenario-btn active" onclick="showScenario('normal')">æ­£å¸¸æƒ…å†µ</button>
            <button class="scenario-btn" onclick="showScenario('partition')">å‘ç”Ÿåˆ†åŒº</button>
            <button class="scenario-btn" onclick="showScenario('write-majority')">å†™å…¥å¤šæ•°æ´¾</button>
            <button class="scenario-btn" onclick="showScenario('write-minority')">å†™å…¥å°‘æ•°æ´¾</button>
            <button class="scenario-btn" onclick="showScenario('recovery')">åˆ†åŒºæ¢å¤</button>
        </div>

        <!-- å¯è§†åŒ–åŒºåŸŸ -->
        <div class="visualization" id="viz">
            <!-- åˆ†åŒºçº¿ -->
            <div class="partition-line" id="partition-line"></div>
            <div class="partition-label" id="partition-label">âš ï¸ ç½‘ç»œåˆ†åŒº</div>

            <!-- åˆ†åŒºåŒºåŸŸ -->
            <div class="partition-zone minority hidden" id="zone-minority">
                <div class="zone-label minority">å°‘æ•°æ´¾ï¼ˆ2èŠ‚ç‚¹ï¼‰<br>ä¸å¯ç”¨</div>
            </div>
            <div class="partition-zone majority hidden" id="zone-majority">
                <div class="zone-label majority">å¤šæ•°æ´¾ï¼ˆ3èŠ‚ç‚¹ï¼‰<br>å¯ç”¨</div>
            </div>

            <!-- RaftèŠ‚ç‚¹ -->
            <div class="raft-node node-1" id="node1">
                <div class="node-card follower">
                    <div class="node-title">Node 1</div>
                    <div class="node-role role-follower">Follower</div>
                </div>
            </div>

            <div class="raft-node node-2" id="node2">
                <div class="node-card follower">
                    <div class="node-title">Node 2</div>
                    <div class="node-role role-follower">Follower</div>
                </div>
            </div>

            <div class="raft-node node-3" id="node3">
                <div class="node-card leader">
                    <div class="crown">ğŸ‘‘</div>
                    <div class="node-title">Node 3</div>
                    <div class="node-role role-leader">Leader</div>
                </div>
            </div>

            <div class="raft-node node-4" id="node4">
                <div class="node-card follower">
                    <div class="node-title">Node 4</div>
                    <div class="node-role role-follower">Follower</div>
                </div>
            </div>

            <div class="raft-node node-5" id="node5">
                <div class="node-card follower">
                    <div class="node-title">Node 5</div>
                    <div class="node-role role-follower">Follower</div>
                </div>
            </div>

            <!-- å®¢æˆ·ç«¯è¯·æ±‚ç®­å¤´å’Œå“åº” -->
            <div class="request-arrow" id="arrow-left"></div>
            <div class="request-arrow" id="arrow-right"></div>
            <div class="response-text" id="response-left"></div>
            <div class="response-text" id="response-right"></div>
        </div>

        <!-- åœºæ™¯è¯´æ˜ -->
        <div class="explanation" id="explanation">
            <h3>åœºæ™¯ï¼šæ­£å¸¸æƒ…å†µï¼ˆ5èŠ‚ç‚¹é›†ç¾¤ï¼‰</h3>
            <p>
                â€¢ é›†ç¾¤æœ‰5ä¸ªèŠ‚ç‚¹ï¼Œéœ€è¦ <span class="highlight">è‡³å°‘3ä¸ªèŠ‚ç‚¹ï¼ˆ5/2+1ï¼‰</span> ç¡®è®¤æ‰èƒ½æäº¤å†™å…¥<br>
                â€¢ Node 3 æ˜¯ Leaderï¼Œè´Ÿè´£å¤„ç†æ‰€æœ‰å†™è¯·æ±‚<br>
                â€¢ æ‰€æœ‰èŠ‚ç‚¹å¯ä»¥æ­£å¸¸é€šä¿¡ï¼Œæ•°æ®å¼ºä¸€è‡´
            </p>
        </div>

        <!-- å¯¹æ¯”è¯´æ˜ -->
        <div class="comparison" id="comparison" style="display: none;">
            <div class="comparison-item majority">
                <h4>âœ… å¤šæ•°æ´¾åˆ†åŒºï¼ˆ3èŠ‚ç‚¹ï¼‰</h4>
                <ul>
                    <li>æ‹¥æœ‰3ä¸ªèŠ‚ç‚¹ï¼Œæ»¡è¶³å¤šæ•°æ´¾ (3 â‰¥ 5/2+1)</li>
                    <li>å¯ä»¥é€‰å‡ºLeaderï¼ˆNode 3ï¼‰</li>
                    <li>å¯ä»¥å¤„ç†å†™è¯·æ±‚ï¼ˆè·å¾—3ä¸ªç¡®è®¤ï¼‰</li>
                    <li>ä¿è¯å¼ºä¸€è‡´æ€§ï¼šå†™å…¥å¿…é¡»å¤šæ•°ç¡®è®¤</li>
                    <li><strong>åˆ†åŒºç»§ç»­å¯¹å¤–æä¾›æœåŠ¡</strong></li>
                </ul>
            </div>

            <div class="comparison-item minority">
                <h4>âŒ å°‘æ•°æ´¾åˆ†åŒºï¼ˆ2èŠ‚ç‚¹ï¼‰</h4>
                <ul>
                    <li>åªæœ‰2ä¸ªèŠ‚ç‚¹ï¼Œä¸æ»¡è¶³å¤šæ•°æ´¾ (2 < 5/2+1)</li>
                    <li>æ— æ³•é€‰å‡ºLeaderï¼ˆå¾—ä¸åˆ°å¤šæ•°ç¥¨ï¼‰</li>
                    <li>æ‹’ç»æ‰€æœ‰å†™è¯·æ±‚</li>
                    <li>é¿å…è„‘è£‚ï¼šé˜²æ­¢æ•°æ®ä¸ä¸€è‡´</li>
                    <li><strong>åˆ†åŒºåœæ­¢å¯¹å¤–æä¾›æœåŠ¡</strong></li>
                </ul>
            </div>
        </div>

        <!-- å…³é”®ç‚¹ -->
        <div class="key-points">
            <h3>ğŸ”‘ Raftå¦‚ä½•åœ¨åˆ†åŒºæ—¶ä¿è¯å¼ºä¸€è‡´æ€§ï¼Ÿ</h3>
            <ul>
                <li><strong>å¤šæ•°æ´¾åŸåˆ™</strong>ï¼šä»»ä½•æ“ä½œå¿…é¡»è·å¾—å¤šæ•°èŠ‚ç‚¹ï¼ˆn/2+1ï¼‰ç¡®è®¤æ‰èƒ½ç”Ÿæ•ˆ</li>
                <li><strong>Leaderåªåœ¨å¤šæ•°æ´¾</strong>ï¼šåªæœ‰æ‹¥æœ‰å¤šæ•°èŠ‚ç‚¹çš„åˆ†åŒºæ‰èƒ½é€‰å‡ºLeader</li>
                <li><strong>å°‘æ•°æ´¾æ‹’ç»æœåŠ¡</strong>ï¼šå°‘æ•°æ´¾æ— æ³•é€‰å‡ºLeaderï¼Œæ‹’ç»æ‰€æœ‰å†™è¯·æ±‚ï¼Œé¿å…è„‘è£‚</li>
                <li><strong>ç‰ºç‰²å¯ç”¨æ€§</strong>ï¼šå°‘æ•°æ´¾èŠ‚ç‚¹æš‚æ—¶ä¸å¯ç”¨ï¼Œä½†ä¿è¯äº†æ•°æ®ä¸€è‡´æ€§</li>
                <li><strong>åˆ†åŒºæ¢å¤ååŒæ­¥</strong>ï¼šç½‘ç»œæ¢å¤åï¼Œå°‘æ•°æ´¾èŠ‚ç‚¹ä»LeaderåŒæ­¥æœ€æ–°æ•°æ®</li>
                <li><strong>å¼ºä¸€è‡´ä¿è¯</strong>ï¼šä»»ä½•æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªæœ‰æ•ˆçš„Leaderï¼Œæ‰€æœ‰æäº¤çš„æ•°æ®éƒ½ç»è¿‡å¤šæ•°æ´¾ç¡®è®¤</li>
            </ul>
        </div>
    </div>

    <script>
        function showScenario(scenario) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.scenario-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // è·å–å…ƒç´ 
            const partitionLine = document.getElementById('partition-line');
            const partitionLabel = document.getElementById('partition-label');
            const zoneMinority = document.getElementById('zone-minority');
            const zoneMajority = document.getElementById('zone-majority');
            const comparison = document.getElementById('comparison');
            const explanation = document.getElementById('explanation');

            // æ¸…é™¤æ‰€æœ‰ç®­å¤´å’Œå“åº”
            document.querySelectorAll('.request-arrow, .response-text').forEach(el => {
                el.classList.remove('show', 'success', 'failed');
                el.style.cssText = '';
            });

            // åœºæ™¯é…ç½®
            const scenarios = {
                normal: {
                    title: 'åœºæ™¯ï¼šæ­£å¸¸æƒ…å†µï¼ˆ5èŠ‚ç‚¹é›†ç¾¤ï¼‰',
                    description: 'â€¢ é›†ç¾¤æœ‰5ä¸ªèŠ‚ç‚¹ï¼Œéœ€è¦ <span class="highlight">è‡³å°‘3ä¸ªèŠ‚ç‚¹ï¼ˆ5/2+1ï¼‰</span> ç¡®è®¤æ‰èƒ½æäº¤å†™å…¥<br>â€¢ Node 3 æ˜¯ Leaderï¼Œè´Ÿè´£å¤„ç†æ‰€æœ‰å†™è¯·æ±‚<br>â€¢ æ‰€æœ‰èŠ‚ç‚¹å¯ä»¥æ­£å¸¸é€šä¿¡ï¼Œæ•°æ®å¼ºä¸€è‡´',
                    partition: false,
                    comparison: false,
                    nodes: {
                        1: { role: 'follower', available: true },
                        2: { role: 'follower', available: true },
                        3: { role: 'leader', available: true },
                        4: { role: 'follower', available: true },
                        5: { role: 'follower', available: true }
                    }
                },
                partition: {
                    title: 'åœºæ™¯ï¼šå‘ç”Ÿç½‘ç»œåˆ†åŒºï¼ˆ2èŠ‚ç‚¹ vs 3èŠ‚ç‚¹ï¼‰',
                    description: 'â€¢ ç½‘ç»œæ•…éšœå¯¼è‡´é›†ç¾¤åˆ†æˆä¸¤éƒ¨åˆ†ï¼š<span class="highlight">å·¦ä¾§2èŠ‚ç‚¹</span> vs <span class="highlight">å³ä¾§3èŠ‚ç‚¹</span><br>â€¢ å·¦ä¾§å°‘æ•°æ´¾ï¼ˆ2èŠ‚ç‚¹ï¼‰ï¼šæ— æ³•é€‰å‡ºLeaderï¼Œ<span class="highlight">åœæ­¢æœåŠ¡</span><br>â€¢ å³ä¾§å¤šæ•°æ´¾ï¼ˆ3èŠ‚ç‚¹ï¼‰ï¼šé‡æ–°é€‰ä¸¾Node 3ä¸ºLeaderï¼Œ<span class="highlight">ç»§ç»­æœåŠ¡</span><br>â€¢ <strong>å…³é”®ï¼šåªæœ‰å¤šæ•°æ´¾èƒ½å·¥ä½œï¼Œä¿è¯ä¸ä¼šå‡ºç°ä¸¤ä¸ªLeaderï¼ˆè„‘è£‚ï¼‰</strong>',
                    partition: true,
                    comparison: true,
                    nodes: {
                        1: { role: 'unavailable', available: false },
                        2: { role: 'unavailable', available: false },
                        3: { role: 'leader', available: true },
                        4: { role: 'follower', available: true },
                        5: { role: 'follower', available: true }
                    }
                },
                'write-majority': {
                    title: 'åœºæ™¯ï¼šå®¢æˆ·ç«¯å†™å…¥å¤šæ•°æ´¾ï¼ˆæˆåŠŸï¼‰',
                    description: 'â€¢ å®¢æˆ·ç«¯å‘å¤šæ•°æ´¾ï¼ˆå³ä¾§ï¼‰å‘é€å†™è¯·æ±‚<br>â€¢ Leaderï¼ˆNode 3ï¼‰æ¥æ”¶è¯·æ±‚ï¼Œå¤åˆ¶åˆ°å¤šæ•°æ´¾èŠ‚ç‚¹ï¼ˆNode 4, 5ï¼‰<br>â€¢ è·å¾— <span class="highlight">3ä¸ªèŠ‚ç‚¹ç¡®è®¤ï¼ˆ3 â‰¥ 5/2+1ï¼‰</span>ï¼Œæ»¡è¶³å¤šæ•°æ´¾æ¡ä»¶<br>â€¢ <strong>å†™å…¥æˆåŠŸæäº¤ï¼Œè¿”å›æˆåŠŸå“åº”ï¼Œæ•°æ®ä¿è¯å¼ºä¸€è‡´</strong>',
                    partition: true,
                    comparison: true,
                    nodes: {
                        1: { role: 'unavailable', available: false },
                        2: { role: 'unavailable', available: false },
                        3: { role: 'leader', available: true },
                        4: { role: 'follower', available: true },
                        5: { role: 'follower', available: true }
                    },
                    arrows: {
                        right: { show: true, success: true, left: '70%', top: '50%', width: '15%' }
                    },
                    responses: {
                        right: { show: true, success: true, text: 'âœ“ å†™å…¥æˆåŠŸ', right: '10%', top: '55%' }
                    }
                },
                'write-minority': {
                    title: 'åœºæ™¯ï¼šå®¢æˆ·ç«¯å†™å…¥å°‘æ•°æ´¾ï¼ˆå¤±è´¥ï¼‰',
                    description: 'â€¢ å®¢æˆ·ç«¯å‘å°‘æ•°æ´¾ï¼ˆå·¦ä¾§ï¼‰å‘é€å†™è¯·æ±‚<br>â€¢ å°‘æ•°æ´¾åªæœ‰2ä¸ªèŠ‚ç‚¹ï¼Œ<span class="highlight">æ— æ³•é€‰å‡ºLeader</span><br>â€¢ æ— æ³•è·å¾—å¤šæ•°æ´¾ç¡®è®¤ï¼ˆ2 < 5/2+1ï¼‰<br>â€¢ <strong>æ‹’ç»å†™å…¥è¯·æ±‚ï¼Œè¿”å›å¤±è´¥å“åº”</strong><br>â€¢ <span class="highlight">å…³é”®ï¼šå®å¯æ‹’ç»æœåŠ¡ï¼ˆç‰ºç‰²å¯ç”¨æ€§ï¼‰ï¼Œä¹Ÿä¸æ¥å—å¯èƒ½ä¸ä¸€è‡´çš„æ•°æ®</span>',
                    partition: true,
                    comparison: true,
                    nodes: {
                        1: { role: 'unavailable', available: false },
                        2: { role: 'unavailable', available: false },
                        3: { role: 'leader', available: true },
                        4: { role: 'follower', available: true },
                        5: { role: 'follower', available: true }
                    },
                    arrows: {
                        left: { show: true, success: false, left: '5%', top: '50%', width: '15%' }
                    },
                    responses: {
                        left: { show: true, success: false, text: 'âœ— æ— Leaderï¼Œæ‹’ç»å†™å…¥', left: '8%', top: '45%' }
                    }
                },
                recovery: {
                    title: 'åœºæ™¯ï¼šç½‘ç»œåˆ†åŒºæ¢å¤',
                    description: 'â€¢ ç½‘ç»œæ•…éšœä¿®å¤ï¼Œä¸¤ä¸ªåˆ†åŒºå¯ä»¥é‡æ–°é€šä¿¡<br>â€¢ å°‘æ•°æ´¾èŠ‚ç‚¹ï¼ˆNode 1, 2ï¼‰å‘ç°å¤šæ•°æ´¾çš„Leaderï¼ˆNode 3ï¼‰<br>â€¢ å°‘æ•°æ´¾èŠ‚ç‚¹ä»LeaderåŒæ­¥æœ€æ–°æ•°æ®ï¼Œ<span class="highlight">è¿½èµ¶è¿›åº¦</span><br>â€¢ é›†ç¾¤æ¢å¤åˆ°5èŠ‚ç‚¹æ­£å¸¸çŠ¶æ€ï¼Œæ‰€æœ‰èŠ‚ç‚¹æ•°æ®ä¸€è‡´<br>â€¢ <strong>æ•´ä¸ªè¿‡ç¨‹ä¿è¯å¼ºä¸€è‡´æ€§ï¼šå°‘æ•°æ´¾ä»æœªæ¥å—è¿‡å†™å…¥ï¼ŒåŒæ­¥åæ•°æ®å®Œå…¨ä¸€è‡´</strong>',
                    partition: false,
                    comparison: false,
                    nodes: {
                        1: { role: 'follower', available: true },
                        2: { role: 'follower', available: true },
                        3: { role: 'leader', available: true },
                        4: { role: 'follower', available: true },
                        5: { role: 'follower', available: true }
                    }
                }
            };

            const config = scenarios[scenario];

            // æ›´æ–°è¯´æ˜
            explanation.querySelector('h3').textContent = config.title;
            explanation.querySelector('p').innerHTML = config.description;

            // æ˜¾ç¤º/éšè—åˆ†åŒºçº¿
            if (config.partition) {
                partitionLine.classList.add('show');
                partitionLabel.classList.add('show');
                zoneMinority.classList.remove('hidden');
                zoneMajority.classList.remove('hidden');
            } else {
                partitionLine.classList.remove('show');
                partitionLabel.classList.remove('show');
                zoneMinority.classList.add('hidden');
                zoneMajority.classList.add('hidden');
            }

            // æ˜¾ç¤º/éšè—å¯¹æ¯”
            comparison.style.display = config.comparison ? 'grid' : 'none';

            // æ›´æ–°èŠ‚ç‚¹çŠ¶æ€
            for (let nodeId in config.nodes) {
                const node = document.getElementById('node' + nodeId);
                const card = node.querySelector('.node-card');
                const roleSpan = node.querySelector('.node-role');
                const nodeConfig = config.nodes[nodeId];

                // æ¸…é™¤æ‰€æœ‰çŠ¶æ€
                card.classList.remove('leader', 'follower', 'unavailable');
                roleSpan.className = 'node-role';

                // ç§»é™¤æ—§çš‡å† 
                const oldCrown = node.querySelector('.crown');
                if (oldCrown) oldCrown.remove();

                // è®¾ç½®æ–°çŠ¶æ€
                if (nodeConfig.role === 'leader') {
                    card.classList.add('leader');
                    roleSpan.classList.add('role-leader');
                    roleSpan.textContent = 'Leader';
                    // æ·»åŠ çš‡å† 
                    const crown = document.createElement('div');
                    crown.className = 'crown';
                    crown.textContent = 'ğŸ‘‘';
                    card.insertBefore(crown, card.firstChild);
                } else if (nodeConfig.role === 'follower') {
                    card.classList.add('follower');
                    roleSpan.classList.add('role-follower');
                    roleSpan.textContent = 'Follower';
                } else {
                    card.classList.add('unavailable');
                    roleSpan.classList.add('role-unavailable');
                    roleSpan.textContent = 'ä¸å¯ç”¨';
                }
            }

            // æ˜¾ç¤ºç®­å¤´å’Œå“åº”
            if (config.arrows) {
                for (let arrowId in config.arrows) {
                    const arrowConfig = config.arrows[arrowId];
                    const arrow = document.getElementById('arrow-' + arrowId);
                    arrow.classList.add('show');
                    arrow.classList.add(arrowConfig.success ? 'success' : 'failed');
                    arrow.style.left = arrowConfig.left;
                    arrow.style.top = arrowConfig.top;
                    arrow.style.width = arrowConfig.width;
                }
            }

            if (config.responses) {
                for (let responseId in config.responses) {
                    const responseConfig = config.responses[responseId];
                    const response = document.getElementById('response-' + responseId);
                    response.classList.add('show');
                    response.classList.add(responseConfig.success ? 'success' : 'failed');
                    response.textContent = responseConfig.text;
                    if (responseConfig.left) response.style.left = responseConfig.left;
                    if (responseConfig.right) response.style.right = responseConfig.right;
                    response.style.top = responseConfig.top;
                }
            }
        }

        // åˆå§‹åŒ–
        showScenario('normal');
    </script>
</body>
</html>